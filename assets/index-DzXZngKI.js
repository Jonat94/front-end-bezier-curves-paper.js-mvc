(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const G of document.querySelectorAll('link[rel="modulepreload"]'))J(G);new MutationObserver(G=>{for(const A of G)if(A.type==="childList")for(const pt of A.addedNodes)pt.tagName==="LINK"&&pt.rel==="modulepreload"&&J(pt)}).observe(document,{childList:!0,subtree:!0});function B(G){const A={};return G.integrity&&(A.integrity=G.integrity),G.referrerPolicy&&(A.referrerPolicy=G.referrerPolicy),G.crossOrigin==="use-credentials"?A.credentials="include":G.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function J(G){if(G.ep)return;G.ep=!0;const A=B(G);fetch(G.href,A)}})();function fn(qt){return qt&&qt.__esModule&&Object.prototype.hasOwnProperty.call(qt,"default")?qt.default:qt}function Jn(qt){if(Object.prototype.hasOwnProperty.call(qt,"__esModule"))return qt;var a=qt.default;if(typeof a=="function"){var B=function J(){var G=!1;try{G=this instanceof J}catch{}return G?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};B.prototype=a.prototype}else B={};return Object.defineProperty(B,"__esModule",{value:!0}),Object.keys(qt).forEach(function(J){var G=Object.getOwnPropertyDescriptor(qt,J);Object.defineProperty(B,J,G.get?G:{enumerable:!0,get:function(){return qt[J]}})}),B}function jn(qt){throw new Error('Could not dynamically require "'+qt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ci={exports:{}};const Kn={},Qn=Object.freeze(Object.defineProperty({__proto__:null,default:Kn},Symbol.toStringTag,{value:"Module"})),un=Jn(Qn);/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var $n=Ci.exports,ln;function tr(){return ln||(ln=1,(function(qt){(function(a,B){a=a||un;var J=a.window,G=a.document,A=new function(){var t=/^(statics|enumerable|beans|preserve)$/,i=[],n=i.slice,s=Object.create,u=Object.getOwnPropertyDescriptor,l=Object.defineProperty,c=i.forEach||function(m,g){for(var T=0,w=this.length;T<w;T++)m.call(g,this[T],T,this)},f=function(m,g){for(var T in this)this.hasOwnProperty(T)&&m.call(g,this[T],T,this)},d=Object.assign||function(m){for(var g=1,T=arguments.length;g<T;g++){var w=arguments[g];for(var O in w)w.hasOwnProperty(O)&&(m[O]=w[O])}return m},p=function(m,g,T){if(m){var w=u(m,"length");(w&&typeof w.value=="number"?c:f).call(m,g,T=T||m)}return T};function y(m,g,T,w,O){var C={};function b(S,M){M=M||(M=u(g,S))&&(M.get?M:M.value),typeof M=="string"&&M[0]==="#"&&(M=m[M.substring(1)]||M);var X=typeof M=="function",k=M,V=O||X&&!M.base?M&&M.get?S in m:m[S]:null,D;(!O||!V)&&(X&&V&&(M.base=V),X&&w!==!1&&(D=S.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(C[D[3].toLowerCase()+D[4]]=D[2]),(!k||X||!k.get||typeof k.get!="function"||!P.isPlainObject(k))&&(k={value:k,writable:!0}),(u(m,S)||{configurable:!0}).configurable&&(k.configurable=!0,k.enumerable=T??!D),l(m,S,k))}if(g){for(var v in g)g.hasOwnProperty(v)&&!t.test(v)&&b(v);for(var v in C){var x=C[v],L=m["set"+x],E=m["get"+x]||L&&m["is"+x];E&&(w===!0||E.length===0)&&b(v,{get:E,set:L})}}return m}function P(){for(var m=0,g=arguments.length;m<g;m++){var T=arguments[m];T&&d(this,T)}return this}return y(P,{inject:function(m){if(m){var g=m.statics===!0?m:m.statics,T=m.beans,w=m.preserve;g!==m&&y(this.prototype,m,m.enumerable,T,w),y(this,g,null,T,w)}for(var O=1,C=arguments.length;O<C;O++)this.inject(arguments[O]);return this},extend:function(){for(var m=this,g,T,w=0,O,C=arguments.length;w<C&&!(g&&T);w++)O=arguments[w],g=g||O.initialize,T=T||O.prototype;return g=g||function(){m.apply(this,arguments)},T=g.prototype=T||s(this.prototype),l(T,"constructor",{value:g,writable:!0,configurable:!0}),y(g,this),arguments.length&&this.inject.apply(g,arguments),g.base=m,g}}).inject({enumerable:!1,initialize:P,set:P,inject:function(){for(var m=0,g=arguments.length;m<g;m++){var T=arguments[m];T&&y(this,T,T.enumerable,T.beans,T.preserve)}return this},extend:function(){var m=s(this);return m.inject.apply(m,arguments)},each:function(m,g){return p(this,m,g)},clone:function(){return new this.constructor(this)},statics:{set:d,each:p,create:s,define:l,describe:u,clone:function(m){return d(new m.constructor,m)},isPlainObject:function(m){var g=m!=null&&m.constructor;return g&&(g===Object||g===P||g.name==="Object")},pick:function(m,g){return m!==B?m:g},slice:function(m,g,T){return n.call(m,g,T)}}})};qt.exports=A,A.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+A.each(this,function(t,i){if(!/^_/.test(i)){var n=typeof t;this.push(i+": "+(n==="number"?he.instance.number(t):n==="string"?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return A.importJSON(t,this)},exportJSON:function(t){return A.exportJSON(this,t)},toJSON:function(){return A.serialize(this)},set:function(t,i){return t&&A.filter(this,t,i,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var i=t.base.apply(this,arguments),n=i.prototype._class;return n&&!A.exports[n]&&(A.exports[n]=i),i},equals:function(t,i){if(t===i)return!0;if(t&&t.equals)return t.equals(i);if(i&&i.equals)return i.equals(t);if(t&&i&&typeof t=="object"&&typeof i=="object"){if(Array.isArray(t)&&Array.isArray(i)){var n=t.length;if(n!==i.length)return!1;for(;n--;)if(!A.equals(t[n],i[n]))return!1}else{var s=Object.keys(t),n=s.length;if(n!==Object.keys(i).length)return!1;for(;n--;){var u=s[n];if(!(i.hasOwnProperty(u)&&A.equals(t[u],i[u])))return!1}}return!0}return!1},read:function(t,i,n,s){if(this===A){var u=this.peek(t,i);return t.__index++,u}var l=this.prototype,c=l._readIndex,f=i||c&&t.__index||0,d=t.length,p=t[f];if(s=s||d-f,p instanceof this||n&&n.readNull&&p==null&&s<=1)return c&&(t.__index=f+1),p&&n&&n.clone?p.clone():p;if(p=A.create(l),c&&(p.__read=!0),p=p.initialize.apply(p,f>0||f+s<d?A.slice(t,f,f+s):t)||p,c){t.__index=f+p.__read;var y=p.__filtered;y&&(t.__filtered=y,p.__filtered=B),p.__read=B}return p},peek:function(t,i){return t[t.__index=i||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,i,n,s){for(var u=[],l,c=i||0,f=s?c+s:t.length,d=c;d<f;d++)u.push(Array.isArray(l=t[d])?this.read(l,0,n):this.read(t,d,n,1));return u},readNamed:function(t,i,n,s,u){var l=this.getNamed(t,i),c=l!==B;if(c){var f=t.__filtered;if(!f){var d=this.getSource(t);f=t.__filtered=A.create(d),f.__unfiltered=d}f[i]=B}return this.read(c?[l]:t,n,s,u)},readSupported:function(t,i){var n=this.getSource(t),s=this,u=!1;return n&&Object.keys(n).forEach(function(l){if(l in i){var c=s.readNamed(t,l);c!==B&&(i[l]=c),u=!0}}),u},getSource:function(t){var i=t.__source;if(i===B){var n=t.length===1&&t[0];i=t.__source=n&&A.isPlainObject(n)?n:null}return i},getNamed:function(t,i){var n=this.getSource(t);if(n)return i?n[i]:t.__filtered||n},hasNamed:function(t,i){return!!this.getNamed(t,i)},filter:function(t,i,n,s){var u;function l(y){if(!(n&&y in n)&&!(u&&y in u)){var P=i[y];P!==B&&(t[y]=P)}}if(s){for(var c={},f=0,d,p=s.length;f<p;f++)(d=s[f])in i&&(l(d),c[d]=!0);u=c}return Object.keys(i.__unfiltered||i).forEach(l),t},isPlainValue:function(t,i){return A.isPlainObject(t)||Array.isArray(t)||i&&typeof t=="string"},serialize:function(t,i,n,s){i=i||{};var u=!s,l;if(u&&(i.formatter=new he(i.precision),s={length:0,definitions:{},references:{},add:function(P,m){var g="#"+P._id,T=this.references[g];if(!T){this.length++;var w=m.call(P),O=P._class;O&&w[0]!==O&&w.unshift(O),this.definitions[g]=w,T=this.references[g]=[g]}return T}}),t&&t._serialize){l=t._serialize(i,s);var c=t._class;c&&!t._compactSerialize&&(u||!n)&&l[0]!==c&&l.unshift(c)}else if(Array.isArray(t)){l=[];for(var f=0,d=t.length;f<d;f++)l[f]=A.serialize(t[f],i,n,s)}else if(A.isPlainObject(t)){l={};for(var p=Object.keys(t),f=0,d=p.length;f<d;f++){var y=p[f];l[y]=A.serialize(t[y],i,n,s)}}else typeof t=="number"?l=i.formatter.number(t,i.precision):l=t;return u&&s.length>0?[["dictionary",s.definitions],l]:l},deserialize:function(t,i,n,s,u){var l=t,c=!n,f=c&&t&&t.length&&t[0][0]==="dictionary";if(n=n||{},Array.isArray(t)){var d=t[0],p=d==="dictionary";if(t.length==1&&/^#/.test(d))return n.dictionary[d];d=A.exports[d],l=[];for(var y=d?1:0,P=t.length;y<P;y++)l.push(A.deserialize(t[y],i,n,p,f));if(d){var m=l;i?l=i(d,m,c||u):l=new d(m)}}else if(A.isPlainObject(t)){l={},s&&(n.dictionary=l);for(var g in t)l[g]=A.deserialize(t[g],i,n)}return f?l[1]:l},exportJSON:function(t,i){var n=A.serialize(t,i);return i&&i.asString==!1?n:JSON.stringify(n)},importJSON:function(t,i){return A.deserialize(typeof t=="string"?JSON.parse(t):t,function(n,s,u){var l=u&&i&&i.constructor===n,c=l?i:A.create(n.prototype);if(s.length===1&&c instanceof At&&(l||!(c instanceof Re))){var f=s[0];A.isPlainObject(f)&&(f.insert=!1,l&&(s=s.concat([At.INSERT])))}return(l?c.set:n).apply(c,s),l&&(i=null),c})},push:function(t,i){var n=i.length;if(n<4096)t.push.apply(t,i);else{var s=t.length;t.length+=n;for(var u=0;u<n;u++)t[s+u]=i[u]}return t},splice:function(t,i,n,s){var u=i&&i.length,l=n===B;n=l?t.length:n,n>t.length&&(n=t.length);for(var c=0;c<u;c++)i[c]._index=n+c;if(l)return A.push(t,i),[];var f=[n,s];i&&A.push(f,i);for(var d=t.splice.apply(t,f),c=0,p=d.length;c<p;c++)d[c]._index=B;for(var c=n+u,p=t.length;c<p;c++)t[c]._index=c;return d},capitalize:function(t){return t.replace(/\b[a-z]/g,function(i){return i.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(i,n){return n.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var pt={on:function(t,i){if(typeof t!="string")A.each(t,function(l,c){this.on(c,l)},this);else{var n=this._eventTypes,s=n&&n[t],u=this._callbacks=this._callbacks||{};u=u[t]=u[t]||[],u.indexOf(i)===-1&&(u.push(i),s&&s.install&&u.length===1&&s.install.call(this,t))}return this},off:function(t,i){if(typeof t!="string"){A.each(t,function(c,f){this.off(f,c)},this);return}var n=this._eventTypes,s=n&&n[t],u=this._callbacks&&this._callbacks[t],l;return u&&(!i||(l=u.indexOf(i))!==-1&&u.length===1?(s&&s.uninstall&&s.uninstall.call(this,t),delete this._callbacks[t]):l!==-1&&u.splice(l,1)),this},once:function(t,i){return this.on(t,function n(){i.apply(this,arguments),this.off(t,n)})},emit:function(t,i){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;var s=A.slice(arguments,1),u=i&&i.target&&!i.currentTarget;n=n.slice(),u&&(i.currentTarget=this);for(var l=0,c=n.length;l<c;l++)if(n[l].apply(this,s)==!1){i&&i.stop&&i.stop();break}return u&&delete i.currentTarget,!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var i=this._eventTypes,n=this._callbacks,s=t?"install":"uninstall";if(i){for(var u in n)if(n[u].length>0){var l=i[u],c=l&&l[s];c&&c.call(this,u)}}},statics:{inject:function t(i){var n=i._events;if(n){var s={};A.each(n,function(u,l){var c=typeof u=="string",f=c?u:l,d=A.capitalize(f),p=f.substring(2).toLowerCase();s[p]=c?{}:u,f="_"+f,i["get"+d]=function(){return this[f]},i["set"+d]=function(y){var P=this[f];P&&this.off(p,P),y&&this.on(p,y),this[f]=y}}),i._eventTypes=s}return t.base.apply(this,arguments)}}},$=A.extend({_class:"PaperScope",initialize:function t(){Mt=this,this.settings=new A({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var i=t.prototype;if(!this.support){var n=Qt.getContext(1,1)||{};i.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:ei.nativeModes},Qt.release(n)}if(!this.agent){var s=a.navigator.userAgent.toLowerCase(),u=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(s)||[])[0],l=u==="darwin"?"mac":u,c=i.agent=i.browser={platform:l};l&&(c[l]=!0),s.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(f,d,p,y,P){if(!c.chrome){var m=d==="opera"?y:/^(node|trident)$/.test(d)?P:p;c.version=m,c.versionNumber=parseFloat(m),d={trident:"msie",jsdom:"node"}[d]||d,c.name=d,c[d]=!0}}),c.chrome&&delete c.webkit,c.atom&&delete c.chrome}},version:"0.12.18",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,i){var n=Mt.PaperScript.execute(t,this,i);return Zt.updateFocus(),n},install:function(t){var i=this;A.each(["project","view","tool"],function(s){A.define(t,s,{configurable:!0,get:function(){return i[s]}})});for(var n in this)!/^_/.test(n)&&this[n]&&(t[n]=this[n])},setup:function(t){return Mt=this,this.project=new ye(t),this},createCanvas:function(t,i){return Qt.getCanvas(t,i)},activate:function(){Mt=this},clear:function(){for(var t=this.projects,i=this.tools,n=t.length-1;n>=0;n--)t[n].remove();for(var n=i.length-1;n>=0;n--)i[n].remove()},remove:function(){this.clear(),delete $._scopes[this._id]},statics:new function(){function t(i){return i+="Attribute",function(n,s){return n[i](s)||n[i]("data-paper-"+s)}}return{_scopes:{},_id:0,get:function(i){return this._scopes[i]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),mt=A.extend(pt,{initialize:function(t){this._scope=Mt,this._index=this._scope[this._list].push(this)-1,(t||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(A.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),Me={findItemBoundsCollisions:function(t,i,n){function s(c){for(var f=new Array(c.length),d=0;d<c.length;d++){var p=c[d].getBounds();f[d]=[p.left,p.top,p.right,p.bottom]}return f}var u=s(t),l=!i||i===t?u:s(i);return this.findBoundsCollisions(u,l,n||0)},findCurveBoundsCollisions:function(t,i,n,s){function u(m){for(var g=Math.min,T=Math.max,w=new Array(m.length),O=0;O<m.length;O++){var C=m[O];w[O]=[g(C[0],C[2],C[4],C[6]),g(C[1],C[3],C[5],C[7]),T(C[0],C[2],C[4],C[6]),T(C[1],C[3],C[5],C[7])]}return w}var l=u(t),c=!i||i===t?l:u(i);if(s){for(var f=this.findBoundsCollisions(l,c,n||0,!1,!0),d=this.findBoundsCollisions(l,c,n||0,!0,!0),p=[],y=0,P=f.length;y<P;y++)p[y]={hor:f[y],ver:d[y]};return p}return this.findBoundsCollisions(l,c,n||0)},findBoundsCollisions:function(t,i,n,s,u){var l=!i||t===i,c=l?t:t.concat(i),f=t.length,d=c.length;function p(at,ut,ft){for(var tt=0,it=at.length;tt<it;){var lt=it+tt>>>1;c[at[lt]][ut]<ft?tt=lt+1:it=lt}return tt-1}for(var y=s?1:0,P=y+2,m=s?0:1,g=m+2,T=new Array(d),w=0;w<d;w++)T[w]=w;T.sort(function(at,ut){return c[at][y]-c[ut][y]});for(var O=[],C=new Array(f),w=0;w<d;w++){var b=T[w],v=c[b],x=l?b:b-f,L=b<f,E=l||!L,S=L?[]:null;if(O.length){var M=p(O,P,v[y]-n)+1;if(O.splice(0,M),l&&u){S=S.concat(O);for(var X=0;X<O.length;X++){var k=O[X];C[k].push(x)}}else for(var V=v[g],D=v[m],X=0;X<O.length;X++){var k=O[X],z=c[k],q=k<f,H=l||k>=f;(u||(L&&H||E&&q)&&V>=z[m]-n&&D<=z[g]+n)&&(L&&H&&S.push(l?k:k-f),E&&q&&C[k].push(x))}}if(L&&(t===i&&S.push(b),C[b]=S),O.length){var U=v[P],j=p(O,P,U);O.splice(j+1,0,b)}else O.push(b)}for(var w=0;w<C.length;w++){var rt=C[w];rt&&rt.sort(function(ut,ft){return ut-ft})}return C}},he=A.extend({initialize:function(t){this.precision=A.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,i,n){return this.number(t)+(n||",")+this.number(i)},point:function(t,i){return this.number(t.x)+(i||",")+this.number(t.y)},size:function(t,i){return this.number(t.width)+(i||",")+this.number(t.height)},rectangle:function(t,i){return this.point(t,i)+(i||",")+this.size(t,i)}});he.instance=new he;var Dt=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],i=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,s=Math.sqrt,u=Math.pow,l=Math.log2||function(P){return Math.log(P)*Math.LOG2E},c=1e-12,f=112e-18;function d(P,m,g){return P<m?m:P>g?g:P}function p(P,m,g){function T(M){var X=M*134217729,k=M-X,V=k+X,D=M-V;return[V,D]}var w=m*m-P*g,O=m*m+P*g;if(n(w)*3<O){var C=T(P),b=T(m),v=T(g),x=m*m,L=b[0]*b[0]-x+2*b[0]*b[1]+b[1]*b[1],E=P*g,S=C[0]*v[0]-E+C[0]*v[1]+C[1]*v[0]+C[1]*v[1];w=x-E+(L-S)}return w}function y(){var P=Math.max.apply(Math,arguments);return P&&(P<1e-8||P>1e8)?u(2,-Math.round(l(P))):0}return{EPSILON:c,MACHINE_EPSILON:f,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(s(2)-1)/3,isZero:function(P){return P>=-c&&P<=c},isMachineZero:function(P){return P>=-f&&P<=f},clamp:d,integrate:function(P,m,g,T){for(var w=t[T-2],O=i[T-2],C=(g-m)*.5,b=C+m,v=0,x=T+1>>1,L=T&1?O[v++]*P(b):0;v<x;){var E=C*w[v];L+=O[v++]*(P(b+E)+P(b-E))}return C*L},findRoot:function(P,m,g,T,w,O,C){for(var b=0;b<O;b++){var v=P(g),x=v/m(g),L=g-x;if(n(x)<C){g=L;break}v>0?(w=g,g=L<=T?(T+w)*.5:L):(T=g,g=L>=w?(T+w)*.5:L)}return d(g,T,w)},solveQuadratic:function(P,m,g,T,w,O){var C,b=1/0;if(n(P)<c){if(n(m)<c)return n(g)<c?-1:0;C=-g/m}else{m*=-.5;var v=p(P,m,g);if(v&&n(v)<f){var x=y(n(P),n(m),n(g));x&&(P*=x,m*=x,g*=x,v=p(P,m,g))}if(v>=-f){var L=v<0?0:s(v),E=m+(m<0?-L:L);E===0?(C=g/P,b=-C):(C=E/P,b=g/E)}}var S=0,M=w==null,X=w-c,k=O+c;return isFinite(C)&&(M||C>X&&C<k)&&(T[S++]=M?C:d(C,w,O)),b!==C&&isFinite(b)&&(M||b>X&&b<k)&&(T[S++]=M?b:d(b,w,O)),S},solveCubic:function(P,m,g,T,w,O,C){var b=y(n(P),n(m),n(g),n(T)),v,x,L,E,S;b&&(P*=b,m*=b,g*=b,T*=b);function M(j){v=j;var rt=P*v;x=rt+m,L=x*v+g,E=(rt+x)*v+L,S=L*v+T}if(n(P)<c)P=m,x=g,L=T,v=1/0;else if(n(T)<c)x=m,L=g,v=0;else{M(-(m/P)/3);var X=S/P,k=u(n(X),1/3),V=X<0?-1:1,D=-E/P,z=D>0?1.324717957244746*Math.max(k,s(D)):k,q=v-V*z;if(q!==v){do M(q),q=E===0?v:v-S/E/(1+f);while(V*q>V*v);n(P)*v*v>n(T/v)&&(L=-T/v,x=(L-g)/v)}}var H=Dt.solveQuadratic(P,x,L,w,O,C),U=O==null;return isFinite(v)&&(H===0||H>0&&v!==w[0]&&v!==w[1])&&(U||v>O-c&&v<C+c)&&(w[H++]=U?v:d(v,O,C)),H}}},we={_id:1,_pools:{},get:function(t){if(t){var i=this._pools[t];return i||(i=this._pools[t]={_id:1}),i._id++}else return this._id++}},Z=A.extend({_class:"Point",_readIndex:!0,initialize:function(i,n){var s=typeof i,u=this.__read,l=0;if(s==="number"){var c=typeof n=="number";this._set(i,c?n:i),u&&(l=c?2:1)}else if(s==="undefined"||i===null)this._set(0,0),u&&(l=i===null?1:0);else{var f=s==="string"?i.split(/[\s,]+/)||[]:i;l=1,Array.isArray(f)?this._set(+f[0],+(f.length>1?f[1]:f[0])):"x"in f?this._set(f.x||0,f.y||0):"width"in f?this._set(f.width||0,f.height||0):"angle"in f?(this._set(f.length||0,0),this.setAngle(f.angle||0)):(this._set(0,0),l=0)}return u&&(this.__read=l),this},set:"#initialize",_set:function(t,i){return this.x=t,this.y=i,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new Z(this.x,this.y)},toString:function(){var t=he.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.x),i.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var i=this._angle||0;this._set(Math.cos(i)*t,Math.sin(i)*t)}else{var n=t/this.getLength();Dt.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=Z.read(arguments),i=this.getLength()*t.getLength();if(Dt.isZero(i))return NaN;var n=this.dot(t)/i;return Math.acos(n<-1?-1:n>1?1:n)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var i=this.getLength();this._set(Math.cos(t)*i,Math.sin(t)*i)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=Z.read(arguments);return Math.atan2(this.cross(t),this.dot(t))*180/Math.PI},getDistance:function(){var t=arguments,i=Z.read(t),n=i.x-this.x,s=i.y-this.y,u=n*n+s*s,l=A.read(t);return l?u:Math.sqrt(u)},normalize:function(t){t===B&&(t=1);var i=this.getLength(),n=i!==0?t/i:0,s=new Z(this.x*n,this.y*n);return n>=0&&(s._angle=this._angle),s},rotate:function(t,i){if(t===0)return this.clone();t=t*Math.PI/180;var n=i?this.subtract(i):this,s=Math.sin(t),u=Math.cos(t);return n=new Z(n.x*u-n.y*s,n.x*s+n.y*u),i?n.add(i):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=Z.read(arguments);return new Z(this.x+t.x,this.y+t.y)},subtract:function(){var t=Z.read(arguments);return new Z(this.x-t.x,this.y-t.y)},multiply:function(){var t=Z.read(arguments);return new Z(this.x*t.x,this.y*t.y)},divide:function(){var t=Z.read(arguments);return new Z(this.x/t.x,this.y/t.y)},modulo:function(){var t=Z.read(arguments);return new Z(this.x%t.x,this.y%t.y)},negate:function(){return new Z(-this.x,-this.y)},isInside:function(){return Ct.read(arguments).contains(this)},isClose:function(){var t=arguments,i=Z.read(t),n=A.read(t);return this.getDistance(i)<=n},isCollinear:function(){var t=Z.read(arguments);return Z.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=Z.read(arguments);return Z.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=Dt.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=Z.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=Z.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=Z.read(arguments),i=t.isZero()?0:this.dot(t)/t.dot(t);return new Z(t.x*i,t.y*i)},statics:{min:function(){var t=arguments,i=Z.read(t),n=Z.read(t);return new Z(Math.min(i.x,n.x),Math.min(i.y,n.y))},max:function(){var t=arguments,i=Z.read(t),n=Z.read(t);return new Z(Math.max(i.x,n.x),Math.max(i.y,n.y))},random:function(){return new Z(Math.random(),Math.random())},isCollinear:function(t,i,n,s){return Math.abs(t*s-i*n)<=Math.sqrt((t*t+i*i)*(n*n+s*s))*1e-8},isOrthogonal:function(t,i,n,s){return Math.abs(t*n+i*s)<=Math.sqrt((t*t+i*i)*(n*n+s*s))*1e-8}}},A.each(["round","ceil","floor","abs"],function(t){var i=Math[t];this[t]=function(){return new Z(i(this.x),i(this.y))}},{})),me=Z.extend({initialize:function(i,n,s,u){this._x=i,this._y=n,this._owner=s,this._setter=u},_set:function(t,i,n){return this._x=t,this._y=i,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),_t=A.extend({_class:"Size",_readIndex:!0,initialize:function(i,n){var s=typeof i,u=this.__read,l=0;if(s==="number"){var c=typeof n=="number";this._set(i,c?n:i),u&&(l=c?2:1)}else if(s==="undefined"||i===null)this._set(0,0),u&&(l=i===null?1:0);else{var f=s==="string"?i.split(/[\s,]+/)||[]:i;l=1,Array.isArray(f)?this._set(+f[0],+(f.length>1?f[1]:f[0])):"width"in f?this._set(f.width||0,f.height||0):"x"in f?this._set(f.x||0,f.y||0):(this._set(0,0),l=0)}return u&&(this.__read=l),this},set:"#initialize",_set:function(t,i){return this.width=t,this.height=i,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new _t(this.width,this.height)},toString:function(){var t=he.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.width),i.number(this.height)]},add:function(){var t=_t.read(arguments);return new _t(this.width+t.width,this.height+t.height)},subtract:function(){var t=_t.read(arguments);return new _t(this.width-t.width,this.height-t.height)},multiply:function(){var t=_t.read(arguments);return new _t(this.width*t.width,this.height*t.height)},divide:function(){var t=_t.read(arguments);return new _t(this.width/t.width,this.height/t.height)},modulo:function(){var t=_t.read(arguments);return new _t(this.width%t.width,this.height%t.height)},negate:function(){return new _t(-this.width,-this.height)},isZero:function(){var t=Dt.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,i){return new _t(Math.min(t.width,i.width),Math.min(t.height,i.height))},max:function(t,i){return new _t(Math.max(t.width,i.width),Math.max(t.height,i.height))},random:function(){return new _t(Math.random(),Math.random())}}},A.each(["round","ceil","floor","abs"],function(t){var i=Math[t];this[t]=function(){return new _t(i(this.width),i(this.height))}},{})),re=_t.extend({initialize:function(i,n,s,u){this._width=i,this._height=n,this._owner=s,this._setter=u},_set:function(t,i,n){return this._width=t,this._height=i,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),Ct=A.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(i,n,s,u){var l=arguments,c=typeof i,f;if(c==="number"?(this._set(i,n,s,u),f=4):c==="undefined"||i===null?(this._set(0,0,0,0),f=i===null?1:0):l.length===1&&(Array.isArray(i)?(this._set.apply(this,i),f=1):i.x!==B||i.width!==B?(this._set(i.x||0,i.y||0,i.width||0,i.height||0),f=1):i.from===B&&i.to===B&&(this._set(0,0,0,0),A.readSupported(l,this)&&(f=1))),f===B){var d=Z.readNamed(l,"from"),p=A.peek(l),y=d.x,P=d.y,m,g;if(p&&p.x!==B||A.hasNamed(l,"to")){var T=Z.readNamed(l,"to");m=T.x-y,g=T.y-P,m<0&&(y=T.x,m=-m),g<0&&(P=T.y,g=-g)}else{var w=_t.read(l);m=w.width,g=w.height}this._set(y,P,m,g),f=l.__index}var O=l.__filtered;return O&&(this.__filtered=O),this.__read&&(this.__read=f),this},set:"#initialize",_set:function(t,i,n,s){return this.x=t,this.y=i,this.width=n,this.height=s,this},clone:function(){return new Ct(this.x,this.y,this.width,this.height)},equals:function(t){var i=A.isPlainValue(t)?Ct.read(arguments):t;return i===this||i&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height||!1},toString:function(){var t=he.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.x),i.number(this.y),i.number(this.width),i.number(this.height)]},getPoint:function(t){var i=t?Z:me;return new i(this.x,this.y,this,"setPoint")},setPoint:function(){var t=Z.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){var i=t?_t:re;return new i(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=_t.read(arguments),i=this._sx,n=this._sy,s=t.width,u=t.height;i&&(this.x+=(this.width-s)*i),n&&(this.y+=(this.height-u)*n),this.width=s,this.height=u,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var i=t-this.x;this.width-=this._sx===.5?i*2:i}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var i=t-this.y;this.height-=this._sy===.5?i*2:i}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var i=t-this.x;this.width=this._sx===.5?i*2:i}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var i=t-this.y;this.height=this._sy===.5?i*2:i}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||this._sx===.5?this.x=t-this.width/2:(this._sx&&(this.x+=(t-this.x)*2*this._sx),this.width=(t-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||this._sy===.5?this.y=t-this.height/2:(this._sy&&(this.y+=(t-this.y)*2*this._sy),this.height=(t-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(t){var i=t?Z:me;return new i(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=Z.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(t){return t&&t.width!==B||(Array.isArray(t)?t:arguments).length===4?this._containsRectangle(Ct.read(arguments)):this._containsPoint(Z.read(arguments))},_containsPoint:function(t){var i=t.x,n=t.y;return i>=this.x&&n>=this.y&&i<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var i=t.x,n=t.y;return i>=this.x&&n>=this.y&&i+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=Ct.read(arguments),i=A.read(arguments)||0;return t.x+t.width>this.x-i&&t.y+t.height>this.y-i&&t.x<this.x+this.width+i&&t.y<this.y+this.height+i},intersect:function(){var t=Ct.read(arguments),i=Math.max(this.x,t.x),n=Math.max(this.y,t.y),s=Math.min(this.x+this.width,t.x+t.width),u=Math.min(this.y+this.height,t.y+t.height);return new Ct(i,n,s-i,u-n)},unite:function(){var t=Ct.read(arguments),i=Math.min(this.x,t.x),n=Math.min(this.y,t.y),s=Math.max(this.x+this.width,t.x+t.width),u=Math.max(this.y+this.height,t.y+t.height);return new Ct(i,n,s-i,u-n)},include:function(){var t=Z.read(arguments),i=Math.min(this.x,t.x),n=Math.min(this.y,t.y),s=Math.max(this.x+this.width,t.x),u=Math.max(this.y+this.height,t.y);return new Ct(i,n,s-i,u-n)},expand:function(){var t=_t.read(arguments),i=t.width,n=t.height;return new Ct(this.x-i/2,this.y-n/2,this.width+i,this.height+n)},scale:function(t,i){return this.expand(this.width*t-this.width,this.height*(i===B?t:i)-this.height)}},A.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,i){var n=t.join(""),s=/^[RL]/.test(n);i>=4&&(t[1]+=s?"Y":"X");var u=t[s?0:1],l=t[s?1:0],c="get"+u,f="get"+l,d="set"+u,p="set"+l,y="get"+n,P="set"+n;this[y]=function(m){var g=m?Z:me;return new g(this[c](),this[f](),this,P)},this[P]=function(){var m=Z.read(arguments);this[d](m.x),this[p](m.y)}},{beans:!0})),ui=Ct.extend({initialize:function(i,n,s,u,l,c){this._set(i,n,s,u,!0),this._owner=l,this._setter=c},_set:function(t,i,n,s,u){return this._x=t,this._y=i,this._width=n,this._height=s,u||this._owner[this._setter](this),this}},new function(){var t=Ct.prototype;return A.each(["x","y","width","height"],function(i){var n=A.capitalize(i),s="_"+i;this["get"+n]=function(){return this[s]},this["set"+n]=function(u){this[s]=u,this._dontNotify||this._owner[this._setter](this)}},A.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(i){var n="set"+i;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(i){var n=this._owner;n._changeSelection&&n._changeSelection(2,i)}}))}),Vt=A.extend({_class:"Matrix",initialize:function t(i,n){var s=arguments,u=s.length,l=!0;if(u>=6?this._set.apply(this,s):u===1||u===2?i instanceof t?this._set(i._a,i._b,i._c,i._d,i._tx,i._ty,n):Array.isArray(i)?this._set.apply(this,n?i.concat([n]):i):l=!1:u?l=!1:this.reset(),!l)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,i,n,s,u,l,c){return this._a=t,this._b=i,this._c=n,this._d=s,this._tx=u,this._ty=l,c||this._changed(),this},_serialize:function(t,i){return A.serialize(this.getValues(),t,!0,i)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new Vt(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=he.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,i){var n=this._owner;return n?(n.transform(null,A.pick(t,!0),i),this.isIdentity()):!1},translate:function(){var t=Z.read(arguments),i=t.x,n=t.y;return this._tx+=i*this._a+n*this._c,this._ty+=i*this._b+n*this._d,this._changed(),this},scale:function(){var t=arguments,i=Z.read(t),n=Z.read(t,0,{readNull:!0});return n&&this.translate(n),this._a*=i.x,this._b*=i.x,this._c*=i.y,this._d*=i.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var i=Z.read(arguments,1),n=i.x,s=i.y,u=Math.cos(t),l=Math.sin(t),c=n-n*u+s*l,f=s-n*l-s*u,d=this._a,p=this._b,y=this._c,P=this._d;return this._a=u*d+l*y,this._b=u*p+l*P,this._c=-l*d+u*y,this._d=-l*p+u*P,this._tx+=c*d+f*y,this._ty+=c*p+f*P,this._changed(),this},shear:function(){var t=arguments,i=Z.read(t),n=Z.read(t,0,{readNull:!0});n&&this.translate(n);var s=this._a,u=this._b;return this._a+=i.y*this._c,this._b+=i.y*this._d,this._c+=i.x*s,this._d+=i.x*u,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var t=arguments,i=Z.read(t),n=Z.read(t,0,{readNull:!0}),s=Math.PI/180,u=new Z(Math.tan(i.x*s),Math.tan(i.y*s));return this.shear(u,n)},append:function(t,i){if(t){var n=this._a,s=this._b,u=this._c,l=this._d,c=t._a,f=t._c,d=t._b,p=t._d,y=t._tx,P=t._ty;this._a=c*n+d*u,this._c=f*n+p*u,this._b=c*s+d*l,this._d=f*s+p*l,this._tx+=y*n+P*u,this._ty+=y*s+P*l,i||this._changed()}return this},prepend:function(t,i){if(t){var n=this._a,s=this._b,u=this._c,l=this._d,c=this._tx,f=this._ty,d=t._a,p=t._c,y=t._b,P=t._d,m=t._tx,g=t._ty;this._a=d*n+p*s,this._c=d*u+p*l,this._b=y*n+P*s,this._d=y*u+P*l,this._tx=d*c+p*f+m,this._ty=y*c+P*f+g,i||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,i=this._b,n=this._c,s=this._d,u=this._tx,l=this._ty,c=t*s-i*n,f=null;return c&&!isNaN(c)&&isFinite(u)&&isFinite(l)&&(this._a=s/c,this._b=-i/c,this._c=-n/c,this._d=t/c,this._tx=(n*l-s*u)/c,this._ty=(i*u-t*l)/c,f=this),f},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new Vt(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,i,n){return arguments.length<3?this._transformPoint(Z.read(arguments)):this._transformCoordinates(t,i,n)},_transformPoint:function(t,i,n){var s=t.x,u=t.y;return i||(i=new Z),i._set(s*this._a+u*this._c+this._tx,s*this._b+u*this._d+this._ty,n)},_transformCoordinates:function(t,i,n){for(var s=0,u=2*n;s<u;s+=2){var l=t[s],c=t[s+1];i[s]=l*this._a+c*this._c+this._tx,i[s+1]=l*this._b+c*this._d+this._ty}return i},_transformCorners:function(t){var i=t.x,n=t.y,s=i+t.width,u=n+t.height,l=[i,n,s,n,s,u,i,u];return this._transformCoordinates(l,l,4)},_transformBounds:function(t,i,n){for(var s=this._transformCorners(t),u=s.slice(0,2),l=u.slice(),c=2;c<8;c++){var f=s[c],d=c&1;f<u[d]?u[d]=f:f>l[d]&&(l[d]=f)}return i||(i=new Ct),i._set(u[0],u[1],l[0]-u[0],l[1]-u[1],n)},inverseTransform:function(){return this._inverseTransform(Z.read(arguments))},_inverseTransform:function(t,i,n){var s=this._a,u=this._b,l=this._c,c=this._d,f=this._tx,d=this._ty,p=s*c-u*l,y=null;if(p&&!isNaN(p)&&isFinite(f)&&isFinite(d)){var P=t.x-this._tx,m=t.y-this._ty;i||(i=new Z),y=i._set((P*c-m*l)/p,(m*s-P*u)/p,n)}return y},decompose:function(){var t=this._a,i=this._b,n=this._c,s=this._d,u=t*s-i*n,l=Math.sqrt,c=Math.atan2,f=180/Math.PI,d,p,y;if(t!==0||i!==0){var P=l(t*t+i*i);d=Math.acos(t/P)*(i>0?1:-1),p=[P,u/P],y=[c(t*n+i*s,P*P),0]}else if(n!==0||s!==0){var m=l(n*n+s*s);d=Math.asin(n/m)*(s>0?1:-1),p=[u/m,m],y=[0,c(t*n+i*s,m*m)]}else d=0,y=p=[0,0];return{translation:this.getTranslation(),rotation:d*f,scaling:new Z(p),skewing:new Z(y[0]*f,y[1]*f)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new Z(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},A.each(["a","b","c","d","tx","ty"],function(t){var i=A.capitalize(t),n="_"+t;this["get"+i]=function(){return this[n]},this["set"+i]=function(s){this[n]=s,this._changed()}},{})),se=A.extend({_class:"Line",initialize:function(i,n,s,u,l){var c=!1;arguments.length>=4?(this._px=i,this._py=n,this._vx=s,this._vy=u,c=l):(this._px=i.x,this._py=i.y,this._vx=n.x,this._vy=n.y,c=s),c||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new Z(this._px,this._py)},getVector:function(){return new Z(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,i){return se.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,i)},getSide:function(t,i){return se.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,i)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return se.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return Z.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return Z.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,i,n,s,u,l,c,f,d,p){d||(n-=t,s-=i,c-=u,f-=l);var y=n*f-s*c;if(!Dt.isMachineZero(y)){var P=t-u,m=i-l,g=(c*m-f*P)/y,T=(n*m-s*P)/y,w=1e-12,O=-w,C=1+w;if(p||O<g&&g<C&&O<T&&T<C)return p||(g=g<=0?0:g>=1?1:g),new Z(t+g*n,i+g*s)}},getSide:function(t,i,n,s,u,l,c,f){c||(n-=t,s-=i);var d=u-t,p=l-i,y=d*s-p*n;return!f&&Dt.isMachineZero(y)&&(y=(d*n+d*n)/(n*n+s*s),y>=0&&y<=1&&(y=0)),y<0?-1:y>0?1:0},getSignedDistance:function(t,i,n,s,u,l,c){return c||(n-=t,s-=i),n===0?s>0?u-t:t-u:s===0?n<0?l-i:i-l:((u-t)*s-(l-i)*n)/(s>n?s*Math.sqrt(1+n*n/(s*s)):n*Math.sqrt(1+s*s/(n*n)))},getDistance:function(t,i,n,s,u,l,c){return Math.abs(se.getSignedDistance(t,i,n,s,u,l,c))}}}),ye=mt.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(i){mt.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new ti(null,null,this),this._view=Zt.create(this,i||Qt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,i){return A.serialize(this._children,t,!0,i)},_changed:function(t,i){if(t&1){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var s=this._changes;if(s&&i){var u=this._changesById,l=i._id,c=u[l];c?c.flags|=t:s.push(u[l]={item:i,flags:t})}},clear:function(){for(var t=this._children,i=t.length-1;i>=0;i--)t[i].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return t.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new Re({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],i={};return this.getItems({class:Ke,match:function(n){var s=n._definition,u=s._id;return i[u]||(i[u]=!0,t.push(s)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,i=[];for(var n in t){var s=t[n],u=s._selection;u&1&&s.isInserted()?i.push(s):u||this._updateSelection(s)}return i},_updateSelection:function(t){var i=t._id,n=this._selectionItems;t._selection?n[i]!==t&&(this._selectionCount++,n[i]=t):n[i]===t&&(this._selectionCount--,delete n[i])},selectAll:function(){for(var t=this._children,i=0,n=t.length;i<n;i++)t[i].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var i in t)t[i].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(B,t)},insertLayer:function(t,i){if(i instanceof Re){i._remove(!1,!0),A.splice(this._children,[i],t,0),i._setProject(this,!0);var n=i._name;n&&i.setName(n),this._changes&&i._changed(5),this._activeLayer||(this._activeLayer=i)}else i=null;return i},_insertItem:function(t,i,n){return i=this.insertLayer(t,i)||(this._activeLayer||this._insertItem(B,new Re(At.NO_INSERT),!0)).insertChild(t,i),n&&i.activate&&i.activate(),i},getItems:function(t){return At._getItems(this,t)},getItem:function(t){return At._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var i=this._activeLayer;return A.importJSON(t,i&&i.isEmpty()&&i)},removeOn:function(t){var i=this._removeSets;if(i){t==="mouseup"&&(i.mousedrag=null);var n=i[t];if(n){for(var s in n){var u=n[s];for(var l in i){var c=i[l];c&&c!=n&&delete c[u._id]}u.remove()}i[t]=null}}},draw:function(t,i,n){this._updateVersion++,t.save(),i.applyToContext(t);for(var s=this._children,u=new A({offset:new Z(0,0),pixelRatio:n,viewMatrix:i.isIdentity()?null:i,matrices:[new Vt],updateMatrix:!0}),l=0,c=s.length;l<c;l++)s[l].draw(t,u);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var f=this._selectionItems,d=this._scope.settings.handleSize,p=this._updateVersion;for(var y in f)f[y]._drawSelection(t,i,d,f,p);t.restore()}}}),At=A.extend(pt,{statics:{extend:function t(i){return i._serializeFields&&(i._serializeFields=A.set({},this.prototype._serializeFields,i._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new Vt,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return A.each(t,function(i){this._events[i]={install:function(n){this.getView()._countItemEvent(n,1)},uninstall:function(n){this.getView()._countItemEvent(n,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,i){var n=t&&A.isPlainObject(t),s=n&&t.internal===!0,u=this._matrix=new Vt,l=n&&t.project||Mt.project,c=Mt.settings;return this._id=s?null:we.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&c.applyMatrix,i&&u.translate(i),u._owner=this,this._style=new ti(l._currentStyle,this,l),s||n&&t.insert==!1||!c.insertItems&&!(n&&t.insert==!0)?this._setProject(l):(n&&t.parent||l)._insertItem(B,this,!0),n&&t!==At.NO_INSERT&&t!==At.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(t,i){var n={},s=this;function u(l){for(var c in l){var f=s[c];A.equals(f,c==="leading"?l.fontSize*1.2:l[c])||(n[c]=A.serialize(f,t,c!=="data",i))}}return u(this._serializeFields),this instanceof Se||u(this._style._defaults),[this._class,n]},_changed:function(t){var i=this._symbol,n=this._parent||i,s=this._project;t&8&&(this._bounds=this._position=this._decomposed=B),t&16&&(this._globalMatrix=B),n&&t&72&&At._clearBoundsCache(n),t&2&&At._clearBoundsCache(this),s&&s._changed(t,this),i&&i._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var i=this._getOwner();if(t&&i){var n=i._children,s=i._namedChildren;(s[t]=s[t]||[]).push(this),t in n||(n[t]=this)}this._name=t||B,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},A.each(["locked","visible","blendMode","opacity","guide"],function(t){var i=A.capitalize(t),n="_"+t,s={locked:256,visible:265};this["get"+i]=function(){return this[n]},this["set"+i]=function(u){u!=this[n]&&(this[n]=u,this._changed(s[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var i=this._project;i&&(i._updateSelection(this),this._changed(257))}},_changeSelection:function(t,i){var n=this._selection;this.setSelection(i?n|t:n&~t)},isSelected:function(){if(this._selectChildren){for(var t=this._children,i=0,n=t.length;i<n;i++)if(t[i].isSelected())return!0}return!!(this._selection&1)},setSelected:function(t){if(this._selectChildren)for(var i=this._children,n=0,s=i.length;n<s;n++)i[n].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,i=!!(this._selection&1);if(t&&i){for(var n=0,s=t.length;n<s;n++)if(!t[n].isFullySelected())return!1;return!0}return i},setFullySelected:function(t){var i=this._children;if(i)for(var n=0,s=i.length;n<s;n++)i[n].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var i=t?Z:me,n=this._position||(this._position=this._getPositionFromBounds());return new i(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(Z.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new me(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=Z.read(arguments,0,{clone:!0,readNull:!0}),this._position=B}},A.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,i){this[i]=function(n){return this.getBounds(n,t)}},{beans:!0,getBounds:function(t,i){var n=i||t instanceof Vt,s=A.set({},n?i:t,this._boundsOptions);(!s.stroke||this.getStrokeScaling())&&(s.cacheItem=this);var u=this._getCachedBounds(n&&t,s).rect;return arguments.length?u:new ui(u.x,u.y,u.width,u.height,this,"setBounds")},setBounds:function(){var t=Ct.read(arguments),i=this.getBounds(),n=this._matrix,s=new Vt,u=t.getCenter();s.translate(u),(t.width!=i.width||t.height!=i.height)&&(n.isInvertible()||(n.set(n._backup||new Vt().translate(n.getTranslation())),i=this.getBounds()),s.scale(i.width!==0?t.width/i.width:0,i.height!==0?t.height/i.height:0)),u=i.getCenter(),s.translate(-u.x,-u.y),this.transform(s)},_getBounds:function(t,i){var n=this._children;return!n||!n.length?new Ct:(At._updateBoundsCache(this,i.cacheItem),At._getBounds(n,t,i))},_getBoundsCacheKey:function(t,i){return[t.stroke?1:0,t.handle?1:0,i?1:0].join("")},_getCachedBounds:function(t,i,n){t=t&&t._orNullIfIdentity();var s=i.internal&&!n,u=i.cacheItem,l=s?null:this._matrix._orNullIfIdentity(),c=u&&(!t||t.equals(l))&&this._getBoundsCacheKey(i,s),f=this._bounds;if(At._updateBoundsCache(this._parent||this._symbol,u),c&&f&&c in f){var d=f[c];return{rect:d.rect.clone(),nonscaling:d.nonscaling}}var p=this._getBounds(t||l,i),y=p.rect||p,P=this._style,m=p.nonscaling||P.hasStroke()&&!P.getStrokeScaling();if(c){f||(this._bounds=f={});var d=f[c]={rect:y.clone(),nonscaling:m,internal:s}}return{rect:y,nonscaling:m}},_getStrokeMatrix:function(t,i){var n=this.getStrokeScaling()?null:i&&i.internal?this:this._parent||this._symbol&&this._symbol._item,s=n?n.getViewMatrix().invert():t;return s&&s._shiftless()},statics:{_updateBoundsCache:function(t,i){if(t&&i){var n=i._id,s=t._boundsCache=t._boundsCache||{ids:{},list:[]};s.ids[n]||(s.list.push(i),s.ids[n]=i)}},_clearBoundsCache:function(t){var i=t._boundsCache;if(i){t._bounds=t._position=t._boundsCache=B;for(var n=0,s=i.list,u=s.length;n<u;n++){var l=s[n];l!==t&&(l._bounds=l._position=B,l._boundsCache&&At._clearBoundsCache(l))}}},_getBounds:function(t,i,n){var s=1/0,u=-s,l=s,c=u,f=!1;n=n||{};for(var d=0,p=t.length;d<p;d++){var y=t[d];if(y._visible&&!y.isEmpty(!0)){var P=y._getCachedBounds(i&&i.appended(y._matrix),n,!0),m=P.rect;s=Math.min(m.x,s),l=Math.min(m.y,l),u=Math.max(m.x+m.width,u),c=Math.max(m.y+m.height,c),P.nonscaling&&(f=!0)}}return{rect:isFinite(s)?new Ct(s,l,u-s,c-l):new Ct,nonscaling:f}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var i=this.getRotation();if(i!=null&&t!=null){var n=this._decomposed;this.rotate(t-i),n&&(n.rotation=t,this._decomposed=n)}},getScaling:function(){var t=this._decompose(),i=t&&t.scaling;return new me(i?i.x:1,i?i.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),i=Z.read(arguments,0,{clone:!0,readNull:!0});if(t&&i&&!t.equals(i)){var n=this.getRotation(),s=this._decomposed,u=new Vt,l=Dt.isZero;if(l(t.x)||l(t.y))u.translate(s.translation),n&&u.rotate(n),u.scale(i.x,i.y),this._matrix.set(u);else{var c=this.getPosition(!0);u.translate(c),n&&u.rotate(n),u.scale(i.x/t.x,i.y/t.y),n&&u.rotate(-n),u.translate(c.negate()),this.transform(u)}s&&(s.scaling=i,this._decomposed=s)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var i=this._globalMatrix;if(i)for(var n=this._parent,s=[];n;){if(!n._globalMatrix){i=null;for(var u=0,l=s.length;u<l;u++)s[u]._globalMatrix=null;break}s.push(n),n=n._parent}if(!i){i=this._globalMatrix=this._matrix.clone();var n=this._parent;n&&i.prepend(n.getGlobalMatrix(!0))}return t?i:i.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,i){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,s=0,u=n&&n.length;s<u;s++)n[s]._setProject(t);i=!0}i&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(i){t.base.call(this,i);for(var n=this._children,s=0,u=n&&n.length;s<u;s++)n[s]._installEvents(i)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof Re)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(t){var i=this._parent,n=i&&i._children;n&&i.insertChildren(t in n?t:B,[this])},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return A.equals(this._children,t._children)},clone:function(t){var i=new this.constructor(At.NO_INSERT),n=this._children,s=A.pick(t?t.insert:B,t===B||t===!0),u=A.pick(t?t.deep:B,!0);n&&i.copyAttributes(this),(!n||u)&&i.copyContent(this),n||i.copyAttributes(this),s&&i.insertAbove(this);var l=this._name,c=this._parent;if(l&&c){for(var n=c._children,f=l,d=1;n[l];)l=f+" "+d++;l!==f&&i.setName(l)}return i},copyContent:function(t){for(var i=t._children,n=0,s=i&&i.length;n<s;n++)this.addChild(i[n].clone(!1),!0)},copyAttributes:function(t,i){this.setStyle(t._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],s=0,u=n.length;s<u;s++){var l=n[s];t.hasOwnProperty(l)&&(this[l]=t[l])}i||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var c=t._data,f=t._name;this._data=c?A.clone(c):null,f&&this.setName(f)},rasterize:function(t,i){var n,s,u;A.isPlainObject(t)?(n=t.resolution,s=t.insert,u=t.raster):(n=t,s=i),u||(u=new ze(At.NO_INSERT));var l=this.getStrokeBounds(),c=(n||this.getView().getResolution())/72,f=l.getTopLeft().floor(),d=l.getBottomRight().ceil(),p=new _t(d.subtract(f)),y=p.multiply(c);if(u.setSize(y,!0),!y.isZero()){var P=u.getContext(!0),m=new Vt().scale(c).translate(f.negate());P.save(),m.applyToContext(P),this.draw(P,new A({matrices:[m]})),P.restore()}return u._matrix.set(new Vt().translate(f.add(p.divide(2))).scale(1/c)),(s===B||s)&&u.insertAbove(this),u},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(Z.read(arguments)))},_contains:function(t){var i=this._children;if(i){for(var n=i.length-1;n>=0;n--)if(i[n].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return Ct.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Xt.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,i){return t instanceof At?this._asPathItem().getIntersections(t._asPathItem(),null,i,!0).length>0:!1}},new function(){function t(){var s=arguments;return this._hitTest(Z.read(s),Te.getOptions(s))}function i(){var s=arguments,u=Z.read(s),l=Te.getOptions(s),c=[];return this._hitTest(u,new A({all:c},l)),c}function n(s,u,l,c){var f=this._children;if(f)for(var d=f.length-1;d>=0;d--){var p=f[d],y=p!==c&&p._hitTest(s,u,l);if(y&&!u.all)return y}return null}return ye.inject({hitTest:t,hitTestAll:i,_hitTest:n}),{hitTest:t,hitTestAll:i,_hitTestChildren:n}},{_hitTest:function(t,i,n){if(this._locked||!this._visible||this._guide&&!i.guides||this.isEmpty())return null;var s=this._matrix,u=n?n.appended(s):this.getGlobalMatrix().prepend(this.getView()._matrix),l=Math.max(i.tolerance,1e-12),c=i._tolerancePadding=new _t(Xt._getStrokePadding(l,s._shiftless().invert()));if(t=s._inverseTransform(t),!t||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(c.multiply(2))._containsPoint(t))return null;var f=!(i.guides&&!this._guide||i.selected&&!this.isSelected()||i.type&&i.type!==A.hyphenate(this._class)||i.class&&!(this instanceof i.class)),d=i.match,p=this,y,P;function m(v){return v&&d&&!d(v)&&(v=null),v&&i.all&&i.all.push(v),v}function g(v,x){var L=x?y["get"+x]():p.getPosition();if(t.subtract(L).divide(c).length<=1)return new Te(v,p,{name:x?A.hyphenate(x):v,point:L})}var T=i.position,w=i.center,O=i.bounds;if(f&&this._parent&&(T||w||O)){if((w||O)&&(y=this.getInternalBounds()),P=T&&g("position")||w&&g("center","Center"),!P&&O)for(var C=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],b=0;b<8&&!P;b++)P=g("bounds",C[b]);P=m(P)}return P||(P=this._hitTestChildren(t,i,u)||f&&m(this._hitTestSelf(t,i,u,this.getStrokeScaling()?null:u._shiftless().invert()))||null),P&&P.point&&(P.point=s.transform(P.point)),P},_hitTestSelf:function(t,i){if(i.fill&&this.hasFill()&&this._contains(t))return new Te("fill",this)},matches:function(t,i){function n(c,f){for(var d in c)if(c.hasOwnProperty(d)){var p=c[d],y=f[d];if(A.isPlainObject(p)&&A.isPlainObject(y)){if(!n(p,y))return!1}else if(!A.equals(p,y))return!1}return!0}var s=typeof t;if(s==="object"){for(var u in t)if(t.hasOwnProperty(u)&&!this.matches(u,t[u]))return!1;return!0}else{if(s==="function")return t(this);if(t==="match")return i(this);var l=/^(empty|editable)$/.test(t)?this["is"+A.capitalize(t)]():t==="type"?A.hyphenate(this._class):this[t];if(t==="class"){if(typeof i=="function")return this instanceof i;l=this._class}if(typeof i=="function")return!!i(l);if(i){if(i.test)return i.test(l);if(A.isPlainObject(i))return n(i,l)}return A.equals(l,i)}},getItems:function(t){return At._getItems(this,t,this._matrix)},getItem:function(t){return At._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(i,n,s,u,l){if(!u){var c=typeof n=="object"&&n,f=c&&c.overlapping,d=c&&c.inside,p=f||d,m=p&&Ct.read([p]);u={items:[],recursive:c&&c.recursive!==!1,inside:!!d,overlapping:!!f,rect:m,path:f&&new Xt.Rectangle({rectangle:m,insert:!1})},c&&(n=A.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var y=i._children,P=u.items,m=u.rect;s=m&&(s||new Vt);for(var g=0,T=y&&y.length;g<T;g++){var w=y[g],O=s&&s.appended(w._matrix),C=!0;if(m){var p=w.getBounds(O);if(!m.intersects(p))continue;m.contains(p)||u.overlapping&&(p.contains(m)||u.path.intersects(w,O))||(C=!1)}if(C&&w.matches(n)&&(P.push(w),l)||(u.recursive!==!1&&t(w,n,O,u,l),l&&P.length>0))break}return P}}},{importJSON:function(t){var i=A.importJSON(t,this);return i!==this?this.addChild(i):i},addChild:function(t){return this.insertChild(B,t)},insertChild:function(t,i){var n=i?this.insertChildren(t,[i]):null;return n&&n[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,i){var n=this._children;if(n&&i&&i.length>0){i=A.slice(i);for(var s={},u=i.length-1;u>=0;u--){var l=i[u],c=l&&l._id;!l||s[c]?i.splice(u,1):(l._remove(!1,!0),s[c]=!0)}A.splice(n,i,t,0);for(var f=this._project,d=f._changes,u=0,p=i.length;u<p;u++){var l=i[u],y=l._name;l._parent=this,l._setProject(f,!0),y&&l.setName(y),d&&l._changed(5)}this._changed(11)}else i=null;return i},_insertItem:"#insertChild",_insertAt:function(t,i){var n=t&&t._getOwner(),s=t!==this&&n?this:null;return s&&(s._remove(!1,!0),n._insertItem(t._index+i,s)),s},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(B,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(B,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var i=this._children;if(i&&i.length===1){var n=i[0].reduce(t);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var t=this._getOwner();if(t){var i=t._children,n=t._namedChildren,s=this._name,u=n[s],l=u?u.indexOf(this):-1;l!==-1&&(i[s]==this&&delete i[s],u.splice(l,1),u.length?i[s]=u[0]:delete n[s])}},_remove:function(t,i){var n=this._getOwner(),s=this._project,u=this._index;return this._style&&this._style._dispose(),n?(this._name&&this._removeNamed(),u!=null&&(s._activeLayer===this&&(s._activeLayer=this.getNextSibling()||this.getPreviousSibling()),A.splice(n._children,null,u,1)),this._installEvents(!1),t&&s._changes&&this._changed(5),i&&n._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var i=t&&t.insertBelow(this);return i&&this.remove(),i},removeChildren:function(t,i){if(!this._children)return null;t=t||0,i=A.pick(i,this._children.length);for(var n=A.splice(this._children,null,t,i-t),s=n.length-1;s>=0;s--)n[s]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,i=this._children.length;t<i;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var i=this._children,n=i?i.length:0;if(t){for(var s=0;s<n;s++)if(!i[s].isEmpty(t))return!1;return!0}return!n},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function i(c){var f=[];do f.unshift(c);while(c=c._parent);return f}for(var n=i(this),s=i(t),u=0,l=Math.min(n.length,s.length);u<l;u++)if(n[u]!=s[u])return n[u]._index<s[u]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(t){return this._getOrder(t)===-1},isBelow:function(t){return this._getOrder(t)===1},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var i=this;i=i._parent;)if(i===t)return!0;return!1},isAncestor:function(t){return t?t.isDescendant(this):!1},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var i=this._parent;i;){if(i._parent&&/^(Group|Layer|CompoundPath)$/.test(i._class)&&t.isDescendant(i))return!0;i=i._parent}return!1}},A.each(["rotate","scale","shear","skew"],function(t){var i=t==="rotate";this[t]=function(){var n=arguments,s=(i?A:Z).read(n),u=Z.read(n,0,{readNull:!0});return this.transform(new Vt()[t](s,u||this.getPosition(!0)))}},{translate:function(){var t=new Vt;return this.transform(t.translate.apply(t,arguments))},transform:function(t,i,n){var s=this._matrix,u=t&&!t.isIdentity(),l=n&&this._canApplyMatrix||this._applyMatrix&&(u||!s.isIdentity()||i&&this._children);if(!u&&!l)return this;if(u){!t.isInvertible()&&s.isInvertible()&&(s._backup=s.getValues()),s.prepend(t,!0);var c=this._style,f=c.getFillColor(!0),d=c.getStrokeColor(!0);f&&f.transform(t),d&&d.transform(t)}if(l&&(l=this._transformContent(s,i,n))){var p=this._pivot;p&&s._transformPoint(p,p,!0),s.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var y=this._bounds,P=this._position;(u||l)&&this._changed(25);var m=u&&y&&t.decompose();if(m&&m.skewing.isZero()&&m.rotation%90===0){for(var g in y){var T=y[g];if(T.nonscaling)delete y[g];else if(l||!T.internal){var w=T.rect;t._transformBounds(w,w)}}this._bounds=y;var O=y[this._getBoundsCacheKey(this._boundsOptions||{})];O&&(this._position=this._getPositionFromBounds(O.rect))}else u&&P&&this._pivot&&(this._position=t._transformPoint(P,P));return this},_transformContent:function(t,i,n){var s=this._children;if(s){for(var u=0,l=s.length;u<l;u++)s[u].transform(t,i,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(Z.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(Z.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(Z.read(arguments))},localToParent:function(){return this._matrix._transformPoint(Z.read(arguments))},fitBounds:function(t,i){t=Ct.read(arguments);var n=this.getBounds(),s=n.height/n.width,u=t.height/t.width,l=(i?s>u:s<u)?t.width/n.width:t.height/n.height,c=new Ct(new Z,new _t(n.width*l,n.height*l));c.setCenter(t.getCenter()),this.setBounds(c)}}),{_setStyles:function(t,i,n){var s=this._style,u=this._matrix;if(s.hasFill()&&(t.fillStyle=s.getFillColor().toCanvasStyle(t,u)),s.hasStroke()){t.strokeStyle=s.getStrokeColor().toCanvasStyle(t,u),t.lineWidth=s.getStrokeWidth();var l=s.getStrokeJoin(),c=s.getStrokeCap(),f=s.getMiterLimit();if(l&&(t.lineJoin=l),c&&(t.lineCap=c),f&&(t.miterLimit=f),Mt.support.nativeDash){var d=s.getDashArray(),p=s.getDashOffset();d&&d.length&&("setLineDash"in t?(t.setLineDash(d),t.lineDashOffset=p):(t.mozDash=d,t.mozDashOffset=p))}}if(s.hasShadow()){var y=i.pixelRatio||1,P=n._shiftless().prepend(new Vt().scale(y,y)),m=P.transform(new Z(s.getShadowBlur(),0)),g=P.transform(this.getShadowOffset());t.shadowColor=s.getShadowColor().toCanvasStyle(t),t.shadowBlur=m.getLength(),t.shadowOffsetX=g.x,t.shadowOffsetY=g.y}},draw:function(t,i,n){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var s=i.matrices,u=i.viewMatrix,l=this._matrix,c=s[s.length-1].appended(l);if(c.isInvertible()){u=u?u.appended(c):c,s.push(c),i.updateMatrix&&(this._globalMatrix=c);var f=this._blendMode,d=Dt.clamp(this._opacity,0,1),p=f==="normal",y=ei.nativeModes[f],P=p&&d===1||i.dontStart||i.clip||(y||p&&d<1)&&this._canComposite(),m=i.pixelRatio||1,g,T,w;if(!P){var O=this.getStrokeBounds(u);if(!O.width||!O.height){s.pop();return}w=i.offset,T=i.offset=O.getTopLeft().floor(),g=t,t=Qt.getContext(O.getSize().ceil().add(1).multiply(m)),m!==1&&t.scale(m,m)}t.save();var C=n?n.appended(l):this._canScaleStroke&&!this.getStrokeScaling(!0)&&u,b=!P&&i.clipItem,v=!C||b;if(P?(t.globalAlpha=d,y&&(t.globalCompositeOperation=f)):v&&t.translate(-T.x,-T.y),v&&(P?l:u).applyToContext(t),b&&i.clipItem.draw(t,i.extend({clip:!0})),C){t.setTransform(m,0,0,m,0,0);var x=i.offset;x&&t.translate(-x.x,-x.y)}this._draw(t,i,u,C),t.restore(),s.pop(),i.clip&&!i.dontFinish&&t.clip(this.getFillRule()),P||(ei.process(f,t,g,d,T.subtract(w).multiply(m)),Qt.release(t),i.offset=w)}}},_isUpdated:function(t){var i=this._parent;if(i instanceof be)return i._isUpdated(t);var n=this._updateVersion===t;return!n&&i&&i._visible&&i._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,i,n,s,u){var l=this._selection,c=l&1,f=l&2||c&&this._selectBounds,d=l&4;if(this._drawSelected||(c=!1),(c||f||d)&&this._isUpdated(u)){var p,y=this.getSelectedColor(!0)||(p=this.getLayer())&&p.getSelectedColor(!0),P=i.appended(this.getGlobalMatrix(!0)),m=n/2;if(t.strokeStyle=t.fillStyle=y?y.toCanvasStyle(t):"#009dec",c&&this._drawSelected(t,P,s),d){var g=this.getPosition(!0),T=this._parent,w=T?T.localToGlobal(g):g,O=w.x,C=w.y;t.beginPath(),t.arc(O,C,m,0,Math.PI*2,!0),t.stroke();for(var b=[[0,-1],[1,0],[0,1],[-1,0]],v=m,x=n+1,L=0;L<4;L++){var E=b[L],S=E[0],M=E[1];t.moveTo(O+S*v,C+M*v),t.lineTo(O+S*x,C+M*x),t.stroke()}}if(f){var X=P._transformCorners(this.getInternalBounds());t.beginPath();for(var L=0;L<8;L++)t[L?"lineTo":"moveTo"](X[L],X[++L]);t.closePath(),t.stroke();for(var L=0;L<8;L++)t.fillRect(X[L]-m,X[++L]-m,n,n)}}},_canComposite:function(){return!1}},A.each(["down","drag","up","move"],function(t){this["removeOn"+A.capitalize(t)]=function(){var i={};return i[t]=!0,this.removeOn(i)}},{removeOn:function(t){for(var i in t)if(t[i]){var n="mouse"+i,s=this._project,u=s._removeSets=s._removeSets||{};u[n]=u[n]||{},u[n][this._id]=this}return this}}),{tween:function(t,i,n){n||(n=i,i=t,t=null,n||(n=i,i=null));var s=n&&n.easing,u=n&&n.start,l=n!=null&&(typeof n=="number"?n:n.duration),c=new Li(this,t,i,l,s,u);function f(d){c._handleFrame(d.time*1e3),c.running||this.off("frame",f)}return l&&this.on("frame",f),c},tweenTo:function(t,i){return this.tween(null,t,i)},tweenFrom:function(t,i){return this.tween(t,null,i)}}),Se=At.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(i){this._children=[],this._namedChildren={},this._initialize(i)||this.addChildren(Array.isArray(i)?i:arguments)},_changed:function t(i){t.base.call(this,i),i&2050&&(this._clipItem=B)},_getClipItem:function(){var t=this._clipItem;if(t===B){t=null;for(var i=this._children,n=0,s=i.length;n<s;n++)if(i[n]._clipMask){t=i[n];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var i=this.getFirstChild();i&&i.setClipMask(t)},_getBounds:function t(i,n){var s=this._getClipItem();return s?s._getCachedBounds(s._matrix.prepended(i),A.set({},n,{stroke:!1})):t.base.call(this,i,n)},_hitTestChildren:function t(i,n,s){var u=this._getClipItem();return(!u||u.contains(i))&&t.base.call(this,i,n,s,u)},_draw:function(t,i){var n=i.clip,s=!n&&this._getClipItem();i=i.extend({clipItem:s,clip:!1}),n?(t.beginPath(),i.dontStart=i.dontFinish=!0):s&&s.draw(t,i.extend({clip:!0}));for(var u=this._children,l=0,c=u.length;l<c;l++){var f=u[l];f!==s&&f.draw(t,i)}}}),Re=Se.extend({_class:"Layer",initialize:function(){Se.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function t(){return this._parent?t.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),de=At.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(i,n){this._initialize(i,n)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&A.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new re(t.width,t.height,this,"setSize")},setSize:function(){var t=_t.read(arguments);if(!this._size)this._size=t.clone();else if(!this._size.equals(t)){var i=this._type,n=t.width,s=t.height;i==="rectangle"?this._radius.set(_t.min(this._radius,t.divide(2).abs())):i==="circle"?(n=s=(n+s)/2,this._radius=n/2):i==="ellipse"&&this._radius._set(n/2,s/2),this._size._set(n,s),this._changed(9)}},getRadius:function(){var t=this._radius;return this._type==="circle"?t:new re(t.width,t.height,this,"setRadius")},setRadius:function(t){var i=this._type;if(i==="circle"){if(t===this._radius)return;var n=t*2;this._radius=t,this._size._set(n,n)}else if(t=_t.read(arguments),!this._radius)this._radius=t.clone();else{if(this._radius.equals(t))return;if(this._radius.set(t),i==="rectangle"){var n=_t.max(this._size,t.multiply(2));this._size.set(n)}else i==="ellipse"&&this._size._set(t.width*2,t.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var i=new Xt[A.capitalize(this._type)]({center:new Z,size:this._size,radius:this._radius,insert:!1});return i.copyAttributes(this),Mt.settings.applyMatrix&&i.setApplyMatrix(!0),(t===B||t)&&i.insertAbove(this),i},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,i,n,s){var u=this._style,l=u.hasFill(),c=u.hasStroke(),f=i.dontFinish||i.clip,d=!s;if(l||c||f){var p=this._type,y=this._radius,P=p==="circle";if(i.dontStart||t.beginPath(),d&&P)t.arc(0,0,y,0,Math.PI*2,!0);else{var m=P?y:y.width,g=P?y:y.height,T=this._size,w=T.width,O=T.height;if(d&&p==="rectangle"&&m===0&&g===0)t.rect(-w/2,-O/2,w,O);else{var C=w/2,b=O/2,v=1-.5522847498307936,x=m*v,L=g*v,E=[-C,-b+g,-C,-b+L,-C+x,-b,-C+m,-b,C-m,-b,C-x,-b,C,-b+L,C,-b+g,C,b-g,C,b-L,C-x,b,C-m,b,-C+m,b,-C+x,b,-C,b-L,-C,b-g];s&&s.transform(E,E,32),t.moveTo(E[0],E[1]),t.bezierCurveTo(E[2],E[3],E[4],E[5],E[6],E[7]),C!==m&&t.lineTo(E[8],E[9]),t.bezierCurveTo(E[10],E[11],E[12],E[13],E[14],E[15]),b!==g&&t.lineTo(E[16],E[17]),t.bezierCurveTo(E[18],E[19],E[20],E[21],E[22],E[23]),C!==m&&t.lineTo(E[24],E[25]),t.bezierCurveTo(E[26],E[27],E[28],E[29],E[30],E[31])}}t.closePath()}!f&&(l||c)&&(this._setStyles(t,i,n),l&&(t.fill(u.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),c&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,i){var n=new Ct(this._size).setCenter(0,0),s=this._style,u=i.stroke&&s.hasStroke()&&s.getStrokeWidth();return t&&(n=t._transformBounds(n)),u?n.expand(Xt._getStrokePadding(u,this._getStrokeMatrix(t,i))):n}},new function(){function t(n,s,u){var l=n._radius;if(!l.isZero())for(var c=n._size.divide(2),f=1;f<=4;f++){var d=new Z(f>1&&f<4?-1:1,f>2?-1:1),p=d.multiply(c),y=p.subtract(d.multiply(l)),P=new Ct(u?p.add(d.multiply(u)):p,y);if(P.contains(s))return{point:y,quadrant:f}}}function i(n,s,u,l){var c=n.divide(s);return(!l||c.isInQuadrant(l))&&c.subtract(c.normalize()).multiply(s).divide(u).length<=1}return{_contains:function n(s){if(this._type==="rectangle"){var u=t(this,s);return u?s.subtract(u.point).divide(this._radius).getLength()<=1:n.base.call(this,s)}else return s.divide(this.size).getLength()<=.5},_hitTestSelf:function n(s,u,l,c){var f=!1,d=this._style,p=u.stroke&&d.hasStroke(),y=u.fill&&d.hasFill();if(p||y){var P=this._type,m=this._radius,g=p?d.getStrokeWidth()/2:0,T=u._tolerancePadding.add(Xt._getStrokePadding(g,!d.getStrokeScaling()&&c));if(P==="rectangle"){var w=T.multiply(2),O=t(this,s,w);if(O)f=i(s.subtract(O.point),m,T,O.quadrant);else{var C=new Ct(this._size).setCenter(0,0),b=C.expand(w),v=C.expand(w.negate());f=b._containsPoint(s)&&!v._containsPoint(s)}}else f=i(s,m,T)}return f?new Te(p?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(i,n,s,u,l){var c=A.create(de.prototype);return c._type=i,c._size=s,c._radius=u,c._initialize(A.getNamed(l),n),c}return{Circle:function(){var i=arguments,n=Z.readNamed(i,"center"),s=A.readNamed(i,"radius");return t("circle",n,new _t(s*2),s,i)},Rectangle:function(){var i=arguments,n=Ct.readNamed(i,"rectangle"),s=_t.min(_t.readNamed(i,"radius"),n.getSize(!0).divide(2));return t("rectangle",n.getCenter(!0),n.getSize(!0),s,i)},Ellipse:function(){var i=arguments,n=de._readEllipse(i),s=n.radius;return t("ellipse",n.center,s.multiply(2),s,i)},_readEllipse:function(i){var n,s;if(A.hasNamed(i,"radius"))n=Z.readNamed(i,"center"),s=_t.readNamed(i,"radius");else{var u=Ct.readNamed(i,"rectangle");n=u.getCenter(!0),s=u.getSize(!0).divide(2)}return{center:n,radius:s}}}}}),ze=At.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(i,n){if(!this._initialize(i,n!==B&&Z.read(arguments))){var s,u=typeof i,l=u==="string"?G.getElementById(i):u==="object"?i:null;if(l&&l!==At.NO_INSERT){if(l.getContext||l.naturalHeight!=null)s=l;else if(l){var c=_t.read(arguments);c.isZero()||(s=Qt.getCanvas(c))}}s?this.setImage(s):this.setSource(i)}this._size||(this._size=new _t,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var i=t._image,n=t._canvas;if(i)this._setImage(i);else if(n){var s=Qt.getCanvas(t._size);s.getContext("2d").drawImage(n,0,0),this._setImage(s)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new re(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,i){var n=_t.read(arguments);if(n.equals(this._size))i&&this.clear();else if(n.width>0&&n.height>0){var s=!i&&this.getElement();this._setImage(Qt.getCanvas(n)),s&&this.getContext(!0).drawImage(s,0,0,n.width,n.height)}else this._canvas&&Qt.release(this._canvas),this._size=n.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||t.width===0&&t.height===0},getResolution:function(){var t=this._matrix,i=new Z(0,0).transform(t),n=new Z(1,0).transform(t).subtract(i),s=new Z(0,1).transform(t).subtract(i);return new _t(72/n.getLength(),72/s.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var i=this;function n(s){var u=i.getView(),l=s&&s.type||"load";u&&i.responds(l)&&(Mt=u._scope,i.emit(l,new Ue(s)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&Wt.add(t,{load:function(s){i._setImage(t),n(s)},error:n})},_setImage:function(t){this._canvas&&Qt.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new _t(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=Qt.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch{Qt.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var i=new a.Image,n=this._crossOrigin;n&&(i.crossOrigin=n),t&&(i.src=t),this.setImage(i)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var i=this._image;i&&(i.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=typeof t=="string"?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=Ct.read(arguments),i=Qt.getContext(t.getSize());return i.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),i.canvas},getSubRaster:function(){var t=Ct.read(arguments),i=new ze(At.NO_INSERT);return i._setImage(this.getSubCanvas(t)),i.translate(t.getCenter().subtract(this.getSize().divide(2))),i._matrix.prepend(this._matrix),i.insertAbove(this),i},toDataURL:function(){var t=this._image,i=t&&t.src;if(/^data:/.test(i))return i;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(t){var i=Z.read(arguments,1);this.getContext(!0).drawImage(t,i.x,i.y)},getAverageColor:function(t){var i,n;if(t?t instanceof Xe?(n=t,i=t.getBounds()):typeof t=="object"&&("width"in t?i=new Ct(t):"x"in t&&(i=new Ct(t.x-.5,t.y-.5,1,1))):i=this.getBounds(),!i)return null;var s=32,u=Math.min(i.width,s),l=Math.min(i.height,s),c=ze._sampleContext;c?c.clearRect(0,0,s+1,s+1):c=ze._sampleContext=Qt.getContext(new _t(s)),c.save();var f=new Vt().scale(u/i.width,l/i.height).translate(-i.x,-i.y);f.applyToContext(c),n&&n.draw(c,new A({clip:!0,matrices:[f]})),this._matrix.applyToContext(c);var d=this.getElement(),p=this._size;d&&c.drawImage(d,-p.width/2,-p.height/2),c.restore();for(var y=c.getImageData(.5,.5,Math.ceil(u),Math.ceil(l)).data,P=[0,0,0],m=0,g=0,T=y.length;g<T;g+=4){var w=y[g+3];m+=w,w/=255,P[0]+=y[g]*w,P[1]+=y[g+1]*w,P[2]+=y[g+2]*w}for(var g=0;g<3;g++)P[g]/=m;return m?Kt.read(P):null},getPixel:function(){var t=Z.read(arguments),i=this.getContext().getImageData(t.x,t.y,1,1).data;return new Kt("rgb",[i[0]/255,i[1]/255,i[2]/255],i[3]/255)},setPixel:function(){var t=arguments,i=Z.read(t),n=Kt.read(t),s=n._convert("rgb"),u=n._alpha,l=this.getContext(!0),c=l.createImageData(1,1),f=c.data;f[0]=s[0]*255,f[1]=s[1]*255,f[2]=s[2]*255,f[3]=u!=null?u*255:255,l.putImageData(c,i.x,i.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=_t.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=Ct.read(arguments);return t.isEmpty()&&(t=new Ct(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var i=Z.read(arguments,1);this.getContext(!0).putImageData(t,i.x,i.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,i){var n=new Ct(this._size).setCenter(0,0);return t?t._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var i=this;return new Te("pixel",i,{offset:t.add(i._size.divide(2)).round(),color:{get:function(){return i.getPixel(this.offset)}}})}},_draw:function(t,i,n){var s=this.getElement();if(s&&s.width>0&&s.height>0){t.globalAlpha=Dt.clamp(this._opacity,0,1),this._setStyles(t,i,n);var u=this._smoothing,l=u==="off";Ht.setPrefixed(t,l?"imageSmoothingEnabled":"imageSmoothingQuality",l?!1:u),t.drawImage(s,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ke=At.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(i,n){this._initialize(i,n!==B&&Z.read(arguments,1))||this.setDefinition(i instanceof Pe?i:new Pe(i))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,i){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(t),i)},_hitTestSelf:function(t,i,n){var s=i.extend({all:!1}),u=this._definition._item._hitTest(t,s,n);return u&&(u.item=this),u},_draw:function(t,i){this._definition._item.draw(t,i)}}),Pe=A.extend({_class:"SymbolDefinition",initialize:function(i,n){this._id=we.get(),this.project=Mt.project,i&&this.setItem(i,n)},_serialize:function(t,i){return i.add(this,function(){return A.serialize([this._class,this._item],t,!1,i)})},_changed:function(t){t&8&&At._clearBoundsCache(this),t&1&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,i){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),i||t.setPosition(new Z),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new Ke(this,t)},clone:function(){return new Pe(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),Te=A.extend({_class:"HitResult",initialize:function(i,n,s){this.type=i,this.item=n,s&&this.inject(s)},statics:{getOptions:function(t){var i=t&&A.read(t);return new A({type:null,tolerance:Mt.settings.hitTolerance,fill:!i,stroke:!i,segments:!i,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},i)}}}),yt=A.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(i,n,s,u,l,c){var f=arguments.length,d,p,y,P;f>0&&(i==null||typeof i=="object"?f===1&&i&&"point"in i?(d=i.point,p=i.handleIn,y=i.handleOut,P=i.selection):(d=i,p=n,y=s,P=u):(d=[i,n],p=s!==B?[s,u]:null,y=l!==B?[l,c]:null)),new Qe(d,this,"_point"),new Qe(p,this,"_handleIn"),new Qe(y,this,"_handleOut"),P&&this.setSelection(P)},_serialize:function(t,i){var n=this._point,s=this._selection,u=s||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return s&&u.push(s),A.serialize(u,t,!0,i)},_changed:function(t){var i=this._path;if(i){var n=i._curves,s=this._index,u;n&&((!t||t===this._point||t===this._handleIn)&&(u=s>0?n[s-1]:i._closed?n[n.length-1]:null)&&u._changed(),(!t||t===this._point||t===this._handleOut)&&(u=n[s])&&u._changed()),i._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(Z.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(Z.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(Z.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,i=this._handleOut;return!t.isZero()&&!i.isZero()&&t.isCollinear(i)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var i=this._selection,n=this._path;this._selection=t=t||0,n&&t!==i&&(n._updateSelection(this,i,t),n._changed(257))},_changeSelection:function(t,i){var n=this._selection;this.setSelection(i?n|t:n&~t)},isSelected:function(){return!!(this._selection&7)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==B?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,i=this._index;return t?(i>0&&!t._closed&&i===t._segments.length-1&&i--,t.getCurves()[i]||null):null},getLocation:function(){var t=this.getCurve();return t?new xe(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,i,n){var s=t||{},u=s.type,l=s.factor,c=this.getPrevious(),f=this.getNext(),d=(c||this)._point,p=this._point,y=(f||this)._point,P=d.getDistance(p),m=p.getDistance(y);if(!u||u==="catmull-rom"){var g=l===B?.5:l,T=Math.pow(P,g),w=T*T,O=Math.pow(m,g),C=O*O;if(!i&&c){var b=2*C+3*O*T+w,v=3*O*(O+T);this.setHandleIn(v!==0?new Z((C*d._x+b*p._x-w*y._x)/v-p._x,(C*d._y+b*p._y-w*y._y)/v-p._y):new Z)}if(!n&&f){var b=2*w+3*T*O+C,v=3*T*(T+O);this.setHandleOut(v!==0?new Z((w*y._x+b*p._x-C*d._x)/v-p._x,(w*y._y+b*p._y-C*d._y)/v-p._y):new Z)}}else if(u==="geometric"){if(c&&f){var x=d.subtract(y),L=l===B?.4:l,E=L*P/(P+m);i||this.setHandleIn(x.multiply(E)),n||this.setHandleOut(x.multiply(E-L))}}else throw new Error("Smoothing method '"+u+"' not supported.")},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,i=this._handleOut,n=t.clone();t.set(i),i.set(n)},reversed:function(){return new yt(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new yt(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,i,n){var s=1-n,u=n,l=t._point,c=i._point,f=t._handleIn,d=i._handleIn,p=i._handleOut,y=t._handleOut;this._point._set(s*l._x+u*c._x,s*l._y+u*c._y,!0),this._handleIn._set(s*f._x+u*d._x,s*f._y+u*d._y,!0),this._handleOut._set(s*y._x+u*p._x,s*y._y+u*p._y,!0),this._changed()},_transformCoordinates:function(t,i,n){var s=this._point,u=!n||!this._handleIn.isZero()?this._handleIn:null,l=!n||!this._handleOut.isZero()?this._handleOut:null,c=s._x,f=s._y,d=2;return i[0]=c,i[1]=f,u&&(i[d++]=u._x+c,i[d++]=u._y+f),l&&(i[d++]=l._x+c,i[d++]=l._y+f),t&&(t._transformCoordinates(i,i,d/2),c=i[0],f=i[1],n?(s._x=c,s._y=f,d=2,u&&(u._x=i[d++]-c,u._y=i[d++]-f),l&&(l._x=i[d++]-c,l._y=i[d++]-f)):(u||(i[d++]=c,i[d++]=f),l||(i[d++]=c,i[d++]=f))),i}}),Qe=Z.extend({initialize:function(i,n,s){var u,l,c;if(!i)u=l=0;else if((u=i[0])!==B)l=i[1];else{var f=i;(u=f.x)===B&&(f=Z.read(arguments),u=f.x),l=f.y,c=f.selected}this._x=u,this._y=l,this._owner=n,n[s]=this,c&&this.setSelected(!0)},_set:function(t,i){return this._x=t,this._y=i,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=Dt.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),ht=A.extend({_class:"Curve",beans:!0,initialize:function(i,n,s,u,l,c,f,d){var p=arguments.length,y,P,m,g,T,w;p===3?(this._path=i,y=n,P=s):p?p===1?"segment1"in i?(y=new yt(i.segment1),P=new yt(i.segment2)):"point1"in i?(m=i.point1,T=i.handle1,w=i.handle2,g=i.point2):Array.isArray(i)&&(m=[i[0],i[1]],g=[i[6],i[7]],T=[i[2]-i[0],i[3]-i[1]],w=[i[4]-i[6],i[5]-i[7]]):p===2?(y=new yt(i),P=new yt(n)):p===4?(m=i,T=n,w=s,g=u):p===8&&(m=[i,n],g=[f,d],T=[s-i,u-n],w=[l-f,c-d]):(y=new yt,P=new yt),this._segment1=y||new yt(m,null,T),this._segment2=P||new yt(g,w,null)},_serialize:function(t,i){return A.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,i)},_changed:function(){this._length=this._bounds=B},clone:function(){return new ht(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return ht.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var i=this._segment2,n=i._handleOut;t=i.remove(),t&&this._segment1._handleOut.set(n)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(Z.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(Z.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(Z.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(Z.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return ht.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),i=[],n=0;n<8;n+=2)i.push(new Z(t[n],t[n+1]));return i}},{getLength:function(){return this._length==null&&(this._length=ht.getLength(this.getValues(),0,1)),this._length},getArea:function(){return ht.getArea(this.getValues())},getLine:function(){return new se(this._segment1._point,this._segment2._point)},getPart:function(t,i){return new ht(ht.getPart(this.getValues(),t,i))},getPartLength:function(t,i){return ht.getLength(this.getValues(),t,i)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,i){var n=1e-8,s=1-n,u=null;if(t>=n&&t<=s){var l=ht.subdivide(this.getValues(),t),c=l[0],f=l[1],d=i||this.hasHandles(),p=this._segment1,y=this._segment2,P=this._path;d&&(p._handleOut._set(c[2]-c[0],c[3]-c[1]),y._handleIn._set(f[4]-f[6],f[5]-f[7]));var m=c[6],g=c[7],T=new yt(new Z(m,g),d&&new Z(c[4]-m,c[5]-g),d&&new Z(f[2]-m,f[3]-g));P?(P.insert(p._index+1,T),u=this.getNext()):(this._segment2=T,this._changed(),u=new ht(T,y))}return u},splitAt:function(t){var i=this._path;return i?i.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,i){return this.divideAtTime(t===B?.5:i?t:this.getTimeAt(t))},split:function(t,i){return this.splitAtTime(t===B?.5:i?t:this.getTimeAt(t))},reversed:function(){return new ht(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,i,n,s){var u=t._point,l=t._handleOut,c=i._handleIn,f=i._point,d=u.x,p=u.y,y=f.x,P=f.y,m=s?[d,p,d,p,y,P,y,P]:[d,p,d+l._x,p+l._y,y+c._x,P+c._y,y,P];return n&&n._transformCoordinates(m,m,4),m},subdivide:function(t,i){var n=t[0],s=t[1],u=t[2],l=t[3],c=t[4],f=t[5],d=t[6],p=t[7];i===B&&(i=.5);var y=1-i,P=y*n+i*u,m=y*s+i*l,g=y*u+i*c,T=y*l+i*f,w=y*c+i*d,O=y*f+i*p,C=y*P+i*g,b=y*m+i*T,v=y*g+i*w,x=y*T+i*O,L=y*C+i*v,E=y*b+i*x;return[[n,s,P,m,C,b,L,E],[L,E,v,x,w,O,d,p]]},getMonoCurves:function(t,i){var n=[],s=i?0:1,u=t[s+0],l=t[s+2],c=t[s+4],f=t[s+6];if(u>=l==l>=c&&l>=c==c>=f||ht.isStraight(t))n.push(t);else{var d=3*(l-c)-u+f,p=2*(u+c)-4*l,y=l-u,P=1e-8,m=1-P,g=[],T=Dt.solveQuadratic(d,p,y,g,P,m);if(!T)n.push(t);else{g.sort();var w=g[0],O=ht.subdivide(t,w);n.push(O[0]),T>1&&(w=(g[1]-w)/(1-w),O=ht.subdivide(O[1],w),n.push(O[0])),n.push(O[1])}}return n},solveCubic:function(t,i,n,s,u,l){var c=t[i],f=t[i+2],d=t[i+4],p=t[i+6],y=0;if(!(c<n&&p<n&&f<n&&d<n||c>n&&p>n&&f>n&&d>n)){var P=3*(f-c),m=3*(d-f)-P,g=p-c-P-m;y=Dt.solveCubic(g,m,P,c-n,s,u,l)}return y},getTimeOf:function(t,i){var n=new Z(t[0],t[1]),s=new Z(t[6],t[7]),u=1e-12,l=1e-7,c=i.isClose(n,u)?0:i.isClose(s,u)?1:null;if(c===null)for(var f=[i.x,i.y],d=[],p=0;p<2;p++)for(var y=ht.solveCubic(t,p,f[p],d,0,1),P=0;P<y;P++){var m=d[P];if(i.isClose(ht.getPoint(t,m),l))return m}return i.isClose(n,l)?0:i.isClose(s,l)?1:null},getNearestTime:function(t,i){if(ht.isStraight(t)){var n=t[0],s=t[1],u=t[6],l=t[7],c=u-n,f=l-s,d=c*c+f*f;if(d===0)return 0;var p=((i.x-n)*c+(i.y-s)*f)/d;return p<1e-12?0:p>.999999999999?1:ht.getTimeOf(t,new Z(n+p*c,s+p*f))}var y=100,P=1/0,m=0;function g(O){if(O>=0&&O<=1){var C=i.getDistance(ht.getPoint(t,O),!0);if(C<P)return P=C,m=O,!0}}for(var T=0;T<=y;T++)g(T/y);for(var w=1/(y*2);w>1e-8;)!g(m-w)&&!g(m+w)&&(w/=2);return m},getPart:function(t,i,n){var s=i>n;if(s){var u=i;i=n,n=u}return i>0&&(t=ht.subdivide(t,i)[1]),n<1&&(t=ht.subdivide(t,(n-i)/(1-i))[0]),s?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,i){var n=t[0],s=t[1],u=t[2],l=t[3],c=t[4],f=t[5],d=t[6],p=t[7],y=3*u-2*n-d,P=3*l-2*s-p,m=3*c-2*d-n,g=3*f-2*p-s;return Math.max(y*y,m*m)+Math.max(P*P,g*g)<=16*i*i},getArea:function(t){var i=t[0],n=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],d=t[7];return 3*((d-n)*(s+l)-(f-i)*(u+c)+u*(i-l)-s*(n-c)+d*(l+i/3)-f*(c+n/3))/20},getBounds:function(t){for(var i=t.slice(0,2),n=i.slice(),s=[0,0],u=0;u<2;u++)ht._addBounds(t[u],t[u+2],t[u+4],t[u+6],u,0,i,n,s);return new Ct(i[0],i[1],n[0]-i[0],n[1]-i[1])},_addBounds:function(t,i,n,s,u,l,c,f,d){function p(L,E){var S=L-E,M=L+E;S<c[u]&&(c[u]=S),M>f[u]&&(f[u]=M)}l/=2;var y=c[u]+l,P=f[u]-l;if(t<y||i<y||n<y||s<y||t>P||i>P||n>P||s>P)if(i<t!=i<s&&n<t!=n<s)p(t,0),p(s,0);else{var m=3*(i-n)-t+s,g=2*(t+n)-4*i,T=i-t,w=Dt.solveQuadratic(m,g,T,d),O=1e-8,C=1-O;p(s,0);for(var b=0;b<w;b++){var v=d[b],x=1-v;O<=v&&v<=C&&p(x*x*x*t+3*x*x*v*i+3*x*v*v*n+v*v*v*s,l)}}}}},A.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){this._bounds||(this._bounds={});var i=this._bounds[t];return i||(i=this._bounds[t]=Xt[t]([this._segment1,this._segment2],!1,this._path)),i.clone()}},{}),A.each({isStraight:function(t,i,n,s){if(i.isZero()&&n.isZero())return!0;var u=s.subtract(t);if(u.isZero())return!1;if(u.isCollinear(i)&&u.isCollinear(n)){var l=new se(t,s),c=1e-7;if(l.getDistance(t.add(i))<c&&l.getDistance(s.add(n))<c){var f=u.dot(u),d=u.dot(i)/f,p=u.dot(n)/f;return d>=0&&d<=1&&p<=0&&p>=-1}}return!1},isLinear:function(t,i,n,s){var u=s.subtract(t).divide(3);return i.equals(u)&&n.negate().equals(u)}},function(t,i){this[i]=function(n){var s=this._segment1,u=this._segment2;return t(s._point,s._handleOut,u._handleIn,u._point,n)},this.statics[i]=function(n,s){var u=n[0],l=n[1],c=n[6],f=n[7];return t(new Z(u,l),new Z(n[2]-u,n[3]-l),new Z(n[4]-c,n[5]-f),new Z(c,f),s)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,i){return this.getLocationAtTime(i?t:this.getTimeAt(t))},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new xe(this,t):null},getTimeAt:function(t,i){return ht.getTimeAt(this.getValues(),t,i)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=Z.read(arguments);return t.isZero()?[]:ht.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(Z.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return ht.getTimeOf(this.getValues(),Z.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=Z.read(arguments),i=this.getValues(),n=ht.getNearestTime(i,t),s=ht.getPoint(i,n);return new xe(this,n,s,null,t.getDistance(s))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return A.each(t,function(i){this[i+"At"]=function(n,s){var u=this.getValues();return ht[i](u,s?n:ht.getTimeAt(u,n))},this[i+"AtTime"]=function(n){return ht[i](this.getValues(),n)}},{statics:{_evaluateMethods:t}})},new function(){function t(s){var u=s[0],l=s[1],c=s[2],f=s[3],d=s[4],p=s[5],y=s[6],P=s[7],m=9*(c-d)+3*(y-u),g=6*(u+d)-12*c,T=3*(c-u),w=9*(f-p)+3*(P-l),O=6*(l+p)-12*f,C=3*(f-l);return function(b){var v=(m*b+g)*b+T,x=(w*b+O)*b+C;return Math.sqrt(v*v+x*x)}}function i(s,u){return Math.max(2,Math.min(16,Math.ceil(Math.abs(u-s)*32)))}function n(s,u,l,c){if(u==null||u<0||u>1)return null;var f=s[0],d=s[1],p=s[2],y=s[3],P=s[4],m=s[5],g=s[6],T=s[7],w=Dt.isZero;w(p-f)&&w(y-d)&&(p=f,y=d),w(P-g)&&w(m-T)&&(P=g,m=T);var O=3*(p-f),C=3*(P-p)-O,b=g-f-O-C,v=3*(y-d),x=3*(m-y)-v,L=T-d-v-x,E,S;if(l===0)E=u===0?f:u===1?g:((b*u+C)*u+O)*u+f,S=u===0?d:u===1?T:((L*u+x)*u+v)*u+d;else{var M=1e-8,X=1-M;if(u<M?(E=O,S=v):u>X?(E=3*(g-P),S=3*(T-m)):(E=(3*b*u+2*C)*u+O,S=(3*L*u+2*x)*u+v),c){E===0&&S===0&&(u<M||u>X)&&(E=P-p,S=m-y);var k=Math.sqrt(E*E+S*S);k&&(E/=k,S/=k)}if(l===3){var P=6*b*u+2*C,m=6*L*u+2*x,V=Math.pow(E*E+S*S,3/2);E=V!==0?(E*m-S*P)/V:0,S=0}}return l===2?new Z(S,-E):new Z(E,S)}return{statics:{classify:function(s){var u=s[0],l=s[1],c=s[2],f=s[3],d=s[4],p=s[5],y=s[6],P=s[7],m=u*(P-p)+l*(d-y)+y*p-P*d,g=c*(l-P)+f*(y-u)+u*P-l*y,T=d*(f-l)+p*(u-c)+c*l-f*u,w=3*T,O=w-g,C=O-g+m,b=Math.sqrt(C*C+O*O+w*w),v=b!==0?1/b:0,x=Dt.isZero,L="serpentine";C*=v,O*=v,w*=v;function E(k,V,D){var z=V!==B,q=z&&V>0&&V<1,H=z&&D>0&&D<1;return z&&(!(q||H)||k==="loop"&&!(q&&H))&&(k="arch",q=H=!1),{type:k,roots:q||H?q&&H?V<D?[V,D]:[D,V]:[q?V:D]:null}}if(x(C))return x(O)?E(x(w)?"line":"quadratic"):E(L,w/(3*O));var S=3*O*O-4*C*w;if(x(S))return E("cusp",O/(2*C));var M=S>0?Math.sqrt(S/3):Math.sqrt(-S),X=2*C;return E(S>0?L:"loop",(O+M)/X,(O-M)/X)},getLength:function(s,u,l,c){if(u===B&&(u=0),l===B&&(l=1),ht.isStraight(s)){var f=s;l<1&&(f=ht.subdivide(f,l)[0],u/=l),u>0&&(f=ht.subdivide(f,u)[1]);var d=f[6]-f[0],p=f[7]-f[1];return Math.sqrt(d*d+p*p)}return Dt.integrate(c||t(s),u,l,i(u,l))},getTimeAt:function(s,u,l){if(l===B&&(l=u<0?1:0),u===0)return l;var c=Math.abs,f=1e-12,d=u>0,p=d?l:0,y=d?1:l,P=t(s),m=ht.getLength(s,p,y,P),g=c(u)-m;if(c(g)<f)return d?y:p;if(g>f)return null;var T=u/m,w=0;function O(C){return w+=Dt.integrate(P,l,C,i(l,C)),l=C,w-u}return Dt.findRoot(O,P,l+T,p,y,32,1e-12)},getPoint:function(s,u){return n(s,u,0,!1)},getTangent:function(s,u){return n(s,u,1,!0)},getWeightedTangent:function(s,u){return n(s,u,1,!1)},getNormal:function(s,u){return n(s,u,2,!0)},getWeightedNormal:function(s,u){return n(s,u,2,!1)},getCurvature:function(s,u){return n(s,u,3,!1).x},getPeaks:function(s){var u=s[0],l=s[1],c=s[2],f=s[3],d=s[4],p=s[5],y=s[6],P=s[7],m=-u+3*c-3*d+y,g=3*u-6*c+3*d,T=-3*u+3*c,w=-l+3*f-3*p+P,O=3*l-6*f+3*p,C=-3*l+3*f,b=1e-8,v=1-b,x=[];return Dt.solveCubic(9*(m*m+w*w),9*(m*g+O*w),2*(g*g+O*O)+3*(T*m+C*w),T*g+O*C,x,b,v),x.sort()}}}},new function(){function t(g,T,w,O,C,b,v){var x=!v&&w.getPrevious()===C,L=!v&&w!==C&&w.getNext()===C,E=1e-8,S=1-E;if(O!==null&&O>=(x?E:0)&&O<=(L?S:1)&&b!==null&&b>=(L?E:0)&&b<=(x?S:1)){var M=new xe(w,O,null,v),X=new xe(C,b,null,v);M._intersection=X,X._intersection=M,(!T||T(M))&&xe.insert(g,M,!0)}}function i(g,T,w,O,C,b,v,x,L,E,S,M,X){if(++L>=4096||++x>=40)return L;var k=1e-9,V=T[0],D=T[1],z=T[6],q=T[7],H=se.getSignedDistance,U=H(V,D,z,q,T[2],T[3]),j=H(V,D,z,q,T[4],T[5]),rt=U*j>0?3/4:4/9,at=rt*Math.min(0,U,j),ut=rt*Math.max(0,U,j),ft=H(V,D,z,q,g[0],g[1]),tt=H(V,D,z,q,g[2],g[3]),it=H(V,D,z,q,g[4],g[5]),lt=H(V,D,z,q,g[6],g[7]),dt=n(ft,tt,it,lt),ct=dt[0],Pt=dt[1],gt,It;if(U===0&&j===0&&ft===0&&tt===0&&it===0&&lt===0||(gt=s(ct,Pt,at,ut))==null||(It=s(ct.reverse(),Pt.reverse(),at,ut))==null)return L;var Et=E+(S-E)*gt,bt=E+(S-E)*It;if(Math.max(X-M,bt-Et)<k){var $t=(Et+bt)/2,te=(M+X)/2;t(C,b,v?O:w,v?te:$t,v?w:O,v?$t:te)}else{g=ht.getPart(g,gt,It);var ne=X-M;if(It-gt>.8)if(bt-Et>ne){var Gt=ht.subdivide(g,.5),$t=(Et+bt)/2;L=i(T,Gt[0],O,w,C,b,!v,x,L,M,X,Et,$t),L=i(T,Gt[1],O,w,C,b,!v,x,L,M,X,$t,bt)}else{var Gt=ht.subdivide(T,.5),te=(M+X)/2;L=i(Gt[0],g,O,w,C,b,!v,x,L,M,te,Et,bt),L=i(Gt[1],g,O,w,C,b,!v,x,L,te,X,Et,bt)}else ne===0||ne>=k?L=i(T,g,O,w,C,b,!v,x,L,M,X,Et,bt):L=i(g,T,w,O,C,b,v,x,L,Et,bt,M,X)}return L}function n(g,T,w,O){var C=[0,g],b=[1/3,T],v=[2/3,w],x=[1,O],L=T-(2*g+O)/3,E=w-(g+2*O)/3,S;if(L*E<0)S=[[C,b,x],[C,v,x]];else{var M=L/E;S=[M>=2?[C,b,x]:M<=.5?[C,v,x]:[C,b,v,x],[C,x]]}return(L||E)<0?S.reverse():S}function s(g,T,w,O){return g[0][1]<w?u(g,!0,w):T[0][1]>O?u(T,!1,O):g[0][0]}function u(g,T,w){for(var O=g[0][0],C=g[0][1],b=1,v=g.length;b<v;b++){var x=g[b][0],L=g[b][1];if(T?L>=w:L<=w)return L===w?x:O+(w-C)*(x-O)/(L-C);O=x,C=L}return null}function l(g,T,w,O,C){var b=Dt.isZero;if(b(O)&&b(C)){var v=ht.getTimeOf(g,new Z(T,w));return v===null?[]:[v]}for(var x=Math.atan2(-C,O),L=Math.sin(x),E=Math.cos(x),S=[],M=[],X=0;X<8;X+=2){var k=g[X]-T,V=g[X+1]-w;S.push(k*E-V*L,k*L+V*E)}return ht.solveCubic(S,1,0,M,0,1),M}function c(g,T,w,O,C,b,v){for(var x=T[0],L=T[1],E=T[6],S=T[7],M=l(g,x,L,E-x,S-L),X=0,k=M.length;X<k;X++){var V=M[X],D=ht.getPoint(g,V),z=ht.getTimeOf(T,D);z!==null&&t(C,b,v?O:w,v?z:V,v?w:O,v?V:z)}}function f(g,T,w,O,C,b){var v=se.intersect(g[0],g[1],g[6],g[7],T[0],T[1],T[6],T[7]);v&&t(C,b,w,ht.getTimeOf(g,v),O,ht.getTimeOf(T,v))}function d(g,T,w,O,C,b){var v=1e-12,x=Math.min,L=Math.max;if(L(g[0],g[2],g[4],g[6])+v>x(T[0],T[2],T[4],T[6])&&x(g[0],g[2],g[4],g[6])-v<L(T[0],T[2],T[4],T[6])&&L(g[1],g[3],g[5],g[7])+v>x(T[1],T[3],T[5],T[7])&&x(g[1],g[3],g[5],g[7])-v<L(T[1],T[3],T[5],T[7])){var E=P(g,T);if(E)for(var S=0;S<2;S++){var M=E[S];t(C,b,w,M[0],O,M[1],!0)}else{var X=ht.isStraight(g),k=ht.isStraight(T),V=X&&k,D=X&&!k,z=C.length;if((V?f:X||k?c:i)(D?T:g,D?g:T,D?O:w,D?w:O,C,b,D,0,0,0,1,0,1),!V||C.length===z)for(var S=0;S<4;S++){var q=S>>1,H=S&1,U=q*6,j=H*6,rt=new Z(g[U],g[U+1]),at=new Z(T[j],T[j+1]);rt.isClose(at,v)&&t(C,b,w,q,O,H)}}}return C}function p(g,T,w,O){var C=ht.classify(g);if(C.type==="loop"){var b=C.roots;t(w,O,T,b[0],T,b[1])}return w}function y(g,T,w,O,C,b){var v=1e-7,x=!T;x&&(T=g);for(var L=g.length,E=T.length,S=new Array(L),M=x?S:new Array(E),X=[],k=0;k<L;k++)S[k]=g[k].getValues(O);if(!x)for(var k=0;k<E;k++)M[k]=T[k].getValues(C);for(var V=Me.findCurveBoundsCollisions(S,M,v),D=0;D<L;D++){var z=g[D],q=S[D];x&&p(q,z,X,w);var H=V[D];if(H)for(var U=0;U<H.length;U++){if(b&&X.length)return X;var j=H[U];if(!x||j>D){var rt=T[j],at=M[j];d(q,at,z,rt,X,w)}}}return X}function P(g,T){function w(lt){var dt=lt[6]-lt[0],ct=lt[7]-lt[1];return dt*dt+ct*ct}var O=Math.abs,C=se.getDistance,b=1e-8,v=1e-7,x=ht.isStraight(g),L=ht.isStraight(T),E=x&&L,S=w(g)<w(T),M=S?T:g,X=S?g:T,k=M[0],V=M[1],D=M[6]-k,z=M[7]-V;if(C(k,V,D,z,X[0],X[1],!0)<v&&C(k,V,D,z,X[6],X[7],!0)<v)!E&&C(k,V,D,z,M[2],M[3],!0)<v&&C(k,V,D,z,M[4],M[5],!0)<v&&C(k,V,D,z,X[2],X[3],!0)<v&&C(k,V,D,z,X[4],X[5],!0)<v&&(x=L=E=!0);else if(E)return null;if(x^L)return null;for(var q=[g,T],H=[],U=0;U<4&&H.length<2;U++){var j=U&1,rt=j^1,at=U>>1,ut=ht.getTimeOf(q[j],new Z(q[rt][at?6:0],q[rt][at?7:1]));if(ut!=null){var ft=j?[at,ut]:[ut,at];(!H.length||O(ft[0]-H[0][0])>b&&O(ft[1]-H[0][1])>b)&&H.push(ft)}if(U>2&&!H.length)break}if(H.length!==2)H=null;else if(!E){var tt=ht.getPart(g,H[0][0],H[1][0]),it=ht.getPart(T,H[0][1],H[1][1]);(O(it[2]-tt[2])>v||O(it[3]-tt[3])>v||O(it[4]-tt[4])>v||O(it[5]-tt[5])>v)&&(H=null)}return H}function m(g,T){var w=g[0],O=g[1],C=g[2],b=g[3],v=g[4],x=g[5],L=g[6],E=g[7],S=T.normalize(),M=S.x,X=S.y,k=3*L-9*v+9*C-3*w,V=3*E-9*x+9*b-3*O,D=6*v-12*C+6*w,z=6*x-12*b+6*O,q=3*C-3*w,H=3*b-3*O,U=2*k*X-2*V*M,j=[];if(Math.abs(U)<Dt.CURVETIME_EPSILON){var rt=k*H-V*q,U=k*z-V*D;if(U!=0){var at=-rt/U;at>=0&&at<=1&&j.push(at)}}else{var ut=(D*D-4*k*q)*X*X+(-2*D*z+4*V*q+4*k*H)*M*X+(z*z-4*V*H)*M*M,ft=D*X-z*M;if(ut>=0&&U!=0){var tt=Math.sqrt(ut),it=-(ft+tt)/U,lt=(-ft+tt)/U;it>=0&&it<=1&&j.push(it),lt>=0&&lt<=1&&j.push(lt)}}return j}return{getIntersections:function(g){var T=this.getValues(),w=g&&g!==this&&g.getValues();return w?d(T,w,this,g,[]):p(T,this,[])},statics:{getOverlaps:P,getIntersections:y,getCurveLineIntersections:l,getTimesWithTangent:m}}}),xe=A.extend({_class:"CurveLocation",initialize:function(i,n,s,u,l){if(n>=.99999999){var c=i.getNext();c&&(n=0,i=c)}this._setCurve(i),this._time=n,this._point=s||i.getPointAtTime(n),this._overlap=u,this._distance=l,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var i=t.getCurve();i?this._setCurve(i):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var i=this.getCurve(),n=this.getTime();n===0?t=i._segment1:n===1?t=i._segment2:n!=null&&(t=i.getPartLength(0,n)<i.getPartLength(n,1)?i._segment1:i._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,i=this;t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function n(s){var u=s&&s.getCurve();if(u&&(i._time=u.getTimeOf(i._point))!=null)return i._setCurve(u),u}return this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),i=this._time;return t&&i==null?this._time=t.getTimeOf(this._point):i},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(t==null){t=0;var i=this.getPath(),n=this.getIndex();if(i&&n!=null)for(var s=i.getCurves(),u=0;u<n;u++)t+=s[u].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(t==null){var i=this.getCurve(),n=this.getTime();this._curveOffset=t=n!=null&&i&&i.getPartLength(0,n)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),i=t&&t.divideAtTime(this.getTime());return i&&this._setSegment(i._segment1),i},split:function(){var t=this.getCurve(),i=t._path,n=t&&t.splitAtTime(this.getTime());return n&&this._setSegment(i.getLastSegment()),n},equals:function(t,i){var n=this===t;if(!n&&t instanceof xe){var s=this.getCurve(),u=t.getCurve(),l=s._path,c=u._path;if(l===c){var f=Math.abs,d=1e-7,p=f(this.getOffset()-t.getOffset()),y=!i&&this._intersection,P=!i&&t._intersection;n=(p<d||l&&f(l.getLength()-p)<d)&&(!y&&!P||y&&P&&y.equals(P,!0))}}return n},toString:function(){var t=[],i=this.getPoint(),n=he.instance;i&&t.push("point: "+i);var s=this.getIndex();s!=null&&t.push("index: "+s);var u=this.getTime();return u!=null&&t.push("time: "+n.number(u)),this._distance!=null&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var i=this.getCurve(),n=t.getCurve();return!(i.isStraight()&&n.isStraight()&&i.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var i=this.getTime(),n=t.getTime(),s=1e-8,u=1-s,l=i>=s&&i<=u,c=n>=s&&n<=u;if(l&&c)return!this.isTouching();var f=this.getCurve(),d=f&&i<s?f.getPrevious():f,p=t.getCurve(),y=p&&n<s?p.getPrevious():p;if(i>u&&(f=f.getNext()),n>u&&(p=p.getNext()),!d||!f||!y||!p)return!1;var P=[];function m(M,X){var k=M.getValues(),V=ht.classify(k).roots||ht.getPeaks(k),D=V.length,z=ht.getLength(k,X&&D?V[D-1]:0,!X&&D?V[0]:1);P.push(D?z:z/32)}function g(M,X,k){return X<k?M>X&&M<k:M>X||M<k}l||(m(d,!0),m(f,!1)),c||(m(y,!0),m(p,!1));var T=this.getPoint(),w=Math.min.apply(Math,P),O=l?f.getTangentAtTime(i):f.getPointAt(w).subtract(T),C=l?O.negate():d.getPointAt(-w).subtract(T),b=c?p.getTangentAtTime(n):p.getPointAt(w).subtract(T),v=c?b.negate():y.getPointAt(-w).subtract(T),x=C.getAngle(),L=O.getAngle(),E=v.getAngle(),S=b.getAngle();return!!(l?g(x,E,S)^g(L,E,S)&&g(x,S,E)^g(L,S,E):g(E,x,L)^g(S,x,L)&&g(E,L,x)^g(S,L,x))},hasOverlap:function(){return!!this._overlap}},A.each(ht._evaluateMethods,function(t){var i=t+"At";this[t]=function(){var n=this.getCurve(),s=this.getTime();return s!=null&&n&&n[i](s,!0)}},{preserve:!0}),new function(){function t(i,n,s){var u=i.length,l=0,c=u-1;function f(T,w){for(var O=T+w;O>=-1&&O<=u;O+=w){var C=i[(O%u+u)%u];if(!n.getPoint().isClose(C.getPoint(),1e-7))break;if(n.equals(C))return C}return null}for(;l<=c;){var d=l+c>>>1,p=i[d],y;if(s&&(y=n.equals(p)?p:f(d,-1)||f(d,1)))return n._overlap&&(y._overlap=y._intersection._overlap=!0),y;var P=n.getPath(),m=p.getPath(),g=P!==m?P._id-m._id:n.getIndex()+n.getTime()-(p.getIndex()+p.getTime());g<0?c=d-1:l=d+1}return i.splice(l,0,n),n}return{statics:{insert:t,expand:function(i){for(var n=i.slice(),s=i.length-1;s>=0;s--)t(n,i[s]._intersection,!1);return n}}}}),Xe=At.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var i,n,s;if(A.isPlainObject(t)?(n=t.segments,i=t.pathData):Array.isArray(t)?n=t:typeof t=="string"&&(i=t),n){var u=n[0];s=u&&Array.isArray(u[0])}else i&&(s=(i.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(i));var l=s?be:Xt;return new l(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var i=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),n,s=!1,u,l,c=new Z,f=new Z;function d(v,x){var L=+n[v];return s&&(L+=c[x]),L}function p(v){return new Z(d(v,"x"),d(v+1,"y"))}this.clear();for(var y=0,P=i&&i.length;y<P;y++){var m=i[y],g=m[0],T=g.toLowerCase();n=m.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var w=n&&n.length;switch(s=g===T,u==="z"&&!/[mz]/.test(T)&&this.moveTo(c),T){case"m":case"l":for(var O=T==="m",C=0;C<w;C+=2)this[O?"moveTo":"lineTo"](c=p(C)),O&&(f=c,O=!1);l=c;break;case"h":case"v":var b=T==="h"?"x":"y";c=c.clone();for(var C=0;C<w;C++)c[b]=d(C,b),this.lineTo(c);l=c;break;case"c":for(var C=0;C<w;C+=6)this.cubicCurveTo(p(C),l=p(C+2),c=p(C+4));break;case"s":for(var C=0;C<w;C+=4)this.cubicCurveTo(/[cs]/.test(u)?c.multiply(2).subtract(l):c,l=p(C),c=p(C+2)),u=T;break;case"q":for(var C=0;C<w;C+=4)this.quadraticCurveTo(l=p(C),c=p(C+2));break;case"t":for(var C=0;C<w;C+=2)this.quadraticCurveTo(l=/[qt]/.test(u)?c.multiply(2).subtract(l):c,c=p(C)),u=T;break;case"a":for(var C=0;C<w;C+=7)this.arcTo(c=p(C+5),new _t(+n[C],+n[C+1]),+n[C+2],+n[C+4],+n[C+3]);break;case"z":this.closePath(1e-12),c=f;break}u=T}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var i=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return i.onPath||!!(this.getFillRule()==="evenodd"?i.windingL&1||i.windingR&1:i.winding)},getIntersections:function(t,i,n,s){var u=this===t||!t,l=this._matrix._orNullIfIdentity(),c=u?l:(n||t._matrix)._orNullIfIdentity();return u||this.getBounds(l).intersects(t.getBounds(c),1e-12)?ht.getIntersections(this.getCurves(),!u&&t.getCurves(),i,l,c,s):[]},getCrossings:function(t){return this.getIntersections(t,function(i){return i.isCrossing()})},getNearestLocation:function(){for(var t=Z.read(arguments),i=this.getCurves(),n=1/0,s=null,u=0,l=i.length;u<l;u++){var c=i[u].getNearestLocation(t);c._distance<n&&(n=c._distance,s=c)}return s},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t&&t.getPoint()},interpolate:function(t,i,n){var s=!this._children,u=s?"_segments":"_children",l=t[u],c=i[u],f=this[u];if(!l||!c||l.length!==c.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+i);var d=f.length,p=c.length;if(d<p)for(var y=s?yt:Xt,P=d;P<p;P++)this.add(new y);else d>p&&this[s?"removeSegments":"removeChildren"](p,d);for(var P=0;P<p;P++)f[P].interpolate(l[P],c[P],n);s&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var i=!1;if(t){var n=this._children||[this],s=t._children?t._children.slice():[t],u=n.length,l=s.length,c=[],f=0;i=!0;for(var d=Me.findItemBoundsCollisions(n,s,Dt.GEOMETRIC_EPSILON),p=u-1;p>=0&&i;p--){var y=n[p];i=!1;var P=d[p];if(P)for(var m=P.length-1;m>=0&&!i;m--)y.compare(s[P[m]])&&(c[P[m]]||(c[P[m]]=!0,f++),i=!0)}i=i&&f===l}return i}}),Xt=Xe.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(i){this._closed=!1,this._segments=[],this._version=0;var n=arguments,s=Array.isArray(i)?typeof i[0]=="object"?i:n:i&&i.size===B&&(i.x!==B||i.point!==B)?n:null;s&&s.length>0?this.setSegments(s):(this._curves=B,this._segmentSelection=0,!s&&typeof i=="string"&&(this.setPathData(i),i=null)),this._initialize(!s&&i)},_equals:function(t){return this._closed===t._closed&&A.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(i){if(t.base.call(this,i),i&8){if(this._length=this._area=B,i&32)this._version++;else if(this._curves)for(var n=0,s=this._curves.length;n<s;n++)this._curves[n]._changed()}else i&64&&(this._bounds=B)},getStyle:function(){var t=this._parent;return(t instanceof be?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var i=this.isFullySelected(),n=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=B,n){var s=t[n-1];typeof s=="boolean"&&(this.setClosed(s),n--),this._add(yt.readList(t,0,{},n))}i&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,i=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var s=0;s<n;s++)t[s]=new ht(this,i[s],i[s+1]||i[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var i=this._curves.length=this._countCurves();t&&(this._curves[i-1]=new ht(this,this._segments[i-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,i){var n=this._segments,s=n.length,u=new he(i),l=new Array(6),c=!0,f,d,p,y,P,m,g,T,w=[];function O(b,v){if(b._transformCoordinates(t,l),f=l[0],d=l[1],c)w.push("M"+u.pair(f,d)),c=!1;else if(P=l[2],m=l[3],P===f&&m===d&&g===p&&T===y){if(!v){var x=f-p,L=d-y;w.push(x===0?"v"+u.number(L):L===0?"h"+u.number(x):"l"+u.pair(x,L))}}else w.push("c"+u.pair(g-p,T-y)+" "+u.pair(P-p,m-y)+" "+u.pair(f-p,d-y));p=f,y=d,g=l[4],T=l[5]}if(!s)return"";for(var C=0;C<s;C++)O(n[C]);return this._closed&&s>0&&(O(n[0],!0),w.push("z")),w.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var i=this._segments,n=new Array(6),s=0,u=i.length;s<u;s++)i[s]._transformCoordinates(t,n,!0);return!0},_add:function(t,c){for(var n=this._segments,s=this._curves,u=t.length,l=c==null,c=l?n.length:c,f=0;f<u;f++){var d=t[f];d._path&&(d=t[f]=d.clone()),d._path=this,d._index=c+f,d._selection&&this._updateSelection(d,0,d._selection)}if(l)A.push(n,t);else{n.splice.apply(n,[c,0].concat(t));for(var f=c+u,p=n.length;f<p;f++)n[f]._index=f}if(s){var y=this._countCurves(),P=c>0&&c+u-1===y?c-1:c,m=P,g=Math.min(P+u,y);t._curves&&(s.splice.apply(s,[P,0].concat(t._curves)),m+=t._curves.length);for(var f=m;f<g;f++)s.splice(f,0,new ht(this,null,null));this._adjustCurves(P,g)}return this._changed(41),t},_adjustCurves:function(t,i){for(var n=this._segments,s=this._curves,u,l=t;l<i;l++)u=s[l],u._path=this,u._segment1=n[l],u._segment2=n[l+1]||n[0],u._changed();(u=s[this._closed&&!t?n.length-1:t-1])&&(u._segment2=n[t]||n[0],u._changed()),(u=s[i])&&(u._segment1=n[i],u._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var i=arguments;return i.length>1&&typeof t!="number"?this._add(yt.readList(i)):this._add([yt.read(i)])[0]},insert:function(t,i){var n=arguments;return n.length>2&&typeof i!="number"?this._add(yt.readList(n,1),t):this._add([yt.read(n,1)],t)[0]},addSegment:function(){return this._add([yt.read(arguments)])[0]},insertSegment:function(t){return this._add([yt.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(yt.readList(t))},insertSegments:function(t,i){return this._add(yt.readList(i),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,i,n){t=t||0,i=A.pick(i,this._segments.length);var s=this._segments,u=this._curves,l=s.length,c=s.splice(t,i-t),f=c.length;if(!f)return c;for(var d=0;d<f;d++){var p=c[d];p._selection&&this._updateSelection(p,p._selection,0),p._index=p._path=null}for(var d=t,y=s.length;d<y;d++)s[d]._index=d;if(u){for(var P=t>0&&i===l+(this._closed?1:0)?t-1:t,u=u.splice(P,f),d=u.length-1;d>=0;d--)u[d]._path=null;n&&(c._curves=u.slice(1)),this._adjustCurves(P,P)}return this._changed(41),c},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,i=0,n=t.length;i<n;i++)if(t[i].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,i=0,n=t.length;i<n;i++)t[i].clearHandles()},getLength:function(){if(this._length==null){for(var t=this.getCurves(),i=0,n=0,s=t.length;n<s;n++)i+=t[n].getLength();this._length=i}return this._length},getArea:function(){var t=this._area;if(t==null){var i=this._segments,n=this._closed;t=0;for(var s=0,u=i.length;s<u;s++){var l=s+1===u;t+=ht.getArea(ht.getValues(i[s],i[l?0:s+1],null,l&&!n))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===t*7},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(i){i&1||this._selectSegments(!1),t.base.call(this,i)},_selectSegments:function(t){var i=this._segments,n=i.length,s=t?7:0;this._segmentSelection=s*n;for(var u=0;u<n;u++)i[u]._selection=s},_updateSelection:function(t,i,n){t._selection=n;var s=this._segmentSelection+=n-i;s>0&&this.setSelected(!0)},divideAt:function(t){var i=this.getLocationAt(t),n;return i&&(n=i.getCurve().divideAt(i.getCurveOffset()))?n._segment1:null},splitAt:function(t){var i=this.getLocationAt(t),n=i&&i.index,s=i&&i.time,u=1e-8,l=1-u;s>l&&(n++,s=0);var c=this.getCurves();if(n>=0&&n<c.length){s>=u&&c[n++].divideAtTime(s);var f=this.removeSegments(n,this._segments.length,!0),d;return this._closed?(this.setClosed(!1),d=this):(d=new Xt(At.NO_INSERT),d.insertAbove(this),d.copyAttributes(this)),d._add(f,0),this.addSegment(f[0]),d}return null},split:function(t,i){var n,s=i===B?t:(n=this.getCurves()[t])&&n.getLocationAtTime(i);return s!=null?this.splitAt(s):null},join:function(t,i){var n=i||0;if(t&&t!==this){var s=t._segments,u=this.getLastSegment(),l=t.getLastSegment();if(!l)return this;u&&u._point.isClose(l._point,n)&&t.reverse();var c=t.getFirstSegment();if(u&&u._point.isClose(c._point,n))u.setHandleOut(c._handleOut),this._add(s.slice(1));else{var f=this.getFirstSegment();f&&f._point.isClose(c._point,n)&&t.reverse(),l=t.getLastSegment(),f&&f._point.isClose(l._point,n)?(f.setHandleIn(l._handleIn),this._add(s.slice(0,s.length-1),0)):this._add(s.slice())}t._closed&&this._add([s[0]]),t.remove()}var d=this.getFirstSegment(),p=this.getLastSegment();return d!==p&&d._point.isClose(p._point,n)&&(d.setHandleIn(p._handleIn),p.remove(),this.setClosed(!0)),this},reduce:function(t){for(var i=this.getCurves(),n=t&&t.simplify,s=n?1e-7:0,u=i.length-1;u>=0;u--){var l=i[u];!l.hasHandles()&&(!l.hasLength(s)||n&&l.isCollinear(l.getNext()))&&l.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,i=this._segments.length;t<i;t++){var n=this._segments[t],s=n._handleIn;n._handleIn=n._handleOut,n._handleOut=s,n._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var i=new li(this,t||.25,256,!0),n=i.parts,s=n.length,u=[],l=0;l<s;l++)u.push(new yt(n[l].curve.slice(0,2)));!this._closed&&s>0&&u.push(new yt(n[s-1].curve.slice(6))),this.setSegments(u)},simplify:function(t){var i=new wi(this).fit(t||2.5);return i&&this.setSegments(i),!!i},smooth:function(t){var i=this,n=t||{},s=n.type||"asymmetric",u=this._segments,l=u.length,c=this._closed;function f(ct,Pt){var gt=ct&&ct.index;if(gt!=null){var It=ct.path;if(It&&It!==i)throw new Error(ct._class+" "+gt+" of "+It+" is not part of "+i);Pt&&ct instanceof ht&&gt++}else gt=typeof ct=="number"?ct:Pt;return Math.min(gt<0&&c?gt%l:gt<0?gt+l:gt,l-1)}var d=c&&n.from===B&&n.to===B,p=f(n.from,0),y=f(n.to,l-1);if(p>y)if(c)p-=l;else{var P=p;p=y,y=P}if(/^(?:asymmetric|continuous)$/.test(s)){var m=s==="asymmetric",g=Math.min,T=y-p+1,w=T-1,O=d?g(T,4):1,C=O,b=O,v=[];if(c||(C=g(1,p),b=g(1,l-y-1)),w+=C+b,w<=1)return;for(var x=0,L=p-C;x<=w;x++,L++)v[x]=u[(L<0?L+l:L)%l]._point;for(var E=v[0]._x+2*v[1]._x,S=v[0]._y+2*v[1]._y,M=2,X=w-1,k=[E],V=[S],D=[M],z=[],q=[],x=1;x<w;x++){var H=x<X,U=H||m?1:2,j=H?4:m?2:7,rt=H?4:m?3:8,at=H?2:m?0:1,ut=U/M;M=D[x]=j-ut,E=k[x]=rt*v[x]._x+at*v[x+1]._x-ut*E,S=V[x]=rt*v[x]._y+at*v[x+1]._y-ut*S}z[X]=k[X]/D[X],q[X]=V[X]/D[X];for(var x=w-2;x>=0;x--)z[x]=(k[x]-z[x+1])/D[x],q[x]=(V[x]-q[x+1])/D[x];z[w]=(3*v[w]._x-z[X])/2,q[w]=(3*v[w]._y-q[X])/2;for(var x=C,ft=w-b,L=p;x<=ft;x++,L++){var tt=u[L<0?L+l:L],it=tt._point,lt=z[x]-it._x,dt=q[x]-it._y;(d||x<ft)&&tt.setHandleOut(lt,dt),(d||x>C)&&tt.setHandleIn(-lt,-dt)}}else for(var x=p;x<=y;x++)u[x<0?x+l:x].smooth(n,!d&&x===p,!d&&x===y)},toShape:function(t){if(!this._closed)return null;var i=this._segments,n,s,u,l;function c(m,g){var T=i[m],w=T.getNext(),O=i[g],C=O.getNext();return T._handleOut.isZero()&&w._handleIn.isZero()&&O._handleOut.isZero()&&C._handleIn.isZero()&&w._point.subtract(T._point).isCollinear(C._point.subtract(O._point))}function f(m){var g=i[m],T=g.getPrevious(),w=g.getNext();return T._handleOut.isZero()&&g._handleIn.isZero()&&g._handleOut.isZero()&&w._handleIn.isZero()&&g._point.subtract(T._point).isOrthogonal(w._point.subtract(g._point))}function d(m){var g=i[m],T=g.getNext(),w=g._handleOut,O=T._handleIn,C=.5522847498307936;if(w.isOrthogonal(O)){var b=g._point,v=T._point,x=new se(b,w,!0).intersect(new se(v,O,!0),!0);return x&&Dt.isZero(w.getLength()/x.subtract(b).getLength()-C)&&Dt.isZero(O.getLength()/x.subtract(v).getLength()-C)}return!1}function p(m,g){return i[m]._point.getDistance(i[g]._point)}if(!this.hasHandles()&&i.length===4&&c(0,2)&&c(1,3)&&f(1)?(n=de.Rectangle,s=new _t(p(0,3),p(0,1)),l=i[1]._point.add(i[2]._point).divide(2)):i.length===8&&d(0)&&d(2)&&d(4)&&d(6)&&c(1,5)&&c(3,7)?(n=de.Rectangle,s=new _t(p(1,6),p(0,3)),u=s.subtract(new _t(p(0,7),p(1,2))).divide(2),l=i[3]._point.add(i[4]._point).divide(2)):i.length===4&&d(0)&&d(1)&&d(2)&&d(3)&&(Dt.isZero(p(0,2)-p(1,3))?(n=de.Circle,u=p(0,2)/2):(n=de.Ellipse,u=new _t(p(2,0)/2,p(3,1)/2)),l=i[1]._point),n){var y=this.getPosition(!0),P=new n({center:y,size:s,radius:u,insert:!1});return P.copyAttributes(this,!0),P._matrix.prepend(this._matrix),P.rotate(l.subtract(y).getAngle()+90),(t===B||t)&&P.insertAbove(this),P}return null},toPath:"#clone",compare:function t(i){if(!i||i instanceof be)return t.base.call(this,i);var n=this.getCurves(),s=i.getCurves(),u=n.length,l=s.length;if(!u||!l)return u==l;for(var c=n[0].getValues(),f=[],d=0,p,y=0,P,m=0;m<l;m++){var O=s[m].getValues();f.push(O);var g=ht.getOverlaps(c,O);if(g){p=!m&&g[0][0]>0?l-1:m,P=g[0][1];break}}for(var T=Math.abs,w=1e-8,O=f[p],C;c&&O;){var g=ht.getOverlaps(c,O);if(g){var b=g[0][0];if(T(b-y)<w){y=g[1][0],y===1&&(c=++d<u?n[d].getValues():null,y=0);var v=g[0][1];if(T(v-P)<w){if(C||(C=[p,v]),P=g[1][1],P===1&&(++p>=l&&(p=0),O=f[p]||s[p].getValues(),P=0),!c)return C[0]===p&&C[1]===P;continue}}}break}return!1},_hitTestSelf:function(t,i,n,s){var u=this,l=this.getStyle(),c=this._segments,f=c.length,d=this._closed,p=i._tolerancePadding,y=p,P,m,g,T,w,O,C=i.stroke&&l.hasStroke(),b=i.fill&&l.hasFill(),v=i.curves,x=C?l.getStrokeWidth()/2:b&&i.tolerance>0||v?0:null;x!==null&&(x>0?(P=l.getStrokeJoin(),m=l.getStrokeCap(),g=l.getMiterLimit(),y=y.add(Xt._getStrokePadding(x,s))):P=m="round");function L(z,q){return t.subtract(z).divide(q).length<=1}function E(z,q,H){if(!i.selected||q.isSelected()){var U=z._point;if(q!==U&&(q=q.add(U)),L(q,y))return new Te(H,u,{segment:z,point:q})}}function S(z,q){return(q||i.segments)&&E(z,z._point,"segment")||!q&&i.handles&&(E(z,z._handleIn,"handle-in")||E(z,z._handleOut,"handle-out"))}function M(z){T.add(z)}function X(z){var q=d||z._index>0&&z._index<f-1;if((q?P:m)==="round")return L(z._point,y);if(T=new Xt({internal:!0,closed:!0}),q?z.isSmooth()||Xt._addBevelJoin(z,P,x,g,null,s,M,!0):m==="square"&&Xt._addSquareCap(z,m,x,null,s,M,!0),!T.isEmpty()){var H;return T.contains(t)||(H=T.getNearestLocation(t))&&L(H.getPoint(),p)}}if(i.ends&&!i.segments&&!d){if(O=S(c[0],!0)||S(c[f-1],!0))return O}else if(i.segments||i.handles){for(var k=0;k<f;k++)if(O=S(c[k]))return O}if(x!==null){if(w=this.getNearestLocation(t),w){var V=w.getTime();V===0||V===1&&f>1?X(w.getSegment())||(w=null):L(w.getPoint(),y)||(w=null)}if(!w&&P==="miter"&&f>1)for(var k=0;k<f;k++){var D=c[k];if(t.getDistance(D._point)<=g*x&&X(D)){w=D.getLocation();break}}}return!w&&b&&this._contains(t)||w&&!C&&!v?new Te("fill",this):w?new Te(C?"stroke":"curve",this,{location:w,point:w.getPoint()}):null}},A.each(ht._evaluateMethods,function(t){this[t+"At"]=function(i){var n=this.getLocationAt(i);return n&&n[t]()}},{beans:!1,getLocationOf:function(){for(var t=Z.read(arguments),i=this.getCurves(),n=0,s=i.length;n<s;n++){var u=i[n].getLocationOf(t);if(u)return u}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if(typeof t=="number"){for(var i=this.getCurves(),n=0,s=0,u=i.length;s<u;s++){var l=n,c=i[s];if(n+=c.getLength(),n>t)return c.getLocationAt(t-l)}if(i.length>0&&t<=this.getLength())return new xe(i[i.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=Z.read(arguments);if(t.isZero())return[];for(var i=[],n=0,s=this.getCurves(),u=0,l=s.length;u<l;u++){for(var c=s[u],f=c.getTimesWithTangent(t),d=0,p=f.length;d<p;d++){var y=n+c.getOffsetAtTime(f[d]);i.indexOf(y)<0&&i.push(y)}n+=c.length}return i}}),new function(){function t(n,s,u,l){if(l<=0)return;var c=l/2,f=l-2,d=c-1,p=new Array(6),y,P;function m(b){var v=p[b],x=p[b+1];(y!=v||P!=x)&&(n.beginPath(),n.moveTo(y,P),n.lineTo(v,x),n.stroke(),n.beginPath(),n.arc(v,x,c,0,Math.PI*2,!0),n.fill())}for(var g=0,T=s.length;g<T;g++){var w=s[g],O=w._selection;if(w._transformCoordinates(u,p),y=p[0],P=p[1],O&2&&m(2),O&4&&m(4),n.fillRect(y-c,P-c,l,l),f>0&&!(O&1)){var C=n.fillStyle;n.fillStyle="#ffffff",n.fillRect(y-d,P-d,f,f),n.fillStyle=C}}}function i(n,s,u){var l=s._segments,c=l.length,f=new Array(6),d=!0,p,y,P,m,g,T,w,O;function C(v){if(u)v._transformCoordinates(u,f),p=f[0],y=f[1];else{var x=v._point;p=x._x,y=x._y}if(d)n.moveTo(p,y),d=!1;else{if(u)g=f[2],T=f[3];else{var L=v._handleIn;g=p+L._x,T=y+L._y}g===p&&T===y&&w===P&&O===m?n.lineTo(p,y):n.bezierCurveTo(w,O,g,T,p,y)}if(P=p,m=y,u)w=f[4],O=f[5];else{var L=v._handleOut;w=P+L._x,O=m+L._y}}for(var b=0;b<c;b++)C(l[b]);s._closed&&c>0&&C(l[0])}return{_draw:function(n,s,u,l){var c=s.dontStart,f=s.dontFinish||s.clip,d=this.getStyle(),p=d.hasFill(),y=d.hasStroke(),P=d.getDashArray(),m=!Mt.support.nativeDash&&y&&P&&P.length;c||n.beginPath(),(p||y&&!m||f)&&(i(n,this,l),this._closed&&n.closePath());function g(v){return P[(v%m+m)%m]}if(!f&&(p||y)&&(this._setStyles(n,s,u),p&&(n.fill(d.getFillRule()),n.shadowColor="rgba(0,0,0,0)"),y)){if(m){c||n.beginPath();for(var T=new li(this,.25,32,!1,l),w=T.length,O=-d.getDashOffset(),C,b=0;O>0;)O-=g(b--)+g(b--);for(;O<w;)C=O+g(b++),(O>0||C>0)&&T.drawPart(n,Math.max(O,0),Math.max(C,0)),O=C+g(b++)}n.stroke()}},_drawSelected:function(n,s){n.beginPath(),i(n,this,s),n.stroke(),t(n,this._segments,s,Mt.settings.handleSize)}}},new function(){function t(i){var n=i._segments;if(!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return{moveTo:function(){var i=this._segments;i.length===1&&this.removeSegment(0),i.length||this._add([new yt(Z.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new yt(Z.read(arguments))])},cubicCurveTo:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=Z.read(i),l=t(this);l.setHandleOut(n.subtract(l._point)),this._add([new yt(u,s.subtract(u))])},quadraticCurveTo:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=t(this)._point;this.cubicCurveTo(n.add(u.subtract(n).multiply(1/3)),n.add(s.subtract(n).multiply(1/3)),s)},curveTo:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=A.pick(A.read(i),.5),l=1-u,c=t(this)._point,f=n.subtract(c.multiply(l*l)).subtract(s.multiply(u*u)).divide(2*u*l);if(f.isNaN())throw new Error("Cannot put a curve through points with parameter = "+u);this.quadraticCurveTo(f,s)},arcTo:function(){var i=arguments,n=Math.abs,s=Math.sqrt,u=t(this),l=u._point,c=Z.read(i),f,d=A.peek(i),p=A.pick(d,!0),y,P,m,g;if(typeof p=="boolean")var T=l.add(c).divide(2),f=T.add(T.subtract(l).rotate(p?-90:90));else if(A.remain(i)<=2)f=c,c=Z.read(i);else if(!l.equals(c)){var w=_t.read(i),O=Dt.isZero;if(O(w.width)||O(w.height))return this.lineTo(c);var C=A.read(i),p=!!A.read(i),b=!!A.read(i),T=l.add(c).divide(2),v=l.subtract(T).rotate(-C),x=v.x,L=v.y,E=n(w.width),S=n(w.height),M=E*E,X=S*S,k=x*x,V=L*L,D=s(k/M+V/X);if(D>1&&(E*=D,S*=D,M=E*E,X=S*S),D=(M*X-M*V-X*k)/(M*V+X*k),n(D)<1e-12&&(D=0),D<0)throw new Error("Cannot create an arc with the given arguments");y=new Z(E*L/S,-S*x/E).multiply((b===p?-1:1)*s(D)).rotate(C).add(T),g=new Vt().translate(y).rotate(C).scale(E,S),m=g._inverseTransform(l),P=m.getDirectedAngle(g._inverseTransform(c)),!p&&P>0?P-=360:p&&P<0&&(P+=360)}if(f){var z=new se(l.add(f).divide(2),f.subtract(l).rotate(90),!0),q=new se(f.add(c).divide(2),c.subtract(f).rotate(90),!0),H=new se(l,c),U=H.getSide(f);if(y=z.intersect(q,!0),!y){if(!U)return this.lineTo(c);throw new Error("Cannot create an arc with the given arguments")}m=l.subtract(y),P=m.getDirectedAngle(c.subtract(y));var j=H.getSide(y,!0);j===0?P=U*n(P):U===j&&(P+=P<0?360:-360)}if(P){for(var rt=1e-5,at=n(P),ut=at>=360?4:Math.ceil((at-rt)/90),ft=P/ut,tt=ft*Math.PI/360,it=4/3*Math.sin(tt)/(1+Math.cos(tt)),lt=[],dt=0;dt<=ut;dt++){var v=c,ct=null;if(dt<ut&&(ct=m.rotate(90).multiply(it),g?(v=g._transformPoint(m),ct=g._transformPoint(m.add(ct)).subtract(v)):v=y.add(m)),!dt)u.setHandleOut(ct);else{var Pt=m.rotate(-90).multiply(it);g&&(Pt=g._transformPoint(m.add(Pt)).subtract(v)),lt.push(new yt(v,Pt,ct))}m=m.rotate(ft)}this._add(lt)}},lineBy:function(){var i=Z.read(arguments),n=t(this)._point;this.lineTo(n.add(i))},curveBy:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=A.read(i),l=t(this)._point;this.curveTo(l.add(n),l.add(s),u)},cubicCurveBy:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=Z.read(i),l=t(this)._point;this.cubicCurveTo(l.add(n),l.add(s),l.add(u))},quadraticCurveBy:function(){var i=arguments,n=Z.read(i),s=Z.read(i),u=t(this)._point;this.quadraticCurveTo(u.add(n),u.add(s))},arcBy:function(){var i=arguments,n=t(this)._point,s=n.add(Z.read(i)),u=A.pick(A.peek(i),!0);typeof u=="boolean"?this.arcTo(s,u):this.arcTo(s,n.add(Z.read(i)))},closePath:function(i){this.setClosed(!0),this.join(this,i)}}},{_getBounds:function(t,i){var n=i.handle?"getHandleBounds":i.stroke?"getStrokeBounds":"getBounds";return Xt[n](this._segments,this._closed,this,t,i)},statics:{getBounds:function(t,i,n,s,u,l){var c=t[0];if(!c)return new Ct;var f=new Array(6),d=c._transformCoordinates(s,new Array(6)),p=d.slice(0,2),y=p.slice(),P=new Array(2);function m(w){w._transformCoordinates(s,f);for(var O=0;O<2;O++)ht._addBounds(d[O],d[O+4],f[O+2],f[O],O,l?l[O]:0,p,y,P);var C=d;d=f,f=C}for(var g=1,T=t.length;g<T;g++)m(t[g]);return i&&m(c),new Ct(p[0],p[1],y[0]-p[0],y[1]-p[1])},getStrokeBounds:function(t,i,n,s,u){var l=n.getStyle(),c=l.hasStroke(),f=l.getStrokeWidth(),d=c&&n._getStrokeMatrix(s,u),p=c&&Xt._getStrokePadding(f,d),y=Xt.getBounds(t,i,n,s,u,p);if(!c)return y;var P=f/2,m=l.getStrokeJoin(),g=l.getStrokeCap(),T=l.getMiterLimit(),w=new Ct(new _t(p));function O(E){y=y.include(E)}function C(E){y=y.unite(w.setCenter(E._point.transform(s)))}function b(E,S){S==="round"||E.isSmooth()?C(E):Xt._addBevelJoin(E,S,P,T,s,d,O)}function v(E,S){S==="round"?C(E):Xt._addSquareCap(E,S,P,s,d,O)}var x=t.length-(i?0:1);if(x>0){for(var L=1;L<x;L++)b(t[L],m);i?b(t[0],m):(v(t[0],g),v(t[t.length-1],g))}return y},_getStrokePadding:function(t,i){if(!i)return[t,t];var n=new Z(t,0).transform(i),s=new Z(0,t).transform(i),u=n.getAngleInRadians(),l=n.getLength(),c=s.getLength(),f=Math.sin(u),d=Math.cos(u),p=Math.tan(u),y=Math.atan2(c*p,l),P=Math.atan2(c,p*l);return[Math.abs(l*Math.cos(y)*d+c*Math.sin(y)*f),Math.abs(c*Math.sin(P)*d+l*Math.cos(P)*f)]},_addBevelJoin:function(t,i,n,s,u,l,c,f){var d=t.getCurve(),p=d.getPrevious(),y=d.getPoint1().transform(u),P=p.getNormalAtTime(1).multiply(n).transform(l),m=d.getNormalAtTime(0).multiply(n).transform(l),g=P.getDirectedAngle(m);if((g<0||g>=180)&&(P=P.negate(),m=m.negate()),f&&c(y),c(y.add(P)),i==="miter"){var T=new se(y.add(P),new Z(-P.y,P.x),!0).intersect(new se(y.add(m),new Z(-m.y,m.x),!0),!0);T&&y.getDistance(T)<=s*n&&c(T)}c(y.add(m))},_addSquareCap:function(t,i,n,s,u,l,c){var f=t._point.transform(s),d=t.getLocation(),p=d.getNormal().multiply(d.getTime()===0?n:-n).transform(u);i==="square"&&(c&&(l(f.subtract(p)),l(f.add(p))),f=f.add(p.rotate(-90))),l(f.add(p)),l(f.subtract(p))},getHandleBounds:function(t,i,n,s,u){var l=n.getStyle(),c=u.stroke&&l.hasStroke(),f,d;if(c){var p=n._getStrokeMatrix(s,u),y=l.getStrokeWidth()/2,P=y;l.getStrokeJoin()==="miter"&&(P=y*l.getMiterLimit()),l.getStrokeCap()==="square"&&(P=Math.max(P,y*Math.SQRT2)),f=Xt._getStrokePadding(y,p),d=Xt._getStrokePadding(P,p)}for(var m=new Array(6),g=1/0,T=-g,w=g,O=T,C=0,b=t.length;C<b;C++){var v=t[C];v._transformCoordinates(s,m);for(var x=0;x<6;x+=2){var L=x?f:d,E=L?L[0]:0,S=L?L[1]:0,M=m[x],X=m[x+1],k=M-E,V=M+E,D=X-S,z=X+S;k<g&&(g=k),V>T&&(T=V),D<w&&(w=D),z>O&&(O=z)}}return new Ct(g,w,T-g,O-w)}}});Xt.inject({statics:new function(){var t=.5522847498307936,i=[new yt([-1,0],[0,t],[0,-t]),new yt([0,-1],[-t,0],[t,0]),new yt([1,0],[0,-t],[0,t]),new yt([0,1],[t,0],[-t,0])];function n(u,l,c){var f=A.getNamed(c),d=new Xt(f&&(f.insert==!0?At.INSERT:f.insert==!1?At.NO_INSERT:null));return d._add(u),d._closed=l,d.set(f,At.INSERT)}function s(u,l,c){for(var f=new Array(4),d=0;d<4;d++){var p=i[d];f[d]=new yt(p._point.multiply(l).add(u),p._handleIn.multiply(l),p._handleOut.multiply(l))}return n(f,!0,c)}return{Line:function(){var u=arguments;return n([new yt(Z.readNamed(u,"from")),new yt(Z.readNamed(u,"to"))],!1,u)},Circle:function(){var u=arguments,l=Z.readNamed(u,"center"),c=A.readNamed(u,"radius");return s(l,new _t(c),u)},Rectangle:function(){var u=arguments,l=Ct.readNamed(u,"rectangle"),c=_t.readNamed(u,"radius",0,{readNull:!0}),f=l.getBottomLeft(!0),d=l.getTopLeft(!0),p=l.getTopRight(!0),y=l.getBottomRight(!0),P;if(!c||c.isZero())P=[new yt(f),new yt(d),new yt(p),new yt(y)];else{c=_t.min(c,l.getSize(!0).divide(2));var m=c.width,g=c.height,T=m*t,w=g*t;P=[new yt(f.add(m,0),null,[-T,0]),new yt(f.subtract(0,g),[0,w]),new yt(d.add(0,g),null,[0,-w]),new yt(d.add(m,0),[-T,0],null),new yt(p.subtract(m,0),null,[T,0]),new yt(p.add(0,g),[0,-w],null),new yt(y.subtract(0,g),null,[0,w]),new yt(y.subtract(m,0),[T,0])]}return n(P,!0,u)},RoundRectangle:"#Rectangle",Ellipse:function(){var u=arguments,l=de._readEllipse(u);return s(l.center,l.radius,u)},Oval:"#Ellipse",Arc:function(){var u=arguments,l=Z.readNamed(u,"from"),c=Z.readNamed(u,"through"),f=Z.readNamed(u,"to"),d=A.getNamed(u),p=new Xt(d&&d.insert==!1&&At.NO_INSERT);return p.moveTo(l),p.arcTo(c,f),p.set(d)},RegularPolygon:function(){for(var u=arguments,l=Z.readNamed(u,"center"),c=A.readNamed(u,"sides"),f=A.readNamed(u,"radius"),d=360/c,p=c%3===0,y=new Z(0,p?-f:f),P=p?-1:.5,m=new Array(c),g=0;g<c;g++)m[g]=new yt(l.add(y.rotate((g+P)*d)));return n(m,!0,u)},Star:function(){for(var u=arguments,l=Z.readNamed(u,"center"),c=A.readNamed(u,"points")*2,f=A.readNamed(u,"radius1"),d=A.readNamed(u,"radius2"),p=360/c,y=new Z(0,-1),P=new Array(c),m=0;m<c;m++)P[m]=new yt(l.add(y.rotate(p*m).multiply(m%2?d:f)));return n(P,!0,u)}}}});var be=Xe.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(i){this._children=[],this._namedChildren={},this._initialize(i)||(typeof i=="string"?this.setPathData(i):this.addChildren(Array.isArray(i)?i:arguments))},insertChildren:function t(i,n){var s=n,u=s[0];u&&typeof u[0]=="number"&&(s=[s]);for(var l=n.length-1;l>=0;l--){var c=s[l];s===n&&!(c instanceof Xt)&&(s=A.slice(s)),Array.isArray(c)?s[l]=new Xt({segments:c,insert:!1}):c instanceof be&&(s.splice.apply(s,[l,1].concat(c.removeChildren())),c.remove())}return t.base.call(this,i,s)},reduce:function t(i){for(var n=this._children,s=n.length-1;s>=0;s--){var u=n[s].reduce(i);u.isEmpty()&&u.remove()}if(!n.length){var u=new Xt(At.NO_INSERT);return u.copyAttributes(this),u.insertAbove(this),this.remove(),u}return t.base.call(this)},isClosed:function(){for(var t=this._children,i=0,n=t.length;i<n;i++)if(!t[i]._closed)return!1;return!0},setClosed:function(t){for(var i=this._children,n=0,s=i.length;n<s;n++)i[n].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,i=[],n=0,s=t.length;n<s;n++)A.push(i,t[n].getCurves());return i},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,i=0,n=0,s=t.length;n<s;n++)i+=t[n].getArea();return i},getLength:function(){for(var t=this._children,i=0,n=0,s=t.length;n<s;n++)i+=t[n].getLength();return i},getPathData:function(t,i){for(var n=this._children,s=[],u=0,l=n.length;u<l;u++){var c=n[u],f=c._matrix;s.push(c.getPathData(t&&!f.isIdentity()?t.appended(f):t,i))}return s.join("")},_hitTestChildren:function t(i,n,s){return t.base.call(this,i,n.class===Xt||n.type==="path"?n:A.set({},n,{fill:!1}),s)},_draw:function(t,i,n,s){var u=this._children;if(u.length){i=i.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var l=0,c=u.length;l<c;l++)u[l].draw(t,i,s);if(!i.clip){this._setStyles(t,i,n);var f=this._style;f.hasFill()&&(t.fill(f.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),f.hasStroke()&&t.stroke()}}},_drawSelected:function(t,i,n){for(var s=this._children,u=0,l=s.length;u<l;u++){var c=s[u],f=c._matrix;n[c._id]||c._drawSelected(t,f.isIdentity()?i:i.appended(f))}}},new function(){function t(i,n){var s=i._children;if(n&&!s.length)throw new Error("Use a moveTo() command first");return s[s.length-1]}return A.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(i){this[i]=function(){var n=t(this,!0);n[i].apply(n,arguments)}},{moveTo:function(){var i=t(this),n=i&&i.isEmpty()?i:new Xt(At.NO_INSERT);n!==i&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var i=t(this,!0),n=i&&i.getLastSegment(),s=Z.read(arguments);this.moveTo(n?s.add(n._point):s)},closePath:function(i){t(this,!0).closePath(i)}})},A.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(i){for(var n=this._children,s,u=0,l=n.length;u<l;u++)s=n[u][t](i)||s;return s}},{}));Xe.inject(new function(){var t=Math.min,i=Math.max,n=Math.abs,s={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function u(C){return C._children||[C]}function l(C,b){var v=C.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(b){for(var x=u(v),L=0,E=x.length;L<E;L++){var C=x[L];!C._closed&&!C.isEmpty()&&(C.closePath(1e-12),C.getFirstSegment().setHandleIn(0,0),C.getLastSegment().setHandleOut(0,0))}v=v.resolveCrossings().reorient(v.getFillRule()==="nonzero",!0)}return v}function c(C,b,v,x,L){var E=new be(At.NO_INSERT);return E.addChildren(C,!0),E=E.reduce({simplify:b}),L&&L.insert==!1||E.insertAbove(x&&v.isSibling(x)&&v.getIndex()<x.getIndex()?x:v),E.copyAttributes(v,!0),E}function f(C){return C.hasOverlap()||C.isCrossing()}function d(C,b,v,x){if(x&&(x.trace==!1||x.stroke)&&/^(subtract|intersect)$/.test(v))return p(C,b,v);var L=l(C,!0),E=b&&C!==b&&l(b,!0),S=s[v];S[v]=!0,E&&(S.subtract||S.exclude)^(E.isClockwise()^L.isClockwise())&&E.reverse();var M=g(xe.expand(L.getIntersections(E,f))),X=u(L),k=E&&u(E),V=[],D=[],z;function q(ct){for(var Pt=0,gt=ct.length;Pt<gt;Pt++){var It=ct[Pt];A.push(V,It._segments),A.push(D,It.getCurves()),It._overlapsOnly=!0}}function H(ct){for(var Pt=[],gt=0,It=ct&&ct.length;gt<It;gt++)Pt.push(D[ct[gt]]);return Pt}if(M.length){q(X),k&&q(k);for(var U=new Array(D.length),j=0,rt=D.length;j<rt;j++)U[j]=D[j].getValues();for(var at=Me.findCurveBoundsCollisions(U,U,0,!0),ut={},j=0;j<D.length;j++){var ft=D[j],tt=ft._path._id,it=ut[tt]=ut[tt]||{};it[ft.getIndex()]={hor:H(at[j].hor),ver:H(at[j].ver)}}for(var j=0,rt=M.length;j<rt;j++)w(M[j]._segment,L,E,ut,S);for(var j=0,rt=V.length;j<rt;j++){var lt=V[j],dt=lt._intersection;lt._winding||w(lt,L,E,ut,S),dt&&dt._overlap||(lt._path._overlapsOnly=!1)}z=O(V,S)}else z=m(k?X.concat(k):X.slice(),function(ct){return!!S[ct]});return c(z,!0,C,b,x)}function p(C,b,v){var x=l(C),L=l(b),E=x.getIntersections(L,f),S=v==="subtract",M=v==="divide",X={},k=[];function V(q){if(!X[q._id]&&(M||L.contains(q.getPointAt(q.getLength()/2))^S))return k.unshift(q),X[q._id]=!0}for(var D=E.length-1;D>=0;D--){var z=E[D].split();z&&(V(z)&&z.getFirstSegment().setHandleIn(0,0),x.getLastSegment().setHandleOut(0,0))}return V(x),c(k,!1,C,b)}function y(C,b){for(var v=C;v;){if(v===b)return;v=v._previous}for(;C._next&&C._next!==b;)C=C._next;if(!C._next){for(;b._previous;)b=b._previous;C._next=b,b._previous=C}}function P(C){for(var b=C.length-1;b>=0;b--)C[b].clearHandles()}function m(C,b,v){var x=C&&C.length;if(x){var L=A.each(C,function(at,ut){this[at._id]={container:null,winding:at.isClockwise()?1:-1,index:ut}},{}),E=C.slice().sort(function(at,ut){return n(ut.getArea())-n(at.getArea())}),S=E[0],M=Me.findItemBoundsCollisions(E,null,Dt.GEOMETRIC_EPSILON);v==null&&(v=S.isClockwise());for(var X=0;X<x;X++){var k=E[X],V=L[k._id],D=0,z=M[X];if(z){for(var q=null,H=z.length-1;H>=0;H--)if(z[H]<X){q=q||k.getInteriorPoint();var U=E[z[H]];if(U.contains(q)){var j=L[U._id];D=j.winding,V.winding+=D,V.container=j.exclude?j.container:U;break}}}if(b(V.winding)===b(D))V.exclude=!0,C[V.index]=null;else{var rt=V.container;k.setClockwise(rt?!rt.isClockwise():v)}}}return C}function g(C,b,v){var x=b&&[],L=1e-8,E=1-L,S=!1,M=v||[],X=v&&{},k,V,D;function z(Pt){return Pt._path._id+"."+Pt._segment1._index}for(var q=(v&&v.length)-1;q>=0;q--){var H=v[q];H._path&&(X[z(H)]=!0)}for(var q=C.length-1;q>=0;q--){var U=C[q],j=U._time,rt=j,at=b&&!b(U),H=U._curve,ut;if(H&&(H!==V?(S=!H.hasHandles()||X&&X[z(H)],k=[],D=null,V=H):D>=L&&(j/=D)),at){k&&k.push(U);continue}else b&&x.unshift(U);if(D=rt,j<L)ut=H._segment1;else if(j>E)ut=H._segment2;else{var ft=H.divideAtTime(j,!0);S&&M.push(H,ft),ut=ft._segment1;for(var tt=k.length-1;tt>=0;tt--){var it=k[tt];it._time=(it._time-j)/(1-j)}}U._setSegment(ut);var lt=ut._intersection,dt=U._intersection;if(lt){y(lt,dt);for(var ct=lt;ct;)y(ct._intersection,lt),ct=ct._next}else ut._intersection=dt}return v||P(M),x||C}function T(C,b,v,x,L){var E=Array.isArray(b)?b:b[v?"hor":"ver"],S=v?1:0,M=S^1,X=[C.x,C.y],k=X[S],V=X[M],D=1e-9,z=1e-6,q=k-D,H=k+D,U=0,j=0,rt=0,at=0,ut=!1,ft=!1,tt=1,it=[],lt,dt;function ct(Ft){var Jt=Ft[M+0],zt=Ft[M+6];if(!(V<t(Jt,zt)||V>i(Jt,zt))){var ee=Ft[S+0],_e=Ft[S+2],Ee=Ft[S+4],wt=Ft[S+6];if(Jt===zt){(ee<H&&wt>q||wt<H&&ee>q)&&(ut=!0);return}var ve=V===Jt?0:V===zt||q>i(ee,_e,Ee,wt)||H<t(ee,_e,Ee,wt)?1:ht.solveCubic(Ft,M,V,it,0,1)>0?it[0]:1,fe=ve===0?ee:ve===1?wt:ht.getPoint(Ft,ve)[v?"y":"x"],pe=Jt>zt?1:-1,Ae=lt[M]>lt[M+6]?1:-1,Ce=lt[S+6];return V!==Jt?(fe<q?rt+=pe:fe>H?at+=pe:ut=!0,fe>k-z&&fe<k+z&&(tt/=2)):(pe!==Ae?ee<q?rt+=pe:ee>H&&(at+=pe):ee!=Ce&&(Ce<H&&fe>H?(at+=pe,ut=!0):Ce>q&&fe<q&&(rt+=pe,ut=!0)),tt/=4),lt=Ft,!L&&fe>q&&fe<H&&ht.getTangent(Ft,ve)[v?"x":"y"]===0&&T(C,b,!v,x,!0)}}function Pt(Ft){var Jt=Ft[M+0],zt=Ft[M+2],ee=Ft[M+4],_e=Ft[M+6];if(V<=i(Jt,zt,ee,_e)&&V>=t(Jt,zt,ee,_e)){for(var Ee=Ft[S+0],wt=Ft[S+2],ve=Ft[S+4],fe=Ft[S+6],pe=q>i(Ee,wt,ve,fe)||H<t(Ee,wt,ve,fe)?[Ft]:ht.getMonoCurves(Ft,v),Ae,Ce=0,e=pe.length;Ce<e;Ce++)if(Ae=ct(pe[Ce]))return Ae}}for(var gt=0,It=E.length;gt<It;gt++){var Et=E[gt],bt=Et._path,$t=Et.getValues(),te;if((!gt||E[gt-1]._path!==bt)&&(lt=null,bt._closed||(dt=ht.getValues(bt.getLastCurve().getSegment2(),Et.getSegment1(),null,!x),dt[M]!==dt[M+6]&&(lt=dt)),!lt)){lt=$t;for(var ne=bt.getLastCurve();ne&&ne!==Et;){var Gt=ne.getValues();if(Gt[M]!==Gt[M+6]){lt=Gt;break}ne=ne.getPrevious()}}if(te=Pt($t))return te;if(gt+1===It||E[gt+1]._path!==bt){if(dt&&(te=Pt(dt)))return te;ut&&!rt&&!at&&(rt=at=bt.isClockwise(x)^v?1:-1),U+=rt,j+=at,rt=at=0,ut&&(ft=!0,ut=!1),dt=null}}return U=n(U),j=n(j),{winding:i(U,j),windingL:U,windingR:j,quality:tt,onPath:ft}}function w(C,b,v,x,L){var E=[],S=C,M=0,D;do{var X=C.getCurve();if(X){var k=X.getLength();E.push({segment:C,curve:X,length:k}),M+=k}C=C.getNext()}while(C&&!C._intersection&&C!==S);for(var V=[.5,.25,.75],D={winding:0,quality:-1},z=.001,q=1-z,H=0;H<V.length&&D.quality<.5;H++)for(var k=M*V[H],U=0,j=E.length;U<j;U++){var rt=E[U],at=rt.length;if(k<=at){var X=rt.curve,ut=X._path,ft=ut._parent,tt=ft instanceof be?ft:ut,it=Dt.clamp(X.getTimeAt(k),z,q),lt=X.getPointAtTime(it),dt=n(X.getTangentAtTime(it).y)<Math.SQRT1_2,ct=null;if(L.subtract&&v){var Pt=tt===b?v:b,gt=Pt._getWinding(lt,dt,!0);if(tt===b&&gt.winding||tt===v&&!gt.winding){if(gt.quality<1)continue;ct={winding:0,quality:1}}}ct=ct||T(lt,x[ut._id][X.getIndex()],dt,!0),ct.quality>D.quality&&(D=ct);break}k-=at}for(var U=E.length-1;U>=0;U--)E[U].segment._winding=D}function O(C,b){var v=[],x;function L(It){var Et;return!!(It&&!It._visited&&(!b||b[(Et=It._winding||{}).winding]&&!(b.unite&&Et.winding===2&&Et.windingL&&Et.windingR)))}function E(It){if(It){for(var Et=0,bt=x.length;Et<bt;Et++)if(It===x[Et])return!0}return!1}function S(It){for(var Et=It._segments,bt=0,$t=Et.length;bt<$t;bt++)Et[bt]._visited=!0}function M(It,Et){var bt=It._intersection,$t=bt,te=[];Et&&(x=[It]);function ne(Gt,Ft){for(;Gt&&Gt!==Ft;){var Jt=Gt._segment,zt=Jt&&Jt._path;if(zt){var ee=Jt.getNext()||zt.getFirstSegment(),_e=ee._intersection;Jt!==It&&(E(Jt)||E(ee)||ee&&L(Jt)&&(L(ee)||_e&&L(_e._segment)))&&te.push(Jt),Et&&x.push(Jt)}Gt=Gt._next}}if(bt){for(ne(bt);bt&&bt._previous;)bt=bt._previous;ne(bt,$t)}return te}C.sort(function(It,Et){var bt=It._intersection,$t=Et._intersection,te=!!(bt&&bt._overlap),ne=!!($t&&$t._overlap),Gt=It._path,Ft=Et._path;return te^ne?te?1:-1:!bt^!$t?bt?1:-1:Gt!==Ft?Gt._id-Ft._id:It._index-Et._index});for(var X=0,k=C.length;X<k;X++){var V=C[X],D=L(V),z=null,q=!1,H=!0,U=[],j,rt,at;if(D&&V._path._overlapsOnly){var ut=V._path,ft=V._intersection._segment._path;ut.compare(ft)&&(ut.getArea()&&v.push(ut.clone(!1)),S(ut),S(ft),D=!1)}for(;D;){var tt=!z,it=M(V,tt),lt=it.shift(),q=!tt&&(E(V)||E(lt)),dt=!q&&lt;if(tt&&(z=new Xt(At.NO_INSERT),j=null),q){(V.isFirst()||V.isLast())&&(H=V._path._closed),V._visited=!0;break}if(dt&&j&&(U.push(j),j=null),j||(dt&&it.push(V),j={start:z._segments.length,crossings:it,visited:rt=[],handleIn:at}),dt&&(V=lt),!L(V)){z.removeSegments(j.start);for(var ct=0,Pt=rt.length;ct<Pt;ct++)rt[ct]._visited=!1;rt.length=0;do V=j&&j.crossings.shift(),(!V||!V._path)&&(V=null,j=U.pop(),j&&(rt=j.visited,at=j.handleIn));while(j&&!L(V));if(!V)break}var gt=V.getNext();z.add(new yt(V._point,at,gt&&V._handleOut)),V._visited=!0,rt.push(V),V=gt||V._path.getFirstSegment(),at=gt&&gt._handleIn}q&&(H&&(z.getFirstSegment().setHandleIn(at),z.setClosed(H)),z.getArea()!==0&&v.push(z))}return v}return{_getWinding:function(C,b,v){return T(C,this.getCurves(),b,v)},unite:function(C,b){return d(this,C,"unite",b)},intersect:function(C,b){return d(this,C,"intersect",b)},subtract:function(C,b){return d(this,C,"subtract",b)},exclude:function(C,b){return d(this,C,"exclude",b)},divide:function(C,b){return b&&(b.trace==!1||b.stroke)?p(this,C,"divide"):c([this.subtract(C,b),this.intersect(C,b)],!0,this,C,b)},resolveCrossings:function(){var C=this._children,b=C||[this];function v(j,rt){var at=j&&j._intersection;return at&&at._overlap&&at._path===rt}var x=!1,L=!1,E=this.getIntersections(null,function(j){return j.hasOverlap()&&(x=!0)||j.isCrossing()&&(L=!0)}),S=x&&L&&[];if(E=xe.expand(E),x)for(var M=g(E,function(j){return j.hasOverlap()},S),X=M.length-1;X>=0;X--){var k=M[X],V=k._path,D=k._segment,z=D.getPrevious(),q=D.getNext();v(z,V)&&v(q,V)&&(D.remove(),z._handleOut._set(0,0),q._handleIn._set(0,0),z!==D&&!z.getCurve().hasLength()&&(q._handleIn.set(z._handleIn),z.remove()))}L&&(g(E,x&&function(j){var rt=j.getCurve(),at=j.getSegment(),ut=j._intersection,ft=ut._curve,tt=ut._segment;if(rt&&ft&&rt._path&&ft._path)return!0;at&&(at._intersection=null),tt&&(tt._intersection=null)},S),S&&P(S),b=O(A.each(b,function(j){A.push(this,j._segments)},[])));var H=b.length,U;return H>1&&C?(b!==C&&this.setChildren(b),U=this):H===1&&!C&&(b[0]!==this&&this.setSegments(b[0].removeSegments()),U=this),U||(U=new be(At.NO_INSERT),U.addChildren(b),U=U.reduce(),U.copyAttributes(this),this.replaceWith(U)),U},reorient:function(C,b){var v=this._children;return v&&v.length?this.setChildren(m(this.removeChildren(),function(x){return!!(C?x:x&1)},b)):b!==B&&this.setClockwise(b),this},getInteriorPoint:function(){var C=this.getBounds(),b=C.getCenter(!0);if(!this.contains(b)){for(var v=this.getCurves(),x=b.y,L=[],E=[],S=0,M=v.length;S<M;S++){var X=v[S].getValues(),k=X[1],V=X[3],D=X[5],z=X[7];if(x>=t(k,V,D,z)&&x<=i(k,V,D,z))for(var q=ht.getMonoCurves(X),H=0,U=q.length;H<U;H++){var j=q[H],rt=j[1],at=j[7];if(rt!==at&&(x>=rt&&x<=at||x>=at&&x<=rt)){var ut=x===rt?j[0]:x===at?j[6]:ht.solveCubic(j,1,x,E,0,1)===1?ht.getPoint(j,E[0]).x:(j[0]+j[6])/2;L.push(ut)}}}L.length>1&&(L.sort(function(ft,tt){return ft-tt}),b.x=(L[0]+L[1])/2)}return b}}});var li=A.extend({_class:"PathFlattener",initialize:function(t,i,n,s,u){var l=[],c=[],f=0,d=1/(n||32),p=t._segments,y=p[0],P;function m(O,C){var b=ht.getValues(O,C,u);l.push(b),g(b,O._index,0,1)}function g(O,C,b,v){if(v-b>d&&!(s&&ht.isStraight(O))&&!ht.isFlatEnough(O,i||.25)){var x=ht.subdivide(O,.5),L=(b+v)/2;g(x[0],C,b,L),g(x[1],C,L,v)}else{var E=O[6]-O[0],S=O[7]-O[1],M=Math.sqrt(E*E+S*S);M>0&&(f+=M,c.push({offset:f,curve:O,index:C,time:v}))}}for(var T=1,w=p.length;T<w;T++)P=p[T],m(y,P),y=P;t._closed&&m(P||y,p[0]),this.curves=l,this.parts=c,this.length=f,this.index=0},_get:function(t){for(var i=this.parts,n=i.length,s,u=this.index;s=u,!(!u||i[--u].offset<t););for(;s<n;s++){var l=i[s];if(l.offset>=t){this.index=s;var c=i[s-1],f=c&&c.index===l.index?c.time:0,d=c?c.offset:0;return{index:l.index,time:f+(l.time-f)*(t-d)/(l.offset-d)}}}return{index:i[n-1].index,time:1}},drawPart:function(t,i,n){for(var s=this._get(i),u=this._get(n),l=s.index,c=u.index;l<=c;l++){var f=ht.getPart(this.curves[l],l===s.index?s.time:0,l===u.index?u.time:1);l===s.index&&t.moveTo(f[0],f[1]),t.bezierCurveTo.apply(t,f.slice(2))}}},A.each(ht._evaluateMethods,function(t){this[t+"At"]=function(i){var n=this._get(i);return ht[t](this.curves[n.index],n.time)}},{})),wi=A.extend({initialize:function(t){for(var i=this.points=[],n=t._segments,s=t._closed,u=0,l,c=n.length;u<c;u++){var f=n[u].point;(!l||!l.equals(f))&&i.push(l=f.clone())}s&&(i.unshift(i[i.length-1]),i.push(i[1])),this.closed=s},fit:function(t){var i=this.points,n=i.length,s=null;return n>0&&(s=[new yt(i[0])],n>1&&(this.fitCubic(s,t,0,n-1,i[1].subtract(i[0]),i[n-2].subtract(i[n-1])),this.closed&&(s.shift(),s.pop()))),s},fitCubic:function(t,i,n,s,u,l){var c=this.points;if(s-n===1){var f=c[n],d=c[s],p=f.getDistance(d)/3;this.addCurve(t,[f,f.add(u.normalize(p)),d.add(l.normalize(p)),d]);return}for(var y=this.chordLengthParameterize(n,s),P=Math.max(i,i*i),m,g=!0,T=0;T<=4;T++){var w=this.generateBezier(n,s,y,u,l),O=this.findMaxError(n,s,w,y);if(O.error<i&&g){this.addCurve(t,w);return}if(m=O.index,O.error>=P)break;g=this.reparameterize(n,s,y,w),P=O.error}var C=c[m-1].subtract(c[m+1]);this.fitCubic(t,i,n,m,u,C),this.fitCubic(t,i,m,s,C.negate(),l)},addCurve:function(t,i){var n=t[t.length-1];n.setHandleOut(i[1].subtract(i[0])),t.push(new yt(i[3],i[2].subtract(i[3])))},generateBezier:function(t,i,n,s,u){for(var l=1e-12,c=Math.abs,f=this.points,d=f[t],p=f[i],y=[[0,0],[0,0]],P=[0,0],m=0,g=i-t+1;m<g;m++){var T=n[m],w=1-T,O=3*T*w,C=w*w*w,b=O*w,v=O*T,x=T*T*T,L=s.normalize(b),E=u.normalize(v),S=f[t+m].subtract(d.multiply(C+b)).subtract(p.multiply(v+x));y[0][0]+=L.dot(L),y[0][1]+=L.dot(E),y[1][0]=y[0][1],y[1][1]+=E.dot(E),P[0]+=L.dot(S),P[1]+=E.dot(S)}var M=y[0][0]*y[1][1]-y[1][0]*y[0][1],X,k;if(c(M)>l){var V=y[0][0]*P[1]-y[1][0]*P[0],D=P[0]*y[1][1]-P[1]*y[0][1];X=D/M,k=V/M}else{var z=y[0][0]+y[0][1],q=y[1][0]+y[1][1];X=k=c(z)>l?P[0]/z:c(q)>l?P[1]/q:0}var H=p.getDistance(d),U=l*H,j,rt;if(X<U||k<U)X=k=H/3;else{var at=p.subtract(d);j=s.normalize(X),rt=u.normalize(k),j.dot(at)-rt.dot(at)>H*H&&(X=k=H/3,j=rt=null)}return[d,d.add(j||s.normalize(X)),p.add(rt||u.normalize(k)),p]},reparameterize:function(t,i,n,s){for(var u=t;u<=i;u++)n[u-t]=this.findRoot(s,this.points[u],n[u-t]);for(var u=1,l=n.length;u<l;u++)if(n[u]<=n[u-1])return!1;return!0},findRoot:function(t,i,n){for(var s=[],u=[],l=0;l<=2;l++)s[l]=t[l+1].subtract(t[l]).multiply(3);for(var l=0;l<=1;l++)u[l]=s[l+1].subtract(s[l]).multiply(2);var c=this.evaluate(3,t,n),f=this.evaluate(2,s,n),d=this.evaluate(1,u,n),p=c.subtract(i),y=f.dot(f)+p.dot(d);return Dt.isMachineZero(y)?n:n-p.dot(f)/y},evaluate:function(t,i,n){for(var s=i.slice(),u=1;u<=t;u++)for(var l=0;l<=t-u;l++)s[l]=s[l].multiply(1-n).add(s[l+1].multiply(n));return s[0]},chordLengthParameterize:function(t,i){for(var n=[0],s=t+1;s<=i;s++)n[s-t]=n[s-t-1]+this.points[s].getDistance(this.points[s-1]);for(var s=1,u=i-t;s<=u;s++)n[s]/=n[u];return n},findMaxError:function(t,i,n,s){for(var u=Math.floor((i-t+1)/2),l=0,c=t+1;c<i;c++){var f=this.evaluate(3,n,s[c-t]),d=f.subtract(this.points[c]),p=d.x*d.x+d.y*d.y;p>=l&&(l=p,u=c)}return{error:l,index:u}}}),Ie=At.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(i){this._content="",this._lines=[];var n=i&&A.isPlainObject(i)&&i.x===B&&i.y===B;this._initialize(n&&i,!n&&Z.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),xi=Ie.extend({_class:"PointText",initialize:function(){Ie.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new me(t.x,t.y,this,"setPoint")},setPoint:function(){var t=Z.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,i,n){if(this._content){this._setStyles(t,i,n);var s=this._lines,u=this._style,l=u.hasFill(),c=u.hasStroke(),f=u.getLeading(),d=t.shadowColor;t.font=u.getFontStyle(),t.textAlign=u.getJustification();for(var p=0,y=s.length;p<y;p++){t.shadowColor=d;var P=s[p];l&&(t.fillText(P,0,0),t.shadowColor="rgba(0,0,0,0)"),c&&t.strokeText(P,0,0),t.translate(0,f)}}},_getBounds:function(t,i){var n=this._style,s=this._lines,u=s.length,l=n.getJustification(),c=n.getLeading(),f=this.getView().getTextWidth(n.getFontStyle(),s),d=0;l!=="left"&&(d-=f/(l==="center"?2:1));var p=new Ct(d,u?-.75*c:0,f,u*c);return t?t._transformBounds(p,p):p}}),Kt=A.extend(new function(){var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},n={transparent:[0,0,0,0]},s;function u(f){var d=f.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||f.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),p="rgb",y;if(d){var P=d[4]?4:3;y=new Array(P);for(var m=0;m<P;m++){var g=d[m+1];y[m]=parseInt(g.length==1?g+g:g,16)/255}}else if(d=f.match(/^(rgb|hsl)a?\((.*)\)$/)){p=d[1],y=d[2].trim().split(/[,\s]+/g);for(var T=p==="hsl",m=0,w=Math.min(y.length,4);m<w;m++){var O=y[m],g=parseFloat(O);if(T)if(m===0){var C=O.match(/([a-z]*)$/)[1];g*={turn:360,rad:180/Math.PI,grad:.9}[C]||1}else m<3&&(g/=100);else m<3&&(g/=/%$/.test(O)?100:255);y[m]=g}}else{var b=n[f];if(!b)if(J){s||(s=Qt.getContext(1,1,{willReadFrequently:!0}),s.globalCompositeOperation="copy"),s.fillStyle="rgba(0,0,0,0)",s.fillStyle=f,s.fillRect(0,0,1,1);var v=s.getImageData(0,0,1,1).data;b=n[f]=[v[0]/255,v[1]/255,v[2]/255]}else b=[0,0,0];y=b.slice()}return[p,y]}var l=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],c={"rgb-hsb":function(f,d,p){var y=Math.max(f,d,p),P=Math.min(f,d,p),m=y-P,g=m===0?0:(y==f?(d-p)/m+(d<p?6:0):y==d?(p-f)/m+2:(f-d)/m+4)*60;return[g,y===0?0:m/y,y]},"hsb-rgb":function(f,d,p){f=(f/60%6+6)%6;var P=Math.floor(f),y=f-P,P=l[P],m=[p,p*(1-d),p*(1-d*y),p*(1-d*(1-y))];return[m[P[0]],m[P[1]],m[P[2]]]},"rgb-hsl":function(f,d,p){var y=Math.max(f,d,p),P=Math.min(f,d,p),m=y-P,g=m===0,T=g?0:(y==f?(d-p)/m+(d<p?6:0):y==d?(p-f)/m+2:(f-d)/m+4)*60,w=(y+P)/2,O=g?0:w<.5?m/(y+P):m/(2-y-P);return[T,O,w]},"hsl-rgb":function(f,d,p){if(f=(f/360%1+1)%1,d===0)return[p,p,p];for(var y=[f+1/3,f,f-1/3],P=p<.5?p*(1+d):p+d-p*d,m=2*p-P,g=[],T=0;T<3;T++){var w=y[T];w<0&&(w+=1),w>1&&(w-=1),g[T]=6*w<1?m+(P-m)*6*w:2*w<1?P:3*w<2?m+(P-m)*(2/3-w)*6:m}return g},"rgb-gray":function(f,d,p){return[f*.2989+d*.587+p*.114]},"gray-rgb":function(f){return[f,f,f]},"gray-hsb":function(f){return[0,0,f]},"gray-hsl":function(f){return[0,0,f]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return A.each(t,function(f,d){i[d]=[],A.each(f,function(p,y){var P=A.capitalize(p),m=/^(hue|saturation)$/.test(p),g=i[d][y]=d==="gradient"?p==="gradient"?function(T){var w=this._components[0];return T=He.read(Array.isArray(T)?T:arguments,0,{readNull:!0}),w!==T&&(w&&w._removeOwner(this),T&&T._addOwner(this)),T}:function(){return Z.read(arguments,0,{readNull:p==="highlight",clone:!0})}:function(T){return T==null||isNaN(T)?0:+T};this["get"+P]=function(){return this._type===d||m&&/^hs[bl]$/.test(this._type)?this._components[y]:this._convert(d)[y]},this["set"+P]=function(T){this._type!==d&&!(m&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(d),this._properties=t[d],this._type=d),this._components[y]=g.call(this,T),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function f(d){var p=arguments,y=this.__read,P=0,m,g,T,w;Array.isArray(d)&&(p=d,d=p[0]);var O=d!=null&&typeof d;if(O==="string"&&d in t&&(m=d,d=p[1],Array.isArray(d)?(g=d,T=p[2]):(y&&(P=1),p=A.slice(p,1),O=typeof d)),!g){if(w=O==="number"?p:O==="object"&&d.length!=null?d:null,w){m||(m=w.length>=3?"rgb":"gray");var C=t[m].length;T=w[C],y&&(P+=w===arguments?C+(T!=null?1:0):1),w.length>C&&(w=A.slice(w,0,C))}else if(O==="string"){var b=u(d);m=b[0],g=b[1],g.length===4&&(T=g[3],g.length--)}else if(O==="object")if(d.constructor===f){if(m=d._type,g=d._components.slice(),T=d._alpha,m==="gradient")for(var v=1,x=g.length;v<x;v++){var L=g[v];L&&(g[v]=L.clone())}}else if(d.constructor===He)m="gradient",w=p;else{m="hue"in d?"lightness"in d?"hsl":"hsb":"gradient"in d||"stops"in d||"radial"in d?"gradient":"gray"in d?"gray":"rgb";var E=t[m],S=i[m];this._components=g=[];for(var v=0,x=E.length;v<x;v++){var M=d[E[v]];M==null&&!v&&m==="gradient"&&"stops"in d&&(M={stops:d.stops,radial:d.radial}),M=S[v].call(this,M),M!=null&&(g[v]=M)}T=d.alpha}y&&m&&(P=1)}if(this._type=m||"rgb",!g){this._components=g=[];for(var S=i[this._type],v=0,x=S.length;v<x;v++){var M=S[v].call(this,w&&w[v]);M!=null&&(g[v]=M)}}return this._components=g,this._properties=t[this._type],this._alpha=T,y&&(this.__read=P),this},set:"#initialize",_serialize:function(f,d){var p=this.getComponents();return A.serialize(/^(gray|rgb)$/.test(this._type)?p:[this._type].concat(p),f,!0,d)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(f){var d;return this._type===f?this._components.slice():(d=c[this._type+"-"+f])?d.apply(this,this._components):c["rgb-"+f].apply(this,c[this._type+"-rgb"].apply(this,this._components))},convert:function(f){return new Kt(f,this._convert(f),this._alpha)},getType:function(){return this._type},setType:function(f){this._components=this._convert(f),this._properties=t[f],this._type=f},getComponents:function(){var f=this._components.slice();return this._alpha!=null&&f.push(this._alpha),f},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(f){this._alpha=f==null?null:Math.min(Math.max(f,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(f){var d=A.isPlainValue(f,!0)?Kt.read(arguments):f;return d===this||d&&this._class===d._class&&this._type===d._type&&this.getAlpha()===d.getAlpha()&&A.equals(this._components,d._components)||!1},toString:function(){for(var f=this._properties,d=[],p=this._type==="gradient",y=he.instance,P=0,m=f.length;P<m;P++){var g=this._components[P];g!=null&&d.push(f[P]+": "+(p?g:y.number(g)))}return this._alpha!=null&&d.push("alpha: "+y.number(this._alpha)),"{ "+d.join(", ")+" }"},toCSS:function(f){var d=this._convert("rgb"),p=f||this._alpha==null?1:this._alpha;function y(P){return Math.round((P<0?0:P>1?1:P)*255)}return d=[y(d[0]),y(d[1]),y(d[2])],p<1&&d.push(p<0?0:p),f?"#"+((1<<24)+(d[0]<<16)+(d[1]<<8)+d[2]).toString(16).slice(1):(d.length==4?"rgba(":"rgb(")+d.join(",")+")"},toCanvasStyle:function(f,d){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var p=this._components,y=p[0],P=y._stops,m=p[1],g=p[2],T=p[3],w=d&&d.inverted(),O;if(w&&(m=w._transformPoint(m),g=w._transformPoint(g),T&&(T=w._transformPoint(T))),y._radial){var C=g.getDistance(m);if(T){var b=T.subtract(m);b.getLength()>C&&(T=m.add(b.normalize(C-.1)))}var v=T||m;O=f.createRadialGradient(v.x,v.y,0,m.x,m.y,C)}else O=f.createLinearGradient(m.x,m.y,g.x,g.y);for(var x=0,L=P.length;x<L;x++){var E=P[x],S=E._offset;O.addColorStop(S??x/(L-1),E._color.toCanvasStyle())}return this._canvasStyle=O},transform:function(f){if(this._type==="gradient"){for(var d=this._components,p=1,y=d.length;p<y;p++){var P=d[p];f._transformPoint(P,P,!0)}this._changed()}},statics:{_types:t,random:function(){var f=Math.random;return new Kt(f(),f(),f())},_setOwner:function(f,d,p){return f&&(f._owner&&d&&f._owner!==d&&(f=f.clone()),!f._owner^!d&&(f._owner=d||null,f._setter=p||null)),f}}})},new function(){var t={add:function(i,n){return i+n},subtract:function(i,n){return i-n},multiply:function(i,n){return i*n},divide:function(i,n){return i/n}};return A.each(t,function(i,n){this[n]=function(s){s=Kt.read(arguments);for(var u=this._type,l=this._components,c=s._convert(u),f=0,d=l.length;f<d;f++)c[f]=i(l[f],c[f]);return new Kt(u,c,this._alpha!=null?i(this._alpha,s.getAlpha()):null)}},{})}),He=A.extend({_class:"Gradient",initialize:function(i,n){this._id=we.get(),i&&A.isPlainObject(i)&&(this.set(i),i=n=null),this._stops==null&&this.setStops(i||["white","black"]),this._radial==null&&this.setRadial(typeof n=="string"&&n==="radial"||n||!1)},_serialize:function(t,i){return i.add(this,function(){return A.serialize([this._stops,this._radial],t,!0,i)})},_changed:function(){for(var t=0,i=this._owners&&this._owners.length;t<i;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var i=this._owners?this._owners.indexOf(t):-1;i!=-1&&(this._owners.splice(i,1),this._owners.length||(this._owners=B))},clone:function(){for(var t=[],i=0,n=this._stops.length;i<n;i++)t[i]=this._stops[i].clone();return new He(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var i=this._stops;if(i)for(var n=0,s=i.length;n<s;n++)i[n]._owner=B;i=this._stops=$e.readList(t,0,{clone:!0});for(var n=0,s=i.length;n<s;n++)i[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var i=this._stops,n=t._stops,s=i.length;if(s===n.length){for(var u=0;u<s;u++)if(!i[u].equals(n[u]))return!1;return!0}}return!1}}),$e=A.extend({_class:"GradientStop",initialize:function(i,n){var s=i,u=n;typeof i=="object"&&n===B&&(Array.isArray(i)&&typeof i[0]!="number"?(s=i[0],u=i[1]):("color"in i||"offset"in i||"rampPoint"in i)&&(s=i.color,u=i.offset||i.rampPoint||0)),this.setColor(s),this.setOffset(u)},clone:function(){return new $e(this._color.clone(),this._offset)},_serialize:function(t,i){var n=this._color,s=this._offset;return A.serialize(s==null?[n]:[n,s],t,!0,i)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Kt._setOwner(this._color,null),this._color=Kt._setOwner(Kt.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),ti=A.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new Z,selectedColor:null},i=A.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=A.set({},i,{fillColor:new Kt}),s={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},u={beans:!0},l={_class:"Style",beans:!0,initialize:function(f,d,p){this._values={},this._owner=d,this._project=d&&d._project||p||Mt.project,this._defaults=!d||d instanceof Se?i:d instanceof Ie?n:t,f&&this.set(f)}};return A.each(i,function(c,f){var d=/Color$/.test(f),p=f==="shadowOffset",y=A.capitalize(f),P=s[f],m="set"+y,g="get"+y;l[m]=function(T){var w=this._owner,O=w&&w._children,C=O&&O.length>0&&!(w instanceof be);if(C)for(var b=0,v=O.length;b<v;b++)O[b]._style[m](T);if((f==="selectedColor"||!C)&&f in this._defaults){var x=this._values[f];x!==T&&(d&&(x&&(Kt._setOwner(x,null),x._canvasStyle=null),T&&T.constructor===Kt&&(T=Kt._setOwner(T,w,C&&m))),this._values[f]=T,w&&w._changed(P||129))}},l[g]=function(T){var w=this._owner,O=w&&w._children,C=O&&O.length>0&&!(w instanceof be),b;if(C&&!T)for(var v=0,x=O.length;v<x;v++){var L=O[v]._style[g]();if(!v)b=L;else if(!A.equals(b,L))return B}else if(f in this._defaults){var b=this._values[f];if(b===B)b=this._defaults[f],b&&b.clone&&(b=b.clone());else{var E=d?Kt:p?Z:null;E&&!(b&&b.constructor===E)&&(this._values[f]=b=E.read([b],0,{readNull:!0,clone:!0}))}}return b&&d&&(b=Kt._setOwner(b,w,C&&m)),b},u[g]=function(T){return this._style[g](T)},u[m]=function(T){this._style[m](T)}}),A.each({Font:"FontFamily",WindingRule:"FillRule"},function(c,f){var d="get"+f,p="set"+f;l[d]=u[d]="#get"+c,l[p]=u[p]="#set"+c}),At.inject(u),l},{set:function(t){var i=t instanceof ti,n=i?t._values:t;if(n){for(var s in n)if(s in this._defaults){var u=n[s];this[s]=u&&i&&u.clone?u.clone():u}}},equals:function(t){function i(n,s,u){var l=n._values,c=s._values,f=s._defaults;for(var d in l){var p=l[d],y=c[d];if(!(u&&d in c)&&!A.equals(p,y===B?f[d]:y))return!1}return!0}return t===this||t&&this._class===t._class&&i(this,t)&&i(t,this,!0)||!1},_dispose:function(){var t;t=this.getFillColor(),t&&(t._canvasStyle=null),t=this.getStrokeColor(),t&&(t._canvasStyle=null),t=this.getShadowColor(),t&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var i=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),i??n*1.2}}),Ht=new function(){function t(i,n,s,u){for(var l=["","webkit","moz","Moz","ms","o"],c=n[0].toUpperCase()+n.substring(1),f=0;f<6;f++){var d=l[f],p=d?d+c:n;if(p in i){if(s)i[p]=u;else return i[p];break}}}return{getStyles:function(i){var n=i&&i.nodeType!==9?i.ownerDocument:i,s=n&&n.defaultView;return s&&s.getComputedStyle(i,"")},getBounds:function(i,n){var s=i.ownerDocument,u=s.body,l=s.documentElement,c;try{c=i.getBoundingClientRect()}catch{c={left:0,top:0,width:0,height:0}}var f=c.left-(l.clientLeft||u.clientLeft||0),d=c.top-(l.clientTop||u.clientTop||0);if(!n){var p=s.defaultView;f+=p.pageXOffset||l.scrollLeft||u.scrollLeft,d+=p.pageYOffset||l.scrollTop||u.scrollTop}return new Ct(f,d,c.width,c.height)},getViewportBounds:function(i){var n=i.ownerDocument,s=n.defaultView,u=n.documentElement;return new Ct(0,0,s.innerWidth||u.clientWidth,s.innerHeight||u.clientHeight)},getOffset:function(i,n){return Ht.getBounds(i,n).getPoint()},getSize:function(i){return Ht.getBounds(i,!0).getSize()},isInvisible:function(i){return Ht.getSize(i).equals(new _t(0,0))},isInView:function(i){return!Ht.isInvisible(i)&&Ht.getViewportBounds(i).intersects(Ht.getBounds(i,!0))},isInserted:function(i){return G.body.contains(i)},getPrefixed:function(i,n){return i&&t(i,n)},setPrefixed:function(i,n,s){if(typeof n=="object")for(var u in n)t(i,u,!0,n[u]);else t(i,n,!0,s)}}},Wt={add:function(t,i){if(t)for(var n in i)for(var s=i[n],u=n.split(/[\s,]+/g),l=0,c=u.length;l<c;l++){var f=u[l],d=t===G&&(f==="touchstart"||f==="touchmove")?{passive:!1}:!1;t.addEventListener(f,s,d)}},remove:function(t,i){if(t)for(var n in i)for(var s=i[n],u=n.split(/[\s,]+/g),l=0,c=u.length;l<c;l++)t.removeEventListener(u[l],s,!1)},getPoint:function(t){var i=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new Z(i.pageX||i.clientX+G.documentElement.scrollLeft,i.pageY||i.clientY+G.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,i){return Wt.getPoint(t).subtract(Ht.getOffset(i||Wt.getTarget(t)))}};Wt.requestAnimationFrame=new function(){var t=Ht.getPrefixed(J,"requestAnimationFrame"),i=!1,n=[],s;function u(){var l=n;n=[];for(var c=0,f=l.length;c<f;c++)l[c]();i=t&&n.length,i&&t(u)}return function(l){n.push(l),t?i||(t(u),i=!0):s||(s=setInterval(u,1e3/60))}};var Zt=A.extend(pt,{_class:"View",initialize:function t(i,n){function s(P){return n[P]||parseInt(n.getAttribute(P),10)}function u(){var P=Ht.getSize(n);return P.isNaN()||P.isZero()?new _t(s("width"),s("height")):P}var l;if(J&&n){this._id=n.getAttribute("id"),this._id==null&&n.setAttribute("id",this._id="paper-view-"+t._id++),Wt.add(n,this._viewEvents);var c="none";if(Ht.setPrefixed(n.style,{userDrag:c,userSelect:c,touchCallout:c,contentZooming:c,tapHighlightColor:"rgba(0,0,0,0)"}),$.hasAttribute(n,"resize")){var f=this;Wt.add(J,this._windowEvents={resize:function(){f.setViewSize(u())}})}if(l=u(),$.hasAttribute(n,"stats")&&typeof Stats<"u"){this._stats=new Stats;var d=this._stats.domElement,p=d.style,y=Ht.getOffset(n);p.position="absolute",p.left=y.x+"px",p.top=y.y+"px",G.body.appendChild(d)}}else l=new _t(n),n=null;this._project=i,this._scope=i._scope,this._element=n,this._pixelRatio||(this._pixelRatio=J&&J.devicePixelRatio||1),this._setElementSize(l.width,l.height),this._viewSize=l,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new Vt)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!Mt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Zt._focused===this&&(Zt._focused=null),Zt._views.splice(Zt._views.indexOf(this),1),delete Zt._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),Wt.remove(this._element,this._viewEvents),Wt.remove(J,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:A.each(At._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;Wt.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var i=t._element;(!Ht.getPrefixed(G,"hidden")||$.getAttribute(i,"keepalive")==="true")&&Ht.isInView(i)&&t._handleFrame()}t._autoUpdate&&t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){Mt=this._scope;var t=Date.now()/1e3,i=this._last?t-this._last:0;this._last=t,this.emit("frame",new A({delta:i,time:this._time+=i,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,i){var n=this._frameItems;i?(n[t._id]={item:t,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete n[t._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var i in this._frameItems){var n=this._frameItems[i];n.item.emit("frame",new A(t,{time:n.time+=t.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=B},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var t=this._viewSize;return new re(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=_t.read(arguments),i=t.subtract(this._viewSize);i.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:i}),this._autoUpdate&&this.update())},_setElementSize:function(t,i){var n=this._element;n&&(n.width!==t&&(n.width=t),n.height!==i&&(n.height=i))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new Ct(new Z,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ht.isInView(this._element)},isInserted:function(){return Ht.isInserted(this._element)},getPixelSize:function(t){var i=this._element,n;if(i){var s=i.parentNode,u=G.createElement("div");u.style.fontSize=t,s.appendChild(u),n=parseFloat(Ht.getStyles(u).fontSize),s.removeChild(u)}else n=parseFloat(n);return n},getTextWidth:function(t,i){return 0}},A.each(["rotate","scale","shear","skew"],function(t){var i=t==="rotate";this[t]=function(){var n=arguments,s=(i?A:Z).read(n),u=Z.read(n,0,{readNull:!0});return this.transform(new Vt()[t](s,u||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new Vt;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=Z.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new Vt().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var i=this.getRotation();i!=null&&t!=null&&this.rotate(t-i)},getScaling:function(){var t=this._decompose().scaling;return new me(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),i=Z.read(arguments,0,{clone:!0,readNull:!0});t&&i&&this.scale(i.x/t.x,i.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(Z.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(Z.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(Z.read(arguments))},getEventPoint:function(t){return this.viewToProject(Wt.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,i){G&&typeof i=="string"&&(i=G.getElementById(i));var n=J?bi:Zt;return new n(t,i)}}},new function(){if(!J)return;var t,i,n=!1,s=!1;function u(D){var z=Wt.getTarget(D);return z.getAttribute&&Zt._viewsById[z.getAttribute("id")]}function l(){var D=Zt._focused;if(!D||!D.isVisible()){for(var z=0,q=Zt._views.length;z<q;z++)if((D=Zt._views[z]).isVisible()){Zt._focused=i=D;break}}}function c(D,z,q){D._handleMouseEvent("mousemove",z,q)}var f=J.navigator,d,p,y;f.pointerEnabled||f.msPointerEnabled?(d="pointerdown MSPointerDown",p="pointermove MSPointerMove",y="pointerup pointercancel MSPointerUp MSPointerCancel"):(d="touchstart",p="touchmove",y="touchend touchcancel","ontouchstart"in J&&f.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(d+=" mousedown",p+=" mousemove",y+=" mouseup"));var P={},m={mouseout:function(D){var z=Zt._focused,q=Wt.getRelatedTarget(D);if(z&&(!q||q.nodeName==="HTML")){var H=Wt.getOffset(D,z._element),U=H.x,j=Math.abs,rt=j(U),at=1<<25,ut=rt-at;H.x=j(ut)<rt?ut*(U<0?-1:1):U,c(z,D,z.viewToProject(H))}},scroll:l};P[d]=function(D){var z=Zt._focused=u(D);n||(n=!0,z._handleMouseEvent("mousedown",D))},m[p]=function(D){var z=Zt._focused;if(!s){var q=u(D);q?z!==q&&(z&&c(z,D),t||(t=z),z=Zt._focused=i=q):i&&i===z&&(t&&!t.isInserted()&&(t=null),z=Zt._focused=t,t=null,l())}z&&c(z,D)},m[d]=function(){s=!0},m[y]=function(D){var z=Zt._focused;z&&n&&z._handleMouseEvent("mouseup",D),s=n=!1},Wt.add(G,m),Wt.add(J,{load:l});var g=!1,T=!1,w={doubleclick:"click",mousedrag:"mousemove"},O=!1,C,b,v,x,L,E,S,M;function X(D,z,q,H,U,j,rt){var at=!1,ut;function ft(tt,it){if(tt.responds(it)){if(ut||(ut=new Si(it,H,U,z||tt,j?U.subtract(j):null)),tt.emit(it,ut)&&(g=!0,ut.prevented&&(T=!0),ut.stopped))return at=!0}else{var lt=w[it];if(lt)return ft(tt,lt)}}for(;D&&D!==rt&&!ft(D,q);)D=D._parent;return at}function k(D,z,q,H,U,j){return D._project.removeOn(q),T=g=!1,L&&X(L,null,q,H,U,j)||z&&z!==L&&!z.isDescendant(L)&&X(z,null,q==="mousedrag"?"mousemove":q,H,U,j,L)||X(D,L||z||D,q,H,U,j)}var V={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:P,_handleMouseEvent:function(D,z,q){var H=this._itemEvents,U=H.native[D],j=D==="mousemove",rt=this._scope.tool,at=this;function ut(Pt){return H.virtual[Pt]||at.responds(Pt)||rt&&rt.responds(Pt)}j&&n&&ut("mousedrag")&&(D="mousedrag"),q||(q=this.getEventPoint(z));var ft=this.getBounds().contains(q),tt=U&&ft&&at._project.hitTest(q,{tolerance:0,fill:!0,stroke:!0}),it=tt&&tt.item||null,lt=!1,dt={};if(dt[D.substr(5)]=!0,U&&it!==x&&(x&&X(x,null,"mouseleave",z,q),it&&X(it,null,"mouseenter",z,q),x=it),O^ft&&(X(this,null,ft?"mouseenter":"mouseleave",z,q),lt=!0),(ft||dt.drag)&&!q.equals(b)&&(k(this,it,j?D:"mousemove",z,q,b),lt=!0),O=ft,dt.down&&ft||dt.up&&C){if(k(this,it,D,z,q,C),dt.down){if(M=it===E&&Date.now()-S<300,v=E=it,!T&&it){for(var ct=it;ct&&!ct.responds("mousedrag");)ct=ct._parent;ct&&(L=it)}C=q}else dt.up&&(!T&&it===v&&(S=Date.now(),k(this,it,M?"doubleclick":"click",z,q,C),M=!1),v=L=null);O=!1,lt=!0}b=q,lt&&rt&&(g=rt._handleMouseEvent(D,z,q,dt)||g),z.cancelable!==!1&&(g&&!dt.move||dt.down&&ut("mouseup"))&&z.preventDefault()},_handleKeyEvent:function(D,z,q,H){var U=this._scope,j=U.tool,rt;function at(ut){ut.responds(D)&&(Mt=U,ut.emit(D,rt=rt||new Ii(D,z,q,H)))}this.isVisible()&&(at(this),j&&j.responds(D)&&at(j))},_countItemEvent:function(D,z){var q=this._itemEvents,H=q.native,U=q.virtual;for(var j in V)H[j]=(H[j]||0)+(V[j][D]||0)*z;U[D]=(U[D]||0)+z},statics:{updateFocus:l,_resetState:function(){n=s=g=O=!1,t=i=C=b=v=x=L=E=S=M=null}}}}),bi=Zt.extend({_class:"CanvasView",initialize:function(i,n){if(!(n instanceof J.HTMLCanvasElement)){var s=_t.read(arguments,1);if(s.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+A.slice(arguments,1));n=Qt.getCanvas(s)}var u=this._context=n.getContext("2d");if(u.save(),this._pixelRatio=1,!/^off|false$/.test($.getAttribute(n,"hidpi"))){var l=J.devicePixelRatio||1,c=Ht.getPrefixed(u,"backingStorePixelRatio")||1;this._pixelRatio=l/c}Zt.call(this,i,n),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(i,n){var s=this._pixelRatio;if(t.base.call(this,i*s,n*s),s!==1){var u=this._element,l=this._context;if(!$.hasAttribute(u,"resize")){var c=u.style;c.width=i+"px",c.height=n+"px"}l.restore(),l.save(),l.scale(s,s)}},getContext:function(){return this._context},getPixelSize:function t(i){var n=Mt.agent,s;if(n&&n.firefox)s=t.base.call(this,i);else{var u=this._context,l=u.font;u.font=i+" serif",s=parseFloat(u.font),u.font=l}return s},getTextWidth:function(t,i){var n=this._context,s=n.font,u=0;n.font=t;for(var l=0,c=i.length;l<c;l++)u=Math.max(u,n.measureText(i[l]).width);return n.font=s,u},update:function(){if(!this._needsUpdate)return!1;var t=this._project,i=this._context,n=this._viewSize;return i.clearRect(0,0,n.width+1,n.height+1),t&&t.draw(i,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Ue=A.extend({_class:"Event",initialize:function(i){this.event=i,this.type=i&&i.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return hi.modifiers}}),Ii=Ue.extend({_class:"KeyEvent",initialize:function(i,n,s,u){this.type=i,this.event=n,this.key=s,this.character=u},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),hi=new function(){var t={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},i={tab:"	",space:" ",enter:"\r"},n={},s={},u,l,c=new A({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var p=Mt&&Mt.agent;return p&&p.mac?this.meta:this.control}}});function f(p){var y=p.key||p.keyIdentifier;return y=/^U\+/.test(y)?String.fromCharCode(parseInt(y.substr(2),16)):/^Arrow[A-Z]/.test(y)?y.substr(5):y==="Unidentified"||y===B?String.fromCharCode(p.keyCode):y,t[y]||(y.length>1?A.hyphenate(y):y.toLowerCase())}function d(p,y,P,m){var g=Zt._focused,T;if(n[y]=p,p?s[y]=P:delete s[y],y.length>1&&(T=A.camelize(y))in c){c[T]=p;var w=Mt&&Mt.agent;if(T==="meta"&&w&&w.mac)if(p)u={};else{for(var O in u)O in s&&d(!1,O,u[O],m);u=null}}else p&&u&&(u[y]=P);g&&g._handleKeyEvent(p?"keydown":"keyup",m,y,P)}return Wt.add(G,{keydown:function(p){var y=f(p),P=Mt&&Mt.agent;y.length>1||P&&P.chrome&&(p.altKey||P.mac&&p.metaKey||!P.mac&&p.ctrlKey)?d(!0,y,i[y]||(y.length>1?"":y),p):l=y},keypress:function(p){if(l){var y=f(p),P=p.charCode,m=P>=32?String.fromCharCode(P):y.length>1?"":y;y!==l&&(y=m.toLowerCase()),d(!0,y,m,p),l=null}},keyup:function(p){var y=f(p);y in s&&d(!1,y,s[y],p)}}),Wt.add(J,{blur:function(p){for(var y in s)d(!1,y,s[y],p)}}),{modifiers:c,isDown:function(p){return!!n[p]}}},Si=Ue.extend({_class:"MouseEvent",initialize:function(i,n,s,u,l){this.type=i,this.event=n,this.point=s,this.target=u,this.delta=l},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Ti=Ue.extend({_class:"ToolEvent",_item:null,initialize:function(i,n,s){this.tool=i,this.type=n,this.event=s},_choosePoint:function(t,i){return t||(i?i.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var i=t.item,n=i._parent;/^(Group|CompoundPath)$/.test(n._class);)i=n,n=n._parent;this._item=i}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Oi=mt.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(i){mt.call(this),this._moveCount=-1,this._downCount=-1,this.set(i)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,t!=null&&this._maxDistance!=null&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,this._minDistance!=null&&t!=null&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,i,n,s){Mt=this._scope,s.drag&&!this.responds(t)&&(t="mousemove");var u=s.move||s.drag,l=this.responds(t),c=!1,f=this;function d(y,P){var m=n,g=u?f._point:f._downPoint||m;if(u){if(f._moveCount>=0&&m.equals(g))return!1;if(g&&(y!=null||P!=null)){var T=m.subtract(g),w=T.getLength();if(w<(y||0))return!1;P&&(m=g.add(T.normalize(Math.min(w,P))))}f._moveCount++}return f._point=m,f._lastPoint=g||m,s.down&&(f._moveCount=-1,f._downPoint=m,f._downCount++),!0}function p(){l&&(c=f.emit(t,new Ti(f,t,i))||c)}if(s.down)d(),p();else if(s.up)d(null,this._maxDistance),p();else if(l)for(;d(this._minDistance,this._maxDistance);)p();return c}}),Li=A.extend(pt,{_class:"Tween",statics:{easings:new A({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(i,n,s,u,l,c){this.object=i;var f=typeof l,d=f==="function";this.type=d?f:f==="string"?l:"linear",this.easing=d?l:t.easings[this.type],this.duration=u,this.running=!1,this._then=null,this._startTime=null;var p=n||s;this._keys=p?Object.keys(p):[],this._parsedKeys=this._parseKeys(this._keys),this._from=p&&this._getState(n),this._to=p&&this._getState(s),c!==!1&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var i=this.easing(t),n=this._keys,s=function(y){return typeof y=="function"?y(i,t):y},u=0,l=n&&n.length;u<l;u++){var c=n[u],f=s(this._from[c]),d=s(this._to[c]),p=f&&d&&f.__add&&d.__add?d.__subtract(f).__multiply(i).__add(f):(d-f)*i+f;this._setProperty(this._parsedKeys[c],p)}this.responds("update")&&this.emit("update",new A({progress:t,factor:i})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var i=this._startTime,n=i?(t-i)/this.duration:0;i||(this._startTime=t),this.update(n)},_getState:function(t){for(var i=this._keys,n={},s=0,u=i.length;s<u;s++){var l=i[s],c=this._parsedKeys[l],f=this._getProperty(c),d;if(t){var p=this._resolveValue(f,t[l]);this._setProperty(c,p),d=this._getProperty(c),d=d&&d.clone?d.clone():d,this._setProperty(c,f)}else d=f&&f.clone?f.clone():f;n[l]=d}return n},_resolveValue:function(t,i){if(i){if(Array.isArray(i)&&i.length===2){var n=i[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(t,n[0],i[1]):i}else if(typeof i=="string"){var s=i.match(/^[+\-*/]=(.*)/);if(s){var u=JSON.parse(s[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,i[0],u)}}}return i},_calculate:function(t,i,n){return Mt.PaperScript.calculateBinary(t,i,n)},_parseKeys:function(t){for(var i={},n=0,s=t.length;n<s;n++){var u=t[n],l=u.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");i[u]=l.split("/")}return i},_getProperty:function(t,i){for(var n=this.object,s=0,u=t.length-(i||0);s<u&&n;s++)n=n[t[s]];return n},_setProperty:function(t,i){var n=this._getProperty(t,1);n&&(n[t[t.length-1]]=i)}}),fi={request:function(t){var i=new a.XMLHttpRequest;return i.open((t.method||"get").toUpperCase(),t.url,A.pick(t.async,!0)),t.mimeType&&i.overrideMimeType(t.mimeType),i.onload=function(){var n=i.status;n===0||n===200?t.onLoad&&t.onLoad.call(i,i.responseText):i.onerror()},i.onerror=function(){var n=i.status,s='Could not load "'+t.url+'" (Status: '+n+")";if(t.onError)t.onError(s,n);else throw new Error(s)},i.send(null)}},Qt=A.exports.CanvasProvider={canvases:[],getCanvas:function(t,i,n){if(!J)return null;var s,u=!0;typeof t=="object"&&(i=t.height,t=t.width),this.canvases.length?s=this.canvases.pop():(s=G.createElement("canvas"),u=!1);var l=s.getContext("2d",n||{});if(!l)throw new Error("Canvas "+s+" is unable to provide a 2D context.");return s.width===t&&s.height===i?u&&l.clearRect(0,0,t+1,i+1):(s.width=t,s.height=i),l.save(),s},getContext:function(t,i,n){var s=this.getCanvas(t,i,n);return s?s.getContext("2d",n||{}):null},release:function(t){var i=t&&t.canvas?t.canvas:t;i&&i.getContext&&(i.getContext("2d").restore(),this.canvases.push(i))}},ei=new function(){var t=Math.min,i=Math.max,n=Math.abs,s,u,l,c,f,d,p,y,P,m,g;function T(L,E,S){return .2989*L+.587*E+.114*S}function w(L,E,S,k){var X=k-T(L,E,S);P=L+X,m=E+X,g=S+X;var k=T(P,m,g),V=t(P,m,g),D=i(P,m,g);if(V<0){var z=k-V;P=k+(P-k)*k/z,m=k+(m-k)*k/z,g=k+(g-k)*k/z}if(D>255){var q=255-k,H=D-k;P=k+(P-k)*q/H,m=k+(m-k)*q/H,g=k+(g-k)*q/H}}function O(L,E,S){return i(L,E,S)-t(L,E,S)}function C(L,E,S,M){var X=[L,E,S],k=i(L,E,S),V=t(L,E,S),D;V=V===L?0:V===E?1:2,k=k===L?0:k===E?1:2,D=t(V,k)===0?i(V,k)===1?2:1:0,X[k]>X[V]?(X[D]=(X[D]-X[V])*M/(X[k]-X[V]),X[k]=M):X[D]=X[k]=0,X[V]=0,P=X[0],m=X[1],g=X[2]}var b={multiply:function(){P=f*s/255,m=d*u/255,g=p*l/255},screen:function(){P=f+s-f*s/255,m=d+u-d*u/255,g=p+l-p*l/255},overlay:function(){P=f<128?2*f*s/255:255-2*(255-f)*(255-s)/255,m=d<128?2*d*u/255:255-2*(255-d)*(255-u)/255,g=p<128?2*p*l/255:255-2*(255-p)*(255-l)/255},"soft-light":function(){var L=s*f/255;P=L+f*(255-(255-f)*(255-s)/255-L)/255,L=u*d/255,m=L+d*(255-(255-d)*(255-u)/255-L)/255,L=l*p/255,g=L+p*(255-(255-p)*(255-l)/255-L)/255},"hard-light":function(){P=s<128?2*s*f/255:255-2*(255-s)*(255-f)/255,m=u<128?2*u*d/255:255-2*(255-u)*(255-d)/255,g=l<128?2*l*p/255:255-2*(255-l)*(255-p)/255},"color-dodge":function(){P=f===0?0:s===255?255:t(255,255*f/(255-s)),m=d===0?0:u===255?255:t(255,255*d/(255-u)),g=p===0?0:l===255?255:t(255,255*p/(255-l))},"color-burn":function(){P=f===255?255:s===0?0:i(0,255-(255-f)*255/s),m=d===255?255:u===0?0:i(0,255-(255-d)*255/u),g=p===255?255:l===0?0:i(0,255-(255-p)*255/l)},darken:function(){P=f<s?f:s,m=d<u?d:u,g=p<l?p:l},lighten:function(){P=f>s?f:s,m=d>u?d:u,g=p>l?p:l},difference:function(){P=f-s,P<0&&(P=-P),m=d-u,m<0&&(m=-m),g=p-l,g<0&&(g=-g)},exclusion:function(){P=f+s*(255-f-f)/255,m=d+u*(255-d-d)/255,g=p+l*(255-p-p)/255},hue:function(){C(s,u,l,O(f,d,p)),w(P,m,g,T(f,d,p))},saturation:function(){C(f,d,p,O(s,u,l)),w(P,m,g,T(f,d,p))},luminosity:function(){w(f,d,p,T(s,u,l))},color:function(){w(s,u,l,T(f,d,p))},add:function(){P=t(f+s,255),m=t(d+u,255),g=t(p+l,255)},subtract:function(){P=i(f-s,0),m=i(d-u,0),g=i(p-l,0)},average:function(){P=(f+s)/2,m=(d+u)/2,g=(p+l)/2},negation:function(){P=255-n(255-s-f),m=255-n(255-u-d),g=255-n(255-l-p)}},v=this.nativeModes=A.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(L){this[L]=!0},{}),x=Qt.getContext(1,1,{willReadFrequently:!0});x&&(A.each(b,function(L,E){var S=E==="darken",M=!1;x.save();try{x.fillStyle=S?"#300":"#a00",x.fillRect(0,0,1,1),x.globalCompositeOperation=E,x.globalCompositeOperation===E&&(x.fillStyle=S?"#a00":"#300",x.fillRect(0,0,1,1),M=x.getImageData(0,0,1,1).data[0]!==S?170:51)}catch{}x.restore(),v[E]=M}),Qt.release(x)),this.process=function(L,E,S,M,X){var k=E.canvas,V=L==="normal";if(V||v[L])S.save(),S.setTransform(1,0,0,1,0,0),S.globalAlpha=M,V||(S.globalCompositeOperation=L),S.drawImage(k,X.x,X.y),S.restore();else{var D=b[L];if(!D)return;for(var z=S.getImageData(X.x,X.y,k.width,k.height),q=z.data,H=E.getImageData(0,0,k.width,k.height).data,U=0,j=q.length;U<j;U+=4){s=H[U],f=q[U],u=H[U+1],d=q[U+1],l=H[U+2],p=q[U+2],c=H[U+3],y=q[U+3],D();var rt=c*M/255,at=1-rt;q[U]=rt*P+at*f,q[U+1]=rt*m+at*d,q[U+2]=rt*g+at*p,q[U+3]=c*M+at*y}S.putImageData(z,X.x,X.y)}}},Ut=new function(){var t="http://www.w3.org/2000/svg",i="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",s={href:n,xlink:i,xmlns:i+"/","xmlns:xlink":i+"/"};function u(f,d,p){return c(G.createElementNS(t,f),d,p)}function l(f,d){var p=s[d],y=p?f.getAttributeNS(p,d):f.getAttribute(d);return y==="null"?null:y}function c(f,d,p){for(var y in d){var P=d[y],m=s[y];typeof P=="number"&&p&&(P=p.number(P)),m?f.setAttributeNS(m,y,P):f.setAttribute(y,P)}return f}return{svg:t,xmlns:i,xlink:n,create:u,get:l,set:c}},ci=A.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,i){return!i&&(t instanceof Xe||t instanceof de||t instanceof Ie)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,i){var n=A.capitalize(i),s=t[2];this[i]={type:t[1],property:i,attribute:t[0],toSVG:s,fromSVG:s&&A.each(s,function(u,l){this[u]=l},{}),exportFilter:t[3],get:"get"+n,set:"set"+n}},{});new function(){var t;function i(b,v,x){var L=new A,E=b.getTranslation();if(v){var S;b.isInvertible()?(b=b._shiftless(),S=b._inverseTransform(E),E=null):S=new Z,L[x?"cx":"x"]=S.x,L[x?"cy":"y"]=S.y}if(!b.isIdentity()){var M=b.decompose();if(M){var X=[],k=M.rotation,V=M.scaling,D=M.skewing;E&&!E.isZero()&&X.push("translate("+t.point(E)+")"),k&&X.push("rotate("+t.number(k)+")"),(!Dt.isZero(V.x-1)||!Dt.isZero(V.y-1))&&X.push("scale("+t.point(V)+")"),D.x&&X.push("skewX("+t.number(D.x)+")"),D.y&&X.push("skewY("+t.number(D.y)+")"),L.transform=X.join(" ")}else L.transform="matrix("+b.getValues().join(",")+")"}return L}function n(b,v){for(var x=i(b._matrix),L=b._children,E=Ut.create("g",x,t),S=0,M=L.length;S<M;S++){var X=L[S],k=O(X,v);if(k)if(X.isClipMask()){var V=Ut.create("clipPath");V.appendChild(k),T(X,V,"clip"),Ut.set(E,{"clip-path":"url(#"+V.id+")"})}else E.appendChild(k)}return E}function s(b,v){var x=i(b._matrix,!0),L=b.getSize(),E=b.getImage();return x.x-=L.width/2,x.y-=L.height/2,x.width=L.width,x.height=L.height,x.href=v.embedImages==!1&&E&&E.src||b.toDataURL(),Ut.create("image",x,t)}function u(b,v){var x=v.matchShapes;if(x){var L=b.toShape(!1);if(L)return l(L)}var E=b._segments,S=E.length,M,X=i(b._matrix);if(x&&S>=2&&!b.hasHandles())if(S>2){M=b._closed?"polygon":"polyline";for(var k=[],V=0;V<S;V++)k.push(t.point(E[V]._point));X.points=k.join(" ")}else{M="line";var D=E[0]._point,z=E[1]._point;X.set({x1:D.x,y1:D.y,x2:z.x,y2:z.y})}else M="path",X.d=b.getPathData(null,v.precision);return Ut.create(M,X,t)}function l(b){var v=b._type,x=b._radius,L=i(b._matrix,!0,v!=="rectangle");if(v==="rectangle"){v="rect";var E=b._size,S=E.width,M=E.height;L.x-=S/2,L.y-=M/2,L.width=S,L.height=M,x.isZero()&&(x=null)}return x&&(v==="circle"?L.r=x:(L.rx=x.width,L.ry=x.height)),Ut.create(v,L,t)}function c(b,v){var x=i(b._matrix),L=b.getPathData(null,v.precision);return L&&(x.d=L),Ut.create("path",x,t)}function f(b,v){var x=i(b._matrix,!0),L=b._definition,E=g(L,"symbol"),S=L._item,M=S.getStrokeBounds();return E||(E=Ut.create("symbol",{viewBox:t.rectangle(M)}),E.appendChild(O(S,v)),T(L,E,"symbol")),x.href="#"+E.id,x.x+=M.x,x.y+=M.y,x.width=M.width,x.height=M.height,x.overflow="visible",Ut.create("use",x,t)}function d(b){var v=g(b,"color");if(!v){var x=b.getGradient(),L=x._radial,E=b.getOrigin(),S=b.getDestination(),M;if(L){M={cx:E.x,cy:E.y,r:E.getDistance(S)};var X=b.getHighlight();X&&(M.fx=X.x,M.fy=X.y)}else M={x1:E.x,y1:E.y,x2:S.x,y2:S.y};M.gradientUnits="userSpaceOnUse",v=Ut.create((L?"radial":"linear")+"Gradient",M,t);for(var k=x._stops,V=0,D=k.length;V<D;V++){var z=k[V],q=z._color,H=q.getAlpha(),U=z._offset;M={offset:U??V/(D-1)},q&&(M["stop-color"]=q.toCSS(!0)),H<1&&(M["stop-opacity"]=H),v.appendChild(Ut.create("stop",M,t))}T(b,v,"color")}return"url(#"+v.id+")"}function p(b){var v=Ut.create("text",i(b._matrix,!0),t);return v.textContent=b._content,v}var y={Group:n,Layer:n,Raster:s,Path:u,Shape:l,CompoundPath:c,SymbolItem:f,PointText:p};function P(b,v,x,L){var E={},S=!L&&b.getParent(),M=[];return b._name!=null&&(E.id=b._name),A.each(ci,function(X){var k=X.get,V=X.type,D=b[k]();if(X.exportFilter?X.exportFilter(b,D):x.reduceAttributes==!1||!S||!A.equals(S[k](),D)){if(V==="color"&&D!=null){var z=D.getAlpha();z<1&&(E[X.attribute+"-opacity"]=z)}V==="style"?M.push(X.attribute+": "+D):E[X.attribute]=D==null?"none":V==="color"?D.gradient?d(D):D.toCSS(!0):V==="array"?D.join(","):V==="lookup"?X.toSVG[D]:D}}),M.length&&(E.style=M.join(";")),E.opacity===1&&delete E.opacity,b._visible||(E.visibility="hidden"),Ut.set(v,E,t)}var m;function g(b,v){return m||(m={ids:{},svgs:{}}),b&&m.svgs[v+"-"+(b._id||b.__id||(b.__id=we.get("svg")))]}function T(b,v,x){m||g();var L=m.ids[x]=(m.ids[x]||0)+1;v.id=x+"-"+L,m.svgs[x+"-"+(b._id||b.__id)]=v}function w(b,v){var x=b,L=null;if(m){x=b.nodeName.toLowerCase()==="svg"&&b;for(var E in m.svgs)L||(x||(x=Ut.create("svg"),x.appendChild(b)),L=x.insertBefore(Ut.create("defs"),x.firstChild)),L.appendChild(m.svgs[E]);m=null}return v.asString?new a.XMLSerializer().serializeToString(x):x}function O(b,v,x){var L=y[b._class],E=L&&L(b,v);if(E){var S=v.onExport;S&&(E=S(b,E,v)||E);var M=JSON.stringify(b._data);M&&M!=="{}"&&M!=="null"&&E.setAttribute("data-paper-data",M)}return E&&P(b,E,v,x)}function C(b){return b||(b={}),t=new he(b.precision),b}At.inject({exportSVG:function(b){return b=C(b),w(O(this,b,!0),b)}}),ye.inject({exportSVG:function(b){b=C(b);var v=this._children,x=this.getView(),L=A.pick(b.bounds,"view"),E=b.matrix||L==="view"&&x._matrix,S=E&&Vt.read([E]),M=L==="view"?new Ct([0,0],x.getViewSize()):L==="content"?At._getBounds(v,S,{stroke:!0}).rect:Ct.read([L],0,{readNull:!0}),X={version:"1.1",xmlns:Ut.svg,"xmlns:xlink":Ut.xlink};M&&(X.width=M.width,X.height=M.height,(M.x||M.x===0||M.y||M.y===0)&&(X.viewBox=t.rectangle(M)));var k=Ut.create("svg",X,t),V=k;S&&!S.isIdentity()&&(V=k.appendChild(Ut.create("g",i(S),t)));for(var D=0,z=v.length;D<z;D++)V.appendChild(O(v[D],b,!0));return w(k,b)}})},new function(){var t={},i;function n(v,x,L,E,S,M){var X=Ut.get(v,x)||M,k=X==null?E?null:L?"":0:L?X:parseFloat(X);return/%\s*$/.test(X)?k/100*(S?1:i[/x|^width/.test(x)?"width":"height"]):k}function s(v,x,L,E,S,M,X){return x=n(v,x||"x",!1,E,S,M),L=n(v,L||"y",!1,E,S,X),E&&(x==null||L==null)?null:new Z(x,L)}function u(v,x,L,E,S){return x=n(v,x||"width",!1,E,S),L=n(v,L||"height",!1,E,S),E&&(x==null||L==null)?null:new _t(x,L)}function l(v,x,L){return v==="none"?null:x==="number"?parseFloat(v):x==="array"?v?v.split(/[\s,]+/g).map(parseFloat):[]:x==="color"?O(v)||v:x==="lookup"?L[v]:v}function c(v,x,L,E){var S=v.childNodes,M=x==="clippath",X=x==="defs",k=new Se,V=k._project,D=V._currentStyle,z=[];if(!M&&!X&&(k=w(k,v,E),V._currentStyle=k._style.clone()),E)for(var q=v.querySelectorAll("defs"),H=0,U=q.length;H<U;H++)C(q[H],L,!1);for(var H=0,U=S.length;H<U;H++){var j=S[H],rt;j.nodeType===1&&!/^defs$/i.test(j.nodeName)&&(rt=C(j,L,!1))&&!(rt instanceof Pe)&&z.push(rt)}return k.addChildren(z),M&&(k=w(k.reduce(),v,E)),V._currentStyle=D,(M||X)&&(k.remove(),k=null),k}function f(v,x){for(var L=v.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),E=[],S=0,M=L.length;S<M;S+=2)E.push(new Z(parseFloat(L[S]),parseFloat(L[S+1])));var X=new Xt(E);return x==="polygon"&&X.closePath(),X}function d(v){return Xe.create(v.getAttribute("d"))}function p(v,x){var L=(n(v,"href",!0)||"").substring(1),E=x==="radialgradient",S;if(L)S=t[L].getGradient(),S._radial^E&&(S=S.clone(),S._radial=E);else{for(var M=v.childNodes,X=[],k=0,V=M.length;k<V;k++){var D=M[k];D.nodeType===1&&X.push(w(new $e,D))}S=new He(X,E)}var z,q,H,U=n(v,"gradientUnits",!0)!=="userSpaceOnUse";E?(z=s(v,"cx","cy",!1,U,"50%","50%"),q=z.add(n(v,"r",!1,!1,U,"50%"),0),H=s(v,"fx","fy",!0,U)):(z=s(v,"x1","y1",!1,U,"0%","0%"),q=s(v,"x2","y2",!1,U,"100%","0%"));var j=w(new Kt(S,z,q,H),v);return j._scaleToBounds=U,null}var y={"#document":function(v,x,L,E){for(var S=v.childNodes,M=0,X=S.length;M<X;M++){var k=S[M];if(k.nodeType===1)return C(k,L,E)}},g:c,svg:c,clippath:c,polygon:f,polyline:f,path:d,lineargradient:p,radialgradient:p,image:function(v){var x=new ze(n(v,"href",!0));return x.on("load",function(){var L=u(v);this.setSize(L);var E=s(v).add(L.divide(2));this._matrix.append(new Vt().translate(E))}),x},symbol:function(v,x,L,E){return new Pe(c(v,x,L,E),!0)},defs:c,use:function(v){var x=(n(v,"href",!0)||"").substring(1),L=t[x],E=s(v);return L?L instanceof Pe?L.place(E):L.clone().translate(E):null},circle:function(v){return new de.Circle(s(v,"cx","cy"),n(v,"r"))},ellipse:function(v){return new de.Ellipse({center:s(v,"cx","cy"),radius:u(v,"rx","ry")})},rect:function(v){return new de.Rectangle(new Ct(s(v),u(v)),u(v,"rx","ry"))},line:function(v){return new Xt.Line(s(v,"x1","y1"),s(v,"x2","y2"))},text:function(v){var x=new xi(s(v).add(s(v,"dx","dy")));return x.setContent(v.textContent.trim()||""),x},switch:c};function P(v,x,L,E){if(v.transform){for(var S=(E.getAttribute(L)||"").split(/\)\s*/g),M=new Vt,X=0,k=S.length;X<k;X++){var V=S[X];if(!V)break;for(var D=V.split(/\(\s*/),z=D[0].trim(),q=D[1].split(/[\s,]+/g),H=0,U=q.length;H<U;H++)q[H]=parseFloat(q[H]);switch(z){case"matrix":M.append(new Vt(q[0],q[1],q[2],q[3],q[4],q[5]));break;case"rotate":M.rotate(q[0],q[1]||0,q[2]||0);break;case"translate":M.translate(q[0],q[1]||0);break;case"scale":M.scale(q);break;case"skewX":M.skew(q[0],0);break;case"skewY":M.skew(0,q[0]);break}}v.transform(M)}}function m(v,x,L){var E=L==="fill-opacity"?"getFillColor":"getStrokeColor",S=v[E]&&v[E]();S&&S.setAlpha(parseFloat(x))}var g=A.set(A.each(ci,function(v){this[v.attribute]=function(x,L){if(x[v.set]&&(x[v.set](l(L,v.type,v.fromSVG)),v.type==="color")){var E=x[v.get]();if(E&&E._scaleToBounds){var S=x.getBounds();E.transform(new Vt().translate(S.getPoint()).scale(S.getSize()))}}}},{}),{id:function(v,x){t[x]=v,v.setName&&v.setName(x)},"clip-path":function(v,x){var L=O(x);if(L)if(L=L.clone(),L.setClipMask(!0),v instanceof Se)v.insertChild(0,L);else return new Se(L,v)},gradientTransform:P,transform:P,"fill-opacity":m,"stroke-opacity":m,visibility:function(v,x){v.setVisible&&v.setVisible(x==="visible")},display:function(v,x){v.setVisible&&v.setVisible(x!==null)},"stop-color":function(v,x){v.setColor&&v.setColor(x)},"stop-opacity":function(v,x){v._color&&v._color.setAlpha(parseFloat(x))},offset:function(v,x){if(v.setOffset){var L=x.match(/(.*)%$/);v.setOffset(L?L[1]/100:parseFloat(x))}},viewBox:function(v,x,L,E,S){var M=new Ct(l(x,"array")),X=u(E,null,null,!0),k,V;if(v instanceof Se){var D=X?X.divide(M.getSize()):1,V=new Vt().scale(D).translate(M.getPoint().negate());k=v}else v instanceof Pe&&(X&&M.setSize(X),k=v._item);if(k){if(T(E,"overflow",S)!=="visible"){var z=new de.Rectangle(M);z.setClipMask(!0),k.addChild(z)}V&&k.transform(V)}}});function T(v,x,L){var E=v.attributes[x],S=E&&E.value;if(!S&&v.style){var M=A.camelize(x);S=v.style[M],!S&&L.node[M]!==L.parent[M]&&(S=L.node[M])}return S?S==="none"?null:S:B}function w(v,x,L){var E=x.parentNode,S={node:Ht.getStyles(x)||{},parent:!L&&!/^defs$/i.test(E.tagName)&&Ht.getStyles(E)||{}};return A.each(g,function(M,X){var k=T(x,X,S);v=k!==B&&M(v,k,X,x,S)||v}),v}function O(v){var x=v&&v.match(/\((?:["'#]*)([^"')]+)/),L=x&&x[1],E=L&&t[J?L.replace(J.location.href.split("#")[0]+"#",""):L];return E&&E._scaleToBounds&&(E=E.clone(),E._scaleToBounds=!0),E}function C(v,x,L){var E=v.nodeName.toLowerCase(),S=E!=="#document",M=G.body,X,k,V;L&&S&&(i=Mt.getView().getSize(),i=u(v,null,null,!0)||i,X=Ut.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),k=v.parentNode,V=v.nextSibling,X.appendChild(v),M.appendChild(X));var D=Mt.settings,z=D.applyMatrix,q=D.insertItems;D.applyMatrix=!1,D.insertItems=!1;var H=y[E],U=H&&H(v,E,x,L)||null;if(D.insertItems=q,D.applyMatrix=z,U){S&&!(U instanceof Se)&&(U=w(U,v,L));var j=x.onImport,rt=S&&v.getAttribute("data-paper-data");j&&(U=j(v,U,x)||U),x.expandShapes&&U instanceof de&&(U.remove(),U=U.toPath()),rt&&(U._data=JSON.parse(rt))}return X&&(M.removeChild(X),k&&(V?k.insertBefore(v,V):k.appendChild(v))),L&&(t={},U&&A.pick(x.applyMatrix,z)&&U.matrix.apply(!0,!0)),U}function b(v,x,L){if(!v)return null;x=typeof x=="function"?{onLoad:x}:x||{};var E=Mt,S=null;function M(D){try{var z=typeof D=="object"?D:new a.DOMParser().parseFromString(D.trim(),"image/svg+xml");if(!z.nodeName)throw z=null,new Error("Unsupported SVG source: "+v);Mt=E,S=C(z,x,!0),(!x||x.insert!==!1)&&L._insertItem(B,S);var q=x.onLoad;q&&q(S,D)}catch(H){X(H)}}function X(D,z){var q=x.onError;if(q)q(D,z);else throw new Error(D)}if(typeof v=="string"&&!/^[\s\S]*</.test(v)){var k=G.getElementById(v);k?M(k):fi.request({url:v,async:!0,onLoad:M,onError:X})}else if(typeof File<"u"&&v instanceof File){var V=new FileReader;return V.onload=function(){M(V.result)},V.onerror=function(){X(V.error)},V.readAsText(v)}else M(v);return S}At.inject({importSVG:function(v,x){return b(v,x,this)}}),ye.inject({importSVG:function(v,x){return this.activate(),b(v,x,this)}})},A.exports.PaperScript=(function(){var t=this,i=t.acorn;if(!i&&typeof jn<"u")try{i=require("acorn")}catch{}if(!i){var n,s;i=n=s={},(function(w,O){if(typeof n=="object"&&typeof s=="object")return O(n);if(typeof B=="function"&&B.amd)return B(["exports"],O);O(w.acorn||(w.acorn={}))})(this,function(w){w.version="0.5.0";var O,C,b,v;w.parse=function(Y,W){return C=String(Y),b=C.length,L(W),Ki(),zn(O.program)};var x=w.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function L(Y){O=Y||{};for(var W in x)Object.prototype.hasOwnProperty.call(O,W)||(O[W]=x[W]);v=O.sourceFile||null}var E=w.getLineInfo=function(Y,W){for(var Q=1,nt=0;;){Ge.lastIndex=nt;var xt=Ge.exec(Y);if(xt&&xt.index<W)++Q,nt=xt.index+xt[0].length;else break}return{line:Q,column:W-nt}};w.tokenize=function(Y,W){C=String(Y),b=C.length,L(W),Ki();var Q={};function nt(xt){return rt=X,qe(xt),Q.start=M,Q.end=X,Q.startLoc=k,Q.endLoc=V,Q.type=D,Q.value=z,Q}return nt.jumpTo=function(xt,Ot){if(S=xt,O.locations){H=1,U=Ge.lastIndex=0;for(var Lt;(Lt=Ge.exec(C))&&Lt.index<xt;)++H,U=Lt.index+Lt[0].length}q=Ot,Je()},nt};var S,M,X,k,V,D,z,q,H,U,j,rt,at,ut,ft,tt;function it(Y,W){var Q=E(C,Y);W+=" ("+Q.line+":"+Q.column+")";var nt=new SyntaxError(W);throw nt.pos=Y,nt.loc=Q,nt.raisedAt=S,nt}var lt=[],dt={type:"num"},ct={type:"regexp"},Pt={type:"string"},gt={type:"name"},It={type:"eof"},Et={keyword:"break"},bt={keyword:"case",beforeExpr:!0},$t={keyword:"catch"},te={keyword:"continue"},ne={keyword:"debugger"},Gt={keyword:"default"},Ft={keyword:"do",isLoop:!0},Jt={keyword:"else",beforeExpr:!0},zt={keyword:"finally"},ee={keyword:"for",isLoop:!0},_e={keyword:"function"},Ee={keyword:"if"},wt={keyword:"return",beforeExpr:!0},ve={keyword:"switch"},fe={keyword:"throw",beforeExpr:!0},pe={keyword:"try"},Ae={keyword:"var"},Ce={keyword:"while",isLoop:!0},e={keyword:"with"},r={keyword:"new",beforeExpr:!0},o={keyword:"this"},h={keyword:"null",atomValue:null},_={keyword:"true",atomValue:!0},I={keyword:"false",atomValue:!1},N={keyword:"in",binop:7,beforeExpr:!0},F={break:Et,case:bt,catch:$t,continue:te,debugger:ne,default:Gt,do:Ft,else:Jt,finally:zt,for:ee,function:_e,if:Ee,return:wt,switch:ve,throw:fe,try:pe,var:Ae,while:Ce,with:e,null:h,true:_,false:I,new:r,in:N,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:o,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},R={type:"[",beforeExpr:!0},K={type:"]"},st={type:"{",beforeExpr:!0},et={type:"}"},ot={type:"(",beforeExpr:!0},vt={type:")"},St={type:",",beforeExpr:!0},Tt={type:";",beforeExpr:!0},kt={type:":",beforeExpr:!0},ae={type:"."},ge={type:"?",beforeExpr:!0},Ne={binop:10,beforeExpr:!0},ii={isAssign:!0,beforeExpr:!0},Be={isAssign:!0,beforeExpr:!0},ke={postfix:!0,prefix:!0,isUpdate:!0},qi={prefix:!0,beforeExpr:!0},Wi={binop:1,beforeExpr:!0},Zi={binop:2,beforeExpr:!0},_n={binop:3,beforeExpr:!0},vn={binop:4,beforeExpr:!0},gn={binop:5,beforeExpr:!0},mn={binop:6,beforeExpr:!0},yn={binop:7,beforeExpr:!0},Pn={binop:8,beforeExpr:!0},Cn={binop:9,prefix:!0,beforeExpr:!0},wn={binop:10,beforeExpr:!0};w.tokTypes={bracketL:R,bracketR:K,braceL:st,braceR:et,parenL:ot,parenR:vt,comma:St,semi:Tt,colon:kt,dot:ae,question:ge,slash:Ne,eq:ii,name:gt,eof:It,num:dt,regexp:ct,string:Pt};for(var Hi in F)w.tokTypes["_"+Hi]=F[Hi];function ni(Y){Y=Y.split(" ");var W="",Q=[];t:for(var nt=0;nt<Y.length;++nt){for(var xt=0;xt<Q.length;++xt)if(Q[xt][0].length==Y[nt].length){Q[xt].push(Y[nt]);continue t}Q.push([Y[nt]])}function Ot(Rt){if(Rt.length==1)return W+="return str === "+JSON.stringify(Rt[0])+";";W+="switch(str){";for(var Le=0;Le<Rt.length;++Le)W+="case "+JSON.stringify(Rt[Le])+":";W+="return true}return false;"}if(Q.length>3){Q.sort(function(Rt,Le){return Le.length-Rt.length}),W+="switch(str.length){";for(var nt=0;nt<Q.length;++nt){var Lt=Q[nt];W+="case "+Lt[0].length+":",Ot(Lt)}W+="}"}else Ot(Y);return new Function("str",W)}var xn=ni("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),bn=ni("class enum extends super const export import"),Ui=ni("implements interface let package private protected public static yield"),di=ni("eval arguments"),In=ni("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Sn=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Gi="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Tn="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Ji=new RegExp("["+Gi+"]"),On=new RegExp("["+Gi+Tn+"]"),pi=/[\n\r\u2028\u2029]/,Ge=/\r\n|[\n\r\u2028\u2029]/g,_i=w.isIdentifierStart=function(Y){return Y<65?Y===36:Y<91?!0:Y<97?Y===95:Y<123?!0:Y>=170&&Ji.test(String.fromCharCode(Y))},ji=w.isIdentifierChar=function(Y){return Y<48?Y===36:Y<58?!0:Y<65?!1:Y<91?!0:Y<97?Y===95:Y<123?!0:Y>=170&&On.test(String.fromCharCode(Y))};function Ve(){this.line=H,this.column=S-U}function Ki(){H=1,S=U=0,q=!0,Je()}function oe(Y,W){X=S,O.locations&&(V=new Ve),D=Y,Je(),z=W,q=Y.beforeExpr}function Ln(){var Y=O.onComment&&O.locations&&new Ve,W=S,Q=C.indexOf("*/",S+=2);if(Q===-1&&it(S-2,"Unterminated comment"),S=Q+2,O.locations){Ge.lastIndex=W;for(var nt;(nt=Ge.exec(C))&&nt.index<S;)++H,U=nt.index+nt[0].length}O.onComment&&O.onComment(!0,C.slice(W+2,Q),W,S,Y,O.locations&&new Ve)}function Ei(){for(var Y=S,W=O.onComment&&O.locations&&new Ve,Q=C.charCodeAt(S+=2);S<b&&Q!==10&&Q!==13&&Q!==8232&&Q!==8233;)++S,Q=C.charCodeAt(S);O.onComment&&O.onComment(!1,C.slice(Y+2,S),Y,S,W,O.locations&&new Ve)}function Je(){for(;S<b;){var Y=C.charCodeAt(S);if(Y===32)++S;else if(Y===13){++S;var W=C.charCodeAt(S);W===10&&++S,O.locations&&(++H,U=S)}else if(Y===10||Y===8232||Y===8233)++S,O.locations&&(++H,U=S);else if(Y>8&&Y<14)++S;else if(Y===47){var W=C.charCodeAt(S+1);if(W===42)Ln();else if(W===47)Ei();else break}else if(Y===160)++S;else if(Y>=5760&&Sn.test(String.fromCharCode(Y)))++S;else break}}function En(){var Y=C.charCodeAt(S+1);return Y>=48&&Y<=57?$i(!0):(++S,oe(ae))}function An(){var Y=C.charCodeAt(S+1);return q?(++S,Qi()):Y===61?ue(Be,2):ue(Ne,1)}function Nn(){var Y=C.charCodeAt(S+1);return Y===61?ue(Be,2):ue(wn,1)}function Mn(Y){var W=C.charCodeAt(S+1);return W===Y?ue(Y===124?Wi:Zi,2):W===61?ue(Be,2):ue(Y===124?_n:gn,1)}function Bn(){var Y=C.charCodeAt(S+1);return Y===61?ue(Be,2):ue(vn,1)}function Dn(Y){var W=C.charCodeAt(S+1);return W===Y?W==45&&C.charCodeAt(S+2)==62&&pi.test(C.slice(rt,S))?(S+=3,Ei(),Je(),qe()):ue(ke,2):W===61?ue(Be,2):ue(Cn,1)}function Xn(Y){var W=C.charCodeAt(S+1),Q=1;return W===Y?(Q=Y===62&&C.charCodeAt(S+2)===62?3:2,C.charCodeAt(S+Q)===61?ue(Be,Q+1):ue(Pn,Q)):W==33&&Y==60&&C.charCodeAt(S+2)==45&&C.charCodeAt(S+3)==45?(S+=4,Ei(),Je(),qe()):(W===61&&(Q=C.charCodeAt(S+2)===61?3:2),ue(yn,Q))}function kn(Y){var W=C.charCodeAt(S+1);return W===61?ue(mn,C.charCodeAt(S+2)===61?3:2):ue(Y===61?ii:qi,1)}function Yn(Y){switch(Y){case 46:return En();case 40:return++S,oe(ot);case 41:return++S,oe(vt);case 59:return++S,oe(Tt);case 44:return++S,oe(St);case 91:return++S,oe(R);case 93:return++S,oe(K);case 123:return++S,oe(st);case 125:return++S,oe(et);case 58:return++S,oe(kt);case 63:return++S,oe(ge);case 48:var W=C.charCodeAt(S+1);if(W===120||W===88)return Fn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return $i(!1);case 34:case 39:return Rn(Y);case 47:return An();case 37:case 42:return Nn();case 124:case 38:return Mn(Y);case 94:return Bn();case 43:case 45:return Dn(Y);case 60:case 62:return Xn(Y);case 61:case 33:return kn(Y);case 126:return ue(qi,1)}return!1}function qe(Y){if(Y?S=M+1:M=S,O.locations&&(k=new Ve),Y)return Qi();if(S>=b)return oe(It);var W=C.charCodeAt(S);if(_i(W)||W===92)return en();var Q=Yn(W);if(Q===!1){var nt=String.fromCharCode(W);if(nt==="\\"||Ji.test(nt))return en();it(S,"Unexpected character '"+nt+"'")}return Q}function ue(Y,W){var Q=C.slice(S,S+W);S+=W,oe(Y,Q)}function Qi(){for(var xt="",Y,W,Q=S;;){S>=b&&it(Q,"Unterminated regular expression");var nt=C.charAt(S);if(pi.test(nt)&&it(Q,"Unterminated regular expression"),Y)Y=!1;else{if(nt==="[")W=!0;else if(nt==="]"&&W)W=!1;else if(nt==="/"&&!W)break;Y=nt==="\\"}++S}var xt=C.slice(Q,S);++S;var Ot=tn();Ot&&!/^[gmsiy]*$/.test(Ot)&&it(Q,"Invalid regexp flag");try{var Lt=new RegExp(xt,Ot)}catch(Rt){Rt instanceof SyntaxError&&it(Q,Rt.message),it(Rt)}return oe(ct,Lt)}function ri(Y,W){for(var Q=S,nt=0,xt=0,Ot=W??1/0;xt<Ot;++xt){var Lt=C.charCodeAt(S),Rt;if(Lt>=97?Rt=Lt-97+10:Lt>=65?Rt=Lt-65+10:Lt>=48&&Lt<=57?Rt=Lt-48:Rt=1/0,Rt>=Y)break;++S,nt=nt*Y+Rt}return S===Q||W!=null&&S-Q!==W?null:nt}function Fn(){S+=2;var Y=ri(16);return Y==null&&it(M+2,"Expected hexadecimal number"),_i(C.charCodeAt(S))&&it(S,"Identifier directly after number"),oe(dt,Y)}function $i(Y){var W=S,Q=!1,nt=C.charCodeAt(S)===48;!Y&&ri(10)===null&&it(W,"Invalid number"),C.charCodeAt(S)===46&&(++S,ri(10),Q=!0);var xt=C.charCodeAt(S);(xt===69||xt===101)&&(xt=C.charCodeAt(++S),(xt===43||xt===45)&&++S,ri(10)===null&&it(W,"Invalid number"),Q=!0),_i(C.charCodeAt(S))&&it(S,"Identifier directly after number");var Ot=C.slice(W,S),Lt;return Q?Lt=parseFloat(Ot):!nt||Ot.length===1?Lt=parseInt(Ot,10):/[89]/.test(Ot)||tt?it(W,"Invalid number"):Lt=parseInt(Ot,8),oe(dt,Lt)}function Rn(Y){S++;for(var W="";;){S>=b&&it(M,"Unterminated string constant");var Q=C.charCodeAt(S);if(Q===Y)return++S,oe(Pt,W);if(Q===92){Q=C.charCodeAt(++S);var nt=/^[0-7]+/.exec(C.slice(S,S+3));for(nt&&(nt=nt[0]);nt&&parseInt(nt,8)>255;)nt=nt.slice(0,-1);if(nt==="0"&&(nt=null),++S,nt)tt&&it(S-2,"Octal literal in strict mode"),W+=String.fromCharCode(parseInt(nt,8)),S+=nt.length-1;else switch(Q){case 110:W+=`
`;break;case 114:W+="\r";break;case 120:W+=String.fromCharCode(vi(2));break;case 117:W+=String.fromCharCode(vi(4));break;case 85:W+=String.fromCharCode(vi(8));break;case 116:W+="	";break;case 98:W+="\b";break;case 118:W+="\v";break;case 102:W+="\f";break;case 48:W+="\0";break;case 13:C.charCodeAt(S)===10&&++S;case 10:O.locations&&(U=S,++H);break;default:W+=String.fromCharCode(Q);break}}else(Q===13||Q===10||Q===8232||Q===8233)&&it(M,"Unterminated string constant"),W+=String.fromCharCode(Q),++S}}function vi(Y){var W=ri(16,Y);return W===null&&it(M,"Bad character escape sequence"),W}var je;function tn(){je=!1;for(var Y,W=!0,Q=S;;){var nt=C.charCodeAt(S);if(ji(nt))je&&(Y+=C.charAt(S)),++S;else if(nt===92){je||(Y=C.slice(Q,S)),je=!0,C.charCodeAt(++S)!=117&&it(S,"Expecting Unicode escape sequence \\uXXXX"),++S;var xt=vi(4),Ot=String.fromCharCode(xt);Ot||it(S-1,"Invalid Unicode escape"),(W?_i(xt):ji(xt))||it(S-4,"Invalid Unicode escape"),Y+=Ot}else break;W=!1}return je?Y:C.slice(Q,S)}function en(){var Y=tn(),W=gt;return!je&&In(Y)&&(W=F[Y]),oe(W,Y)}function Yt(){j=M,rt=X,at=V,qe()}function Ai(Y){if(tt=Y,S=M,O.locations)for(;S<U;)U=C.lastIndexOf(`
`,U-2)+1,--H;Je(),qe()}function nn(){this.type=null,this.start=M,this.end=null}function rn(){this.start=k,this.end=null,v!==null&&(this.source=v)}function le(){var Y=new nn;return O.locations&&(Y.loc=new rn),O.directSourceFile&&(Y.sourceFile=O.directSourceFile),O.ranges&&(Y.range=[M,0]),Y}function Ye(Y){var W=new nn;return W.start=Y.start,O.locations&&(W.loc=new rn,W.loc.start=Y.loc.start),O.ranges&&(W.range=[Y.range[0],0]),W}function Bt(Y,W){return Y.type=W,Y.end=rt,O.locations&&(Y.loc.end=at),O.ranges&&(Y.range[1]=rt),Y}function Ni(Y){return O.ecmaVersion>=5&&Y.type==="ExpressionStatement"&&Y.expression.type==="Literal"&&Y.expression.value==="use strict"}function jt(Y){if(D===Y)return Yt(),!0}function gi(){return!O.strictSemicolons&&(D===It||D===et||pi.test(C.slice(rt,M)))}function We(){!jt(Tt)&&!gi()&&De()}function ie(Y){D===Y?Yt():De()}function De(){it(M,"Unexpected token")}function mi(Y){Y.type!=="Identifier"&&Y.type!=="MemberExpression"&&it(Y.start,"Assigning to rvalue"),tt&&Y.type==="Identifier"&&di(Y.name)&&it(Y.start,"Assigning to "+Y.name+" in strict mode")}function zn(Y){j=rt=S,O.locations&&(at=new Ve),ut=tt=null,ft=[],qe();var W=Y||le(),Q=!0;for(Y||(W.body=[]);D!==It;){var nt=Oe();W.body.push(nt),Q&&Ni(nt)&&Ai(!0),Q=!1}return Bt(W,"Program")}var Mi={kind:"loop"},Vn={kind:"switch"};function Oe(){(D===Ne||D===Be&&z=="/=")&&qe(!0);var Y=D,W=le();switch(Y){case Et:case te:Yt();var Q=Y===Et;jt(Tt)||gi()?W.label=null:D!==gt?De():(W.label=Fe(),We());for(var nt=0;nt<ft.length;++nt){var xt=ft[nt];if((W.label==null||xt.name===W.label.name)&&(xt.kind!=null&&(Q||xt.kind==="loop")||W.label&&Q))break}return nt===ft.length&&it(W.start,"Unsyntactic "+Y.keyword),Bt(W,Q?"BreakStatement":"ContinueStatement");case ne:return Yt(),We(),Bt(W,"DebuggerStatement");case Ft:return Yt(),ft.push(Mi),W.body=Oe(),ft.pop(),ie(Ce),W.test=si(),We(),Bt(W,"DoWhileStatement");case ee:if(Yt(),ft.push(Mi),ie(ot),D===Tt)return Bi(W,null);if(D===Ae){var Ot=le();return Yt(),an(Ot,!0),Bt(Ot,"VariableDeclaration"),Ot.declarations.length===1&&jt(N)?sn(W,Ot):Bi(W,Ot)}var Ot=ce(!1,!0);return jt(N)?(mi(Ot),sn(W,Ot)):Bi(W,Ot);case _e:return Yt(),Fi(W,!0);case Ee:return Yt(),W.test=si(),W.consequent=Oe(),W.alternate=jt(Jt)?Oe():null,Bt(W,"IfStatement");case wt:return!ut&&!O.allowReturnOutsideFunction&&it(M,"'return' outside of function"),Yt(),jt(Tt)||gi()?W.argument=null:(W.argument=ce(),We()),Bt(W,"ReturnStatement");case ve:Yt(),W.discriminant=si(),W.cases=[],ie(st),ft.push(Vn);for(var Lt,Rt;D!=et;)if(D===bt||D===Gt){var Le=D===bt;Lt&&Bt(Lt,"SwitchCase"),W.cases.push(Lt=le()),Lt.consequent=[],Yt(),Le?Lt.test=ce():(Rt&&it(j,"Multiple default clauses"),Rt=!0,Lt.test=null),ie(kt)}else Lt||De(),Lt.consequent.push(Oe());return Lt&&Bt(Lt,"SwitchCase"),Yt(),ft.pop(),Bt(W,"SwitchStatement");case fe:return Yt(),pi.test(C.slice(rt,M))&&it(rt,"Illegal newline after throw"),W.argument=ce(),We(),Bt(W,"ThrowStatement");case pe:if(Yt(),W.block=ai(),W.handler=null,D===$t){var Ze=le();Yt(),ie(ot),Ze.param=Fe(),tt&&di(Ze.param.name)&&it(Ze.param.start,"Binding "+Ze.param.name+" in strict mode"),ie(vt),Ze.guard=null,Ze.body=ai(),W.handler=Bt(Ze,"CatchClause")}return W.guardedHandlers=lt,W.finalizer=jt(zt)?ai():null,!W.handler&&!W.finalizer&&it(W.start,"Missing catch or finally clause"),Bt(W,"TryStatement");case Ae:return Yt(),an(W),We(),Bt(W,"VariableDeclaration");case Ce:return Yt(),W.test=si(),ft.push(Mi),W.body=Oe(),ft.pop(),Bt(W,"WhileStatement");case e:return tt&&it(M,"'with' in strict mode"),Yt(),W.object=si(),W.body=Oe(),Bt(W,"WithStatement");case st:return ai();case Tt:return Yt(),Bt(W,"EmptyStatement");default:var zi=z,yi=ce();if(Y===gt&&yi.type==="Identifier"&&jt(kt)){for(var nt=0;nt<ft.length;++nt)ft[nt].name===zi&&it(yi.start,"Label '"+zi+"' is already declared");var Gn=D.isLoop?"loop":D===ve?"switch":null;return ft.push({name:zi,kind:Gn}),W.body=Oe(),ft.pop(),W.label=yi,Bt(W,"LabeledStatement")}else return W.expression=yi,We(),Bt(W,"ExpressionStatement")}}function si(){ie(ot);var Y=ce();return ie(vt),Y}function ai(Y){var W=le(),Q=!0,nt=!1,xt;for(W.body=[],ie(st);!jt(et);){var Ot=Oe();W.body.push(Ot),Q&&Y&&Ni(Ot)&&(xt=nt,Ai(nt=!0)),Q=!1}return nt&&!xt&&Ai(!1),Bt(W,"BlockStatement")}function Bi(Y,W){return Y.init=W,ie(Tt),Y.test=D===Tt?null:ce(),ie(Tt),Y.update=D===vt?null:ce(),ie(vt),Y.body=Oe(),ft.pop(),Bt(Y,"ForStatement")}function sn(Y,W){return Y.left=W,Y.right=ce(),ie(vt),Y.body=Oe(),ft.pop(),Bt(Y,"ForInStatement")}function an(Y,W){for(Y.declarations=[],Y.kind="var";;){var Q=le();if(Q.id=Fe(),tt&&di(Q.id.name)&&it(Q.id.start,"Binding "+Q.id.name+" in strict mode"),Q.init=jt(ii)?ce(!0,W):null,Y.declarations.push(Bt(Q,"VariableDeclarator")),!jt(St))break}return Y}function ce(Y,W){var Q=Di(W);if(!Y&&D===St){var nt=Ye(Q);for(nt.expressions=[Q];jt(St);)nt.expressions.push(Di(W));return Bt(nt,"SequenceExpression")}return Q}function Di(Y){var W=qn(Y);if(D.isAssign){var Q=Ye(W);return Q.operator=z,Q.left=W,Yt(),Q.right=Di(Y),mi(W),Bt(Q,"AssignmentExpression")}return W}function qn(Y){var W=Wn(Y);if(jt(ge)){var Q=Ye(W);return Q.test=W,Q.consequent=ce(!0),ie(kt),Q.alternate=ce(!0,Y),Bt(Q,"ConditionalExpression")}return W}function Wn(Y){return Xi(ki(),-1,Y)}function Xi(Y,W,Q){var nt=D.binop;if(nt!=null&&(!Q||D!==N)&&nt>W){var xt=Ye(Y);xt.left=Y,xt.operator=z;var Ot=D;Yt(),xt.right=Xi(ki(),nt,Q);var Lt=Bt(xt,Ot===Wi||Ot===Zi?"LogicalExpression":"BinaryExpression");return Xi(Lt,W,Q)}return Y}function ki(){if(D.prefix){var Y=le(),W=D.isUpdate;return Y.operator=z,Y.prefix=!0,q=!0,Yt(),Y.argument=ki(),W?mi(Y.argument):tt&&Y.operator==="delete"&&Y.argument.type==="Identifier"&&it(Y.start,"Deleting local variable in strict mode"),Bt(Y,W?"UpdateExpression":"UnaryExpression")}for(var Q=Zn();D.postfix&&!gi();){var Y=Ye(Q);Y.operator=z,Y.prefix=!1,Y.argument=Q,mi(Q),Yt(),Q=Bt(Y,"UpdateExpression")}return Q}function Zn(){return oi(Yi())}function oi(Y,W){if(jt(ae)){var Q=Ye(Y);return Q.object=Y,Q.property=Fe(!0),Q.computed=!1,oi(Bt(Q,"MemberExpression"),W)}else if(jt(R)){var Q=Ye(Y);return Q.object=Y,Q.property=ce(),Q.computed=!0,ie(K),oi(Bt(Q,"MemberExpression"),W)}else if(!W&&jt(ot)){var Q=Ye(Y);return Q.callee=Y,Q.arguments=Ri(vt,!1),oi(Bt(Q,"CallExpression"),W)}else return Y}function Yi(){switch(D){case o:var nt=le();return Yt(),Bt(nt,"ThisExpression");case gt:return Fe();case dt:case Pt:case ct:var nt=le();return nt.value=z,nt.raw=C.slice(M,X),Yt(),Bt(nt,"Literal");case h:case _:case I:var nt=le();return nt.value=D.atomValue,nt.raw=D.keyword,Yt(),Bt(nt,"Literal");case ot:var Y=k,W=M;Yt();var Q=ce();return Q.start=W,Q.end=X,O.locations&&(Q.loc.start=Y,Q.loc.end=V),O.ranges&&(Q.range=[W,X]),ie(vt),Q;case R:var nt=le();return Yt(),nt.elements=Ri(K,!0,!0),Bt(nt,"ArrayExpression");case st:return Un();case _e:var nt=le();return Yt(),Fi(nt,!1);case r:return Hn();default:De()}}function Hn(){var Y=le();return Yt(),Y.callee=oi(Yi(),!0),jt(ot)?Y.arguments=Ri(vt,!1):Y.arguments=lt,Bt(Y,"NewExpression")}function Un(){var Y=le(),W=!0,Q=!1;for(Y.properties=[],Yt();!jt(et);){if(W)W=!1;else if(ie(St),O.allowTrailingCommas&&jt(et))break;var nt={key:on()},xt=!1,Ot;if(jt(kt)?(nt.value=ce(!0),Ot=nt.kind="init"):O.ecmaVersion>=5&&nt.key.type==="Identifier"&&(nt.key.name==="get"||nt.key.name==="set")?(xt=Q=!0,Ot=nt.kind=nt.key.name,nt.key=on(),D!==ot&&De(),nt.value=Fi(le(),!1)):De(),nt.key.type==="Identifier"&&(tt||Q))for(var Lt=0;Lt<Y.properties.length;++Lt){var Rt=Y.properties[Lt];if(Rt.key.name===nt.key.name){var Le=Ot==Rt.kind||xt&&Rt.kind==="init"||Ot==="init"&&(Rt.kind==="get"||Rt.kind==="set");Le&&!tt&&Ot==="init"&&Rt.kind==="init"&&(Le=!1),Le&&it(nt.key.start,"Redefinition of property")}}Y.properties.push(nt)}return Bt(Y,"ObjectExpression")}function on(){return D===dt||D===Pt?Yi():Fe(!0)}function Fi(Y,W){D===gt?Y.id=Fe():W?De():Y.id=null,Y.params=[];var Q=!0;for(ie(ot);!jt(vt);)Q?Q=!1:ie(St),Y.params.push(Fe());var nt=ut,xt=ft;if(ut=!0,ft=[],Y.body=ai(!0),ut=nt,ft=xt,tt||Y.body.body.length&&Ni(Y.body.body[0]))for(var Ot=Y.id?-1:0;Ot<Y.params.length;++Ot){var Lt=Ot<0?Y.id:Y.params[Ot];if((Ui(Lt.name)||di(Lt.name))&&it(Lt.start,"Defining '"+Lt.name+"' in strict mode"),Ot>=0)for(var Rt=0;Rt<Ot;++Rt)Lt.name===Y.params[Rt].name&&it(Lt.start,"Argument name clash in strict mode")}return Bt(Y,W?"FunctionDeclaration":"FunctionExpression")}function Ri(Y,W,Q){for(var nt=[],xt=!0;!jt(Y);){if(xt)xt=!1;else if(ie(St),W&&O.allowTrailingCommas&&jt(Y))break;Q&&D===St?nt.push(null):nt.push(ce(!0))}return nt}function Fe(Y){var W=le();return Y&&O.forbidReserved=="everywhere"&&(Y=!1),D===gt?(!Y&&(O.forbidReserved&&(O.ecmaVersion===3?xn:bn)(z)||tt&&Ui(z))&&C.slice(M,X).indexOf("\\")==-1&&it(M,"The keyword '"+z+"' is reserved"),W.name=z):Y&&D.keyword?W.name=D.keyword:De(),q=!1,Yt(),Bt(W,"Identifier")}}),i.version||(i=null)}function u(w,O){return(t.acorn||i).parse(w,O)}var l={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},c={"-":"__negate","+":"__self"},f=A.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(w){this["__"+w]="#"+w},{__self:function(){return this}});Z.inject(f),_t.inject(f),Kt.inject(f);function d(w,O,C){var b=l[O];if(w&&w[b]){var v=w[b](C);return O==="!="?!v:v}switch(O){case"+":return w+C;case"-":return w-C;case"*":return w*C;case"/":return w/C;case"%":return w%C;case"==":return w==C;case"!=":return w!=C}}function p(w,O){var C=c[w];if(O&&O[C])return O[C]();switch(w){case"+":return+O;case"-":return-O}}function y(w,O){if(!w)return"";O=O||{};var C=[];function b(tt){for(var it=0,lt=C.length;it<lt;it++){var dt=C[it];if(dt[0]>=tt)break;tt+=dt[1]}return tt}function v(tt){return w.substring(b(tt.range[0]),b(tt.range[1]))}function x(tt,it){return w.substring(b(tt.range[1]),b(it.range[0]))}function L(tt,it){for(var lt=b(tt.range[0]),dt=b(tt.range[1]),ct=0,Pt=C.length-1;Pt>=0;Pt--)if(lt>C[Pt][0]){ct=Pt+1;break}C.splice(ct,0,[lt,it.length-dt+lt]),w=w.substring(0,lt)+it+w.substring(dt)}function E(tt,it){switch(tt.type){case"UnaryExpression":if(tt.operator in c&&tt.argument.type!=="Literal"){var lt=v(tt.argument);L(tt,'$__("'+tt.operator+'", '+lt+")")}break;case"BinaryExpression":if(tt.operator in l&&tt.left.type!=="Literal"){var dt=v(tt.left),ct=v(tt.right),Pt=x(tt.left,tt.right),gt=tt.operator;L(tt,"__$__("+dt+","+Pt.replace(new RegExp("\\"+gt),'"'+gt+'"')+", "+ct+")")}break;case"UpdateExpression":case"AssignmentExpression":var It=it&&it.type;if(!(It==="ForStatement"||It==="BinaryExpression"&&/^[=!<>]/.test(it.operator)||It==="MemberExpression"&&it.computed)){if(tt.type==="UpdateExpression"){var lt=v(tt.argument),Et="__$__("+lt+', "'+tt.operator[0]+'", 1)',bt=lt+" = "+Et;tt.prefix?bt="("+bt+")":(It==="AssignmentExpression"||It==="VariableDeclarator"||It==="BinaryExpression")&&(v(it.left||it.id)===lt&&(bt=Et),bt=lt+"; "+bt),L(tt,bt)}else if(/^.=$/.test(tt.operator)&&tt.left.type!=="Literal"){var dt=v(tt.left),ct=v(tt.right),Et=dt+" = __$__("+dt+', "'+tt.operator[0]+'", '+ct+")";L(tt,/^\(.*\)$/.test(v(tt))?"("+Et+")":Et)}}break}}function S(tt){switch(tt.type){case"ExportDefaultDeclaration":L({range:[tt.start,tt.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var it=tt.declaration,lt=tt.specifiers;if(it){var dt=it.declarations;dt&&(dt.forEach(function(Pt){L(Pt,"module.exports."+v(Pt))}),L({range:[tt.start,it.start+it.kind.length]},""))}else if(lt){var ct=lt.map(function(Pt){var gt=v(Pt);return"module.exports."+gt+" = "+gt+"; "}).join("");ct&&L(tt,ct)}break}}function M(tt,it,lt){if(tt){for(var dt in tt)if(dt!=="range"&&dt!=="loc"){var ct=tt[dt];if(Array.isArray(ct))for(var Pt=0,gt=ct.length;Pt<gt;Pt++)M(ct[Pt],tt,lt);else ct&&typeof ct=="object"&&M(ct,tt,lt)}lt.operatorOverloading!==!1&&E(tt,it),lt.moduleExports!==!1&&S(tt)}}function X(tt){var it="",lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(tt=(Math.abs(tt)<<1)+(tt<0?1:0);tt||!it;){var dt=tt&31;tt>>=5,tt&&(dt|=32),it+=lt[dt]}return it}var k=O.url||"",V=O.sourceMaps,D=O.paperFeatures||{},z=O.source||w,q=O.offset||0,H=Mt.agent,U=H.versionNumber,j=!1,rt=/\r\n|\n|\r/mg,at;if(V&&(H.chrome&&U>=30||H.webkit&&U>=537.76||H.firefox&&U>=23||H.node)){if(H.node)q-=2;else if(J&&k&&!J.location.href.indexOf(k)){var ut=G.getElementsByTagName("html")[0].innerHTML;q=ut.substr(0,ut.indexOf(w)+1).match(rt).length+1}j=q>0&&!(H.chrome&&U>=36||H.safari&&U>=600||H.firefox&&U>=40||H.node);var ft=["AA"+X(j?0:q)+"A"];ft.length=(w.match(rt)||[]).length+1+(j?q:0),at={version:3,file:k,names:[],mappings:ft.join(";AACA"),sourceRoot:"",sources:[k],sourcesContent:[z]}}return(D.operatorOverloading!==!1||D.moduleExports!==!1)&&M(u(w,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,D),at&&(j&&(w=new Array(q+1).join(`
`)+w),/^(inline|both)$/.test(V)&&(w+=`
//# sourceMappingURL=data:application/json;base64,`+a.btoa(unescape(encodeURIComponent(JSON.stringify(at))))),w+=`
//# sourceURL=`+(k||"paperscript")),{url:k,source:z,code:w,map:at}}function P(w,O,C){Mt=O;var b=O.getView(),v=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(w)&&!/\bnew\s+Tool\b/.test(w)?new Oi:null,x=v?v._events:[],L=["onFrame","onResize"].concat(x),E=[],S=[],M,X=typeof w=="object"?w:y(w,C);w=X.code;function k(U,j){for(var rt in U)(j||!/^_/.test(rt))&&new RegExp("([\\b\\s\\W]|^)"+rt.replace(/\$/g,"\\$")+"\\b").test(w)&&(E.push(rt),S.push(U[rt]))}k({__$__:d,$__:p,paper:O,tool:v},!0),k(O),w="var module = { exports: {} }; "+w;var q=A.each(L,function(U){new RegExp("\\s+"+U+"\\b").test(w)&&(E.push(U),this.push("module.exports."+U+" = "+U+";"))},[]).join(`
`);q&&(w+=`
`+q),w+=`
return module.exports;`;var V=Mt.agent;if(G&&(V.chrome||V.firefox&&V.versionNumber<40)){var D=G.createElement("script"),z=G.head||G.getElementsByTagName("head")[0];V.firefox&&(w=`
`+w),D.appendChild(G.createTextNode("document.__paperscript__ = function("+E+") {"+w+`
}`)),z.appendChild(D),M=G.__paperscript__,delete G.__paperscript__,z.removeChild(D)}else M=Function(E,w);var q=M&&M.apply(O,S),H=q||{};return A.each(x,function(U){var j=H[U];j&&(v[U]=j)}),b&&(H.onResize&&b.setOnResize(H.onResize),b.emit("resize",{size:b.size,delta:new Z}),H.onFrame&&b.setOnFrame(H.onFrame),b.requestUpdate()),q}function m(w){if(/^text\/(?:x-|)paperscript$/.test(w.type)&&$.getAttribute(w,"ignore")!=="true"){var O=$.getAttribute(w,"canvas"),C=G.getElementById(O),b=w.src||w.getAttribute("data-src"),v=$.hasAttribute(w,"async"),x="data-paper-scope";if(!C)throw new Error('Unable to find canvas with id "'+O+'"');var L=$.get(C.getAttribute(x))||new $().setup(C);return C.setAttribute(x,L._id),b?fi.request({url:b,async:v,mimeType:"text/plain",onLoad:function(E){P(E,L,b)}}):P(w.innerHTML,L,w.baseURI),w.setAttribute("data-paper-ignore","true"),L}}function g(){A.each(G&&G.getElementsByTagName("script"),m)}function T(w){return w?m(w):g()}return J&&(G.readyState==="complete"?setTimeout(g):Wt.add(J,{load:g})),{compile:y,execute:P,load:T,parse:u,calculateBinary:d,calculateUnary:p}}).call(this);var Mt=new($.inject(A.exports,{Base:A,Numerical:Dt,Key:hi,DomEvent:Wt,DomElement:Ht,document:G,window:J,Symbol:Pe,PlacedSymbol:Ke}));return Mt.agent.node&&un(Mt),typeof B=="function"&&B.amd?B("paper",Mt):qt&&(qt.exports=Mt),Mt}).call($n,typeof self=="object"?self:null)})(Ci)),Ci.exports}var er=tr();const Nt=fn(er);var Vi={exports:{}},hn;function ir(){return hn||(hn=1,(function(qt){(function(){var a={};a.version="6.4.2.2",a.use_lines=!0,a.use_xyz=!1;var B=!1;qt.exports?(qt.exports=a,B=!0):typeof document<"u"?window.ClipperLib=a:self.ClipperLib=a;var J;if(B){var G="chrome";J="Netscape"}else{var G=navigator.userAgent.toString().toLowerCase();J=navigator.appName}var A={};G.indexOf("chrome")!=-1&&G.indexOf("chromium")==-1?A.chrome=1:A.chrome=0,G.indexOf("chromium")!=-1?A.chromium=1:A.chromium=0,G.indexOf("safari")!=-1&&G.indexOf("chrome")==-1&&G.indexOf("chromium")==-1?A.safari=1:A.safari=0,G.indexOf("firefox")!=-1?A.firefox=1:A.firefox=0,G.indexOf("firefox/17")!=-1?A.firefox17=1:A.firefox17=0,G.indexOf("firefox/15")!=-1?A.firefox15=1:A.firefox15=0,G.indexOf("firefox/3")!=-1?A.firefox3=1:A.firefox3=0,G.indexOf("opera")!=-1?A.opera=1:A.opera=0,G.indexOf("msie 10")!=-1?A.msie10=1:A.msie10=0,G.indexOf("msie 9")!=-1?A.msie9=1:A.msie9=0,G.indexOf("msie 8")!=-1?A.msie8=1:A.msie8=0,G.indexOf("msie 7")!=-1?A.msie7=1:A.msie7=0,G.indexOf("msie ")!=-1?A.msie=1:A.msie=0,a.biginteger_used=null;var pt;function $(e,r,o){a.biginteger_used=1,e!=null&&(typeof e=="number"&&typeof r>"u"?this.fromInt(e):typeof e=="number"?this.fromNumber(e,r,o):r==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,r))}function mt(){return new $(null,void 0,void 0)}function Me(e,r,o,h,_,I){for(;--I>=0;){var N=r*this[e++]+o[h]+_;_=Math.floor(N/67108864),o[h++]=N&67108863}return _}function he(e,r,o,h,_,I){for(var N=r&32767,F=r>>15;--I>=0;){var R=this[e]&32767,K=this[e++]>>15,st=F*R+K*N;R=N*R+((st&32767)<<15)+o[h]+(_&1073741823),_=(R>>>30)+(st>>>15)+F*K+(_>>>30),o[h++]=R&1073741823}return _}function Dt(e,r,o,h,_,I){for(var N=r&16383,F=r>>14;--I>=0;){var R=this[e]&16383,K=this[e++]>>14,st=F*R+K*N;R=N*R+((st&16383)<<14)+o[h]+_,_=(R>>28)+(st>>14)+F*K,o[h++]=R&268435455}return _}J=="Microsoft Internet Explorer"?($.prototype.am=he,pt=30):J!="Netscape"?($.prototype.am=Me,pt=26):($.prototype.am=Dt,pt=28),$.prototype.DB=pt,$.prototype.DM=(1<<pt)-1,$.prototype.DV=1<<pt;var we=52;$.prototype.FV=Math.pow(2,we),$.prototype.F1=we-pt,$.prototype.F2=2*pt-we;var Z="0123456789abcdefghijklmnopqrstuvwxyz",me=new Array,_t,re;for(_t=48,re=0;re<=9;++re)me[_t++]=re;for(_t=97,re=10;re<36;++re)me[_t++]=re;for(_t=65,re=10;re<36;++re)me[_t++]=re;function Ct(e){return Z.charAt(e)}function ui(e,r){var o=me[e.charCodeAt(r)];return o??-1}function Vt(e){for(var r=this.t-1;r>=0;--r)e[r]=this[r];e.t=this.t,e.s=this.s}function se(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function ye(e){var r=mt();return r.fromInt(e),r}function At(e,r){var o;if(r==16)o=4;else if(r==8)o=3;else if(r==256)o=8;else if(r==2)o=1;else if(r==32)o=5;else if(r==4)o=2;else{this.fromRadix(e,r);return}this.t=0,this.s=0;for(var h=e.length,_=!1,I=0;--h>=0;){var N=o==8?e[h]&255:ui(e,h);if(N<0){e.charAt(h)=="-"&&(_=!0);continue}_=!1,I==0?this[this.t++]=N:I+o>this.DB?(this[this.t-1]|=(N&(1<<this.DB-I)-1)<<I,this[this.t++]=N>>this.DB-I):this[this.t-1]|=N<<I,I+=o,I>=this.DB&&(I-=this.DB)}o==8&&(e[0]&128)!=0&&(this.s=-1,I>0&&(this[this.t-1]|=(1<<this.DB-I)-1<<I)),this.clamp(),_&&$.ZERO.subTo(this,this)}function Se(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function Re(e){if(this.s<0)return"-"+this.negate().toString(e);var r;if(e==16)r=4;else if(e==8)r=3;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else return this.toRadix(e);var o=(1<<r)-1,h,_=!1,I="",N=this.t,F=this.DB-N*this.DB%r;if(N-- >0)for(F<this.DB&&(h=this[N]>>F)>0&&(_=!0,I=Ct(h));N>=0;)F<r?(h=(this[N]&(1<<F)-1)<<r-F,h|=this[--N]>>(F+=this.DB-r)):(h=this[N]>>(F-=r)&o,F<=0&&(F+=this.DB,--N)),h>0&&(_=!0),_&&(I+=Ct(h));return _?I:"0"}function de(){var e=mt();return $.ZERO.subTo(this,e),e}function ze(){return this.s<0?this.negate():this}function Ke(e){var r=this.s-e.s;if(r!=0)return r;var o=this.t;if(r=o-e.t,r!=0)return this.s<0?-r:r;for(;--o>=0;)if((r=this[o]-e[o])!=0)return r;return 0}function Pe(e){var r=1,o;return(o=e>>>16)!=0&&(e=o,r+=16),(o=e>>8)!=0&&(e=o,r+=8),(o=e>>4)!=0&&(e=o,r+=4),(o=e>>2)!=0&&(e=o,r+=2),(o=e>>1)!=0&&(e=o,r+=1),r}function Te(){return this.t<=0?0:this.DB*(this.t-1)+Pe(this[this.t-1]^this.s&this.DM)}function yt(e,r){var o;for(o=this.t-1;o>=0;--o)r[o+e]=this[o];for(o=e-1;o>=0;--o)r[o]=0;r.t=this.t+e,r.s=this.s}function Qe(e,r){for(var o=e;o<this.t;++o)r[o-e]=this[o];r.t=Math.max(this.t-e,0),r.s=this.s}function ht(e,r){var o=e%this.DB,h=this.DB-o,_=(1<<h)-1,I=Math.floor(e/this.DB),N=this.s<<o&this.DM,F;for(F=this.t-1;F>=0;--F)r[F+I+1]=this[F]>>h|N,N=(this[F]&_)<<o;for(F=I-1;F>=0;--F)r[F]=0;r[I]=N,r.t=this.t+I+1,r.s=this.s,r.clamp()}function xe(e,r){r.s=this.s;var o=Math.floor(e/this.DB);if(o>=this.t){r.t=0;return}var h=e%this.DB,_=this.DB-h,I=(1<<h)-1;r[0]=this[o]>>h;for(var N=o+1;N<this.t;++N)r[N-o-1]|=(this[N]&I)<<_,r[N-o]=this[N]>>h;h>0&&(r[this.t-o-1]|=(this.s&I)<<_),r.t=this.t-o,r.clamp()}function Xe(e,r){for(var o=0,h=0,_=Math.min(e.t,this.t);o<_;)h+=this[o]-e[o],r[o++]=h&this.DM,h>>=this.DB;if(e.t<this.t){for(h-=e.s;o<this.t;)h+=this[o],r[o++]=h&this.DM,h>>=this.DB;h+=this.s}else{for(h+=this.s;o<e.t;)h-=e[o],r[o++]=h&this.DM,h>>=this.DB;h-=e.s}r.s=h<0?-1:0,h<-1?r[o++]=this.DV+h:h>0&&(r[o++]=h),r.t=o,r.clamp()}function Xt(e,r){var o=this.abs(),h=e.abs(),_=o.t;for(r.t=_+h.t;--_>=0;)r[_]=0;for(_=0;_<h.t;++_)r[_+o.t]=o.am(0,h[_],r,_,0,o.t);r.s=0,r.clamp(),this.s!=e.s&&$.ZERO.subTo(r,r)}function be(e){for(var r=this.abs(),o=e.t=2*r.t;--o>=0;)e[o]=0;for(o=0;o<r.t-1;++o){var h=r.am(o,r[o],e,2*o,0,1);(e[o+r.t]+=r.am(o+1,2*r[o],e,2*o+1,h,r.t-o-1))>=r.DV&&(e[o+r.t]-=r.DV,e[o+r.t+1]=1)}e.t>0&&(e[e.t-1]+=r.am(o,r[o],e,2*o,0,1)),e.s=0,e.clamp()}function li(e,r,o){var h=e.abs();if(!(h.t<=0)){var _=this.abs();if(_.t<h.t){r?.fromInt(0),o!=null&&this.copyTo(o);return}o==null&&(o=mt());var I=mt(),N=this.s,F=e.s,R=this.DB-Pe(h[h.t-1]);R>0?(h.lShiftTo(R,I),_.lShiftTo(R,o)):(h.copyTo(I),_.copyTo(o));var K=I.t,st=I[K-1];if(st!=0){var et=st*(1<<this.F1)+(K>1?I[K-2]>>this.F2:0),ot=this.FV/et,vt=(1<<this.F1)/et,St=1<<this.F2,Tt=o.t,kt=Tt-K,ae=r??mt();for(I.dlShiftTo(kt,ae),o.compareTo(ae)>=0&&(o[o.t++]=1,o.subTo(ae,o)),$.ONE.dlShiftTo(K,ae),ae.subTo(I,I);I.t<K;)I[I.t++]=0;for(;--kt>=0;){var ge=o[--Tt]==st?this.DM:Math.floor(o[Tt]*ot+(o[Tt-1]+St)*vt);if((o[Tt]+=I.am(0,ge,o,kt,0,K))<ge)for(I.dlShiftTo(kt,ae),o.subTo(ae,o);o[Tt]<--ge;)o.subTo(ae,o)}r!=null&&(o.drShiftTo(K,r),N!=F&&$.ZERO.subTo(r,r)),o.t=K,o.clamp(),R>0&&o.rShiftTo(R,o),N<0&&$.ZERO.subTo(o,o)}}}function wi(e){var r=mt();return this.abs().divRemTo(e,null,r),this.s<0&&r.compareTo($.ZERO)>0&&e.subTo(r,r),r}function Ie(e){this.m=e}function xi(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Kt(e){return e}function He(e){e.divRemTo(this.m,null,e)}function $e(e,r,o){e.multiplyTo(r,o),this.reduce(o)}function ti(e,r){e.squareTo(r),this.reduce(r)}Ie.prototype.convert=xi,Ie.prototype.revert=Kt,Ie.prototype.reduce=He,Ie.prototype.mulTo=$e,Ie.prototype.sqrTo=ti;function Ht(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var r=e&3;return r=r*(2-(e&15)*r)&15,r=r*(2-(e&255)*r)&255,r=r*(2-((e&65535)*r&65535))&65535,r=r*(2-e*r%this.DV)%this.DV,r>0?this.DV-r:-r}function Wt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Zt(e){var r=mt();return e.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),e.s<0&&r.compareTo($.ZERO)>0&&this.m.subTo(r,r),r}function bi(e){var r=mt();return e.copyTo(r),this.reduce(r),r}function Ue(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var r=0;r<this.m.t;++r){var o=e[r]&32767,h=o*this.mpl+((o*this.mph+(e[r]>>15)*this.mpl&this.um)<<15)&e.DM;for(o=r+this.m.t,e[o]+=this.m.am(0,h,e,r,0,this.m.t);e[o]>=e.DV;)e[o]-=e.DV,e[++o]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Ii(e,r){e.squareTo(r),this.reduce(r)}function hi(e,r,o){e.multiplyTo(r,o),this.reduce(o)}Wt.prototype.convert=Zt,Wt.prototype.revert=bi,Wt.prototype.reduce=Ue,Wt.prototype.mulTo=hi,Wt.prototype.sqrTo=Ii;function Si(){return(this.t>0?this[0]&1:this.s)==0}function Ti(e,r){if(e>4294967295||e<1)return $.ONE;var o=mt(),h=mt(),_=r.convert(this),I=Pe(e)-1;for(_.copyTo(o);--I>=0;)if(r.sqrTo(o,h),(e&1<<I)>0)r.mulTo(h,_,o);else{var N=o;o=h,h=N}return r.revert(o)}function Oi(e,r){var o;return e<256||r.isEven()?o=new Ie(r):o=new Wt(r),this.exp(e,o)}$.prototype.copyTo=Vt,$.prototype.fromInt=se,$.prototype.fromString=At,$.prototype.clamp=Se,$.prototype.dlShiftTo=yt,$.prototype.drShiftTo=Qe,$.prototype.lShiftTo=ht,$.prototype.rShiftTo=xe,$.prototype.subTo=Xe,$.prototype.multiplyTo=Xt,$.prototype.squareTo=be,$.prototype.divRemTo=li,$.prototype.invDigit=Ht,$.prototype.isEven=Si,$.prototype.exp=Ti,$.prototype.toString=Re,$.prototype.negate=de,$.prototype.abs=ze,$.prototype.compareTo=Ke,$.prototype.bitLength=Te,$.prototype.mod=wi,$.prototype.modPowInt=Oi,$.ZERO=ye(0),$.ONE=ye(1);function Li(){var e=mt();return this.copyTo(e),e}function fi(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Qt(){return this.t==0?this.s:this[0]<<24>>24}function ei(){return this.t==0?this.s:this[0]<<16>>16}function Ut(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function ci(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Mt(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var r=this.chunkSize(e),o=Math.pow(e,r),h=ye(o),_=mt(),I=mt(),N="";for(this.divRemTo(h,_,I);_.signum()>0;)N=(o+I.intValue()).toString(e).substr(1)+N,_.divRemTo(h,_,I);return I.intValue().toString(e)+N}function t(e,r){this.fromInt(0),r==null&&(r=10);for(var o=this.chunkSize(r),h=Math.pow(r,o),_=!1,I=0,N=0,F=0;F<e.length;++F){var R=ui(e,F);if(R<0){e.charAt(F)=="-"&&this.signum()==0&&(_=!0);continue}N=r*N+R,++I>=o&&(this.dMultiply(h),this.dAddOffset(N,0),I=0,N=0)}I>0&&(this.dMultiply(Math.pow(r,I)),this.dAddOffset(N,0)),_&&$.ZERO.subTo(this,this)}function i(e,r,o){if(typeof r=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,o),this.testBit(e-1)||this.bitwiseTo($.ONE.shiftLeft(e-1),p,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo($.ONE.shiftLeft(e-1),this);else{var h=new Array,_=e&7;h.length=(e>>3)+1,r.nextBytes(h),_>0?h[0]&=(1<<_)-1:h[0]=0,this.fromString(h,256)}}function n(){var e=this.t,r=new Array;r[0]=this.s;var o=this.DB-e*this.DB%8,h,_=0;if(e-- >0)for(o<this.DB&&(h=this[e]>>o)!=(this.s&this.DM)>>o&&(r[_++]=h|this.s<<this.DB-o);e>=0;)o<8?(h=(this[e]&(1<<o)-1)<<8-o,h|=this[--e]>>(o+=this.DB-8)):(h=this[e]>>(o-=8)&255,o<=0&&(o+=this.DB,--e)),(h&128)!=0&&(h|=-256),_==0&&(this.s&128)!=(h&128)&&++_,(_>0||h!=this.s)&&(r[_++]=h);return r}function s(e){return this.compareTo(e)==0}function u(e){return this.compareTo(e)<0?this:e}function l(e){return this.compareTo(e)>0?this:e}function c(e,r,o){var h,_,I=Math.min(e.t,this.t);for(h=0;h<I;++h)o[h]=r(this[h],e[h]);if(e.t<this.t){for(_=e.s&this.DM,h=I;h<this.t;++h)o[h]=r(this[h],_);o.t=this.t}else{for(_=this.s&this.DM,h=I;h<e.t;++h)o[h]=r(_,e[h]);o.t=e.t}o.s=r(this.s,e.s),o.clamp()}function f(e,r){return e&r}function d(e){var r=mt();return this.bitwiseTo(e,f,r),r}function p(e,r){return e|r}function y(e){var r=mt();return this.bitwiseTo(e,p,r),r}function P(e,r){return e^r}function m(e){var r=mt();return this.bitwiseTo(e,P,r),r}function g(e,r){return e&~r}function T(e){var r=mt();return this.bitwiseTo(e,g,r),r}function w(){for(var e=mt(),r=0;r<this.t;++r)e[r]=this.DM&~this[r];return e.t=this.t,e.s=~this.s,e}function O(e){var r=mt();return e<0?this.rShiftTo(-e,r):this.lShiftTo(e,r),r}function C(e){var r=mt();return e<0?this.lShiftTo(-e,r):this.rShiftTo(e,r),r}function b(e){if(e==0)return-1;var r=0;return(e&65535)==0&&(e>>=16,r+=16),(e&255)==0&&(e>>=8,r+=8),(e&15)==0&&(e>>=4,r+=4),(e&3)==0&&(e>>=2,r+=2),(e&1)==0&&++r,r}function v(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+b(this[e]);return this.s<0?this.t*this.DB:-1}function x(e){for(var r=0;e!=0;)e&=e-1,++r;return r}function L(){for(var e=0,r=this.s&this.DM,o=0;o<this.t;++o)e+=x(this[o]^r);return e}function E(e){var r=Math.floor(e/this.DB);return r>=this.t?this.s!=0:(this[r]&1<<e%this.DB)!=0}function S(e,r){var o=$.ONE.shiftLeft(e);return this.bitwiseTo(o,r,o),o}function M(e){return this.changeBit(e,p)}function X(e){return this.changeBit(e,g)}function k(e){return this.changeBit(e,P)}function V(e,r){for(var o=0,h=0,_=Math.min(e.t,this.t);o<_;)h+=this[o]+e[o],r[o++]=h&this.DM,h>>=this.DB;if(e.t<this.t){for(h+=e.s;o<this.t;)h+=this[o],r[o++]=h&this.DM,h>>=this.DB;h+=this.s}else{for(h+=this.s;o<e.t;)h+=e[o],r[o++]=h&this.DM,h>>=this.DB;h+=e.s}r.s=h<0?-1:0,h>0?r[o++]=h:h<-1&&(r[o++]=this.DV+h),r.t=o,r.clamp()}function D(e){var r=mt();return this.addTo(e,r),r}function z(e){var r=mt();return this.subTo(e,r),r}function q(e){var r=mt();return this.multiplyTo(e,r),r}function H(){var e=mt();return this.squareTo(e),e}function U(e){var r=mt();return this.divRemTo(e,r,null),r}function j(e){var r=mt();return this.divRemTo(e,null,r),r}function rt(e){var r=mt(),o=mt();return this.divRemTo(e,r,o),new Array(r,o)}function at(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ut(e,r){if(e!=0){for(;this.t<=r;)this[this.t++]=0;for(this[r]+=e;this[r]>=this.DV;)this[r]-=this.DV,++r>=this.t&&(this[this.t++]=0),++this[r]}}function ft(){}function tt(e){return e}function it(e,r,o){e.multiplyTo(r,o)}function lt(e,r){e.squareTo(r)}ft.prototype.convert=tt,ft.prototype.revert=tt,ft.prototype.mulTo=it,ft.prototype.sqrTo=lt;function dt(e){return this.exp(e,new ft)}function ct(e,r,o){var h=Math.min(this.t+e.t,r);for(o.s=0,o.t=h;h>0;)o[--h]=0;var _;for(_=o.t-this.t;h<_;++h)o[h+this.t]=this.am(0,e[h],o,h,0,this.t);for(_=Math.min(e.t,r);h<_;++h)this.am(0,e[h],o,h,0,r-h);o.clamp()}function Pt(e,r,o){--r;var h=o.t=this.t+e.t-r;for(o.s=0;--h>=0;)o[h]=0;for(h=Math.max(r-this.t,0);h<e.t;++h)o[this.t+h-r]=this.am(r-h,e[h],o,0,0,this.t+h-r);o.clamp(),o.drShiftTo(1,o)}function gt(e){this.r2=mt(),this.q3=mt(),$.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function It(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var r=mt();return e.copyTo(r),this.reduce(r),r}function Et(e){return e}function bt(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function $t(e,r){e.squareTo(r),this.reduce(r)}function te(e,r,o){e.multiplyTo(r,o),this.reduce(o)}gt.prototype.convert=It,gt.prototype.revert=Et,gt.prototype.reduce=bt,gt.prototype.mulTo=te,gt.prototype.sqrTo=$t;function ne(e,r){var o=e.bitLength(),h,_=ye(1),I;if(o<=0)return _;o<18?h=1:o<48?h=3:o<144?h=4:o<768?h=5:h=6,o<8?I=new Ie(r):r.isEven()?I=new gt(r):I=new Wt(r);var N=new Array,F=3,R=h-1,K=(1<<h)-1;if(N[1]=I.convert(this),h>1){var st=mt();for(I.sqrTo(N[1],st);F<=K;)N[F]=mt(),I.mulTo(st,N[F-2],N[F]),F+=2}var et=e.t-1,ot,vt=!0,St=mt(),Tt;for(o=Pe(e[et])-1;et>=0;){for(o>=R?ot=e[et]>>o-R&K:(ot=(e[et]&(1<<o+1)-1)<<R-o,et>0&&(ot|=e[et-1]>>this.DB+o-R)),F=h;(ot&1)==0;)ot>>=1,--F;if((o-=F)<0&&(o+=this.DB,--et),vt)N[ot].copyTo(_),vt=!1;else{for(;F>1;)I.sqrTo(_,St),I.sqrTo(St,_),F-=2;F>0?I.sqrTo(_,St):(Tt=_,_=St,St=Tt),I.mulTo(St,N[ot],_)}for(;et>=0&&(e[et]&1<<o)==0;)I.sqrTo(_,St),Tt=_,_=St,St=Tt,--o<0&&(o=this.DB-1,--et)}return I.revert(_)}function Gt(e){var r=this.s<0?this.negate():this.clone(),o=e.s<0?e.negate():e.clone();if(r.compareTo(o)<0){var h=r;r=o,o=h}var _=r.getLowestSetBit(),I=o.getLowestSetBit();if(I<0)return r;for(_<I&&(I=_),I>0&&(r.rShiftTo(I,r),o.rShiftTo(I,o));r.signum()>0;)(_=r.getLowestSetBit())>0&&r.rShiftTo(_,r),(_=o.getLowestSetBit())>0&&o.rShiftTo(_,o),r.compareTo(o)>=0?(r.subTo(o,r),r.rShiftTo(1,r)):(o.subTo(r,o),o.rShiftTo(1,o));return I>0&&o.lShiftTo(I,o),o}function Ft(e){if(e<=0)return 0;var r=this.DV%e,o=this.s<0?e-1:0;if(this.t>0)if(r==0)o=this[0]%e;else for(var h=this.t-1;h>=0;--h)o=(r*o+this[h])%e;return o}function Jt(e){var r=e.isEven();if(this.isEven()&&r||e.signum()==0)return $.ZERO;for(var o=e.clone(),h=this.clone(),_=ye(1),I=ye(0),N=ye(0),F=ye(1);o.signum()!=0;){for(;o.isEven();)o.rShiftTo(1,o),r?((!_.isEven()||!I.isEven())&&(_.addTo(this,_),I.subTo(e,I)),_.rShiftTo(1,_)):I.isEven()||I.subTo(e,I),I.rShiftTo(1,I);for(;h.isEven();)h.rShiftTo(1,h),r?((!N.isEven()||!F.isEven())&&(N.addTo(this,N),F.subTo(e,F)),N.rShiftTo(1,N)):F.isEven()||F.subTo(e,F),F.rShiftTo(1,F);o.compareTo(h)>=0?(o.subTo(h,o),r&&_.subTo(N,_),I.subTo(F,I)):(h.subTo(o,h),r&&N.subTo(_,N),F.subTo(I,F))}if(h.compareTo($.ONE)!=0)return $.ZERO;if(F.compareTo(e)>=0)return F.subtract(e);if(F.signum()<0)F.addTo(e,F);else return F;return F.signum()<0?F.add(e):F}var zt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ee=(1<<26)/zt[zt.length-1];function _e(e){var r,o=this.abs();if(o.t==1&&o[0]<=zt[zt.length-1]){for(r=0;r<zt.length;++r)if(o[0]==zt[r])return!0;return!1}if(o.isEven())return!1;for(r=1;r<zt.length;){for(var h=zt[r],_=r+1;_<zt.length&&h<ee;)h*=zt[_++];for(h=o.modInt(h);r<_;)if(h%zt[r++]==0)return!1}return o.millerRabin(e)}function Ee(e){var r=this.subtract($.ONE),o=r.getLowestSetBit();if(o<=0)return!1;var h=r.shiftRight(o);e=e+1>>1,e>zt.length&&(e=zt.length);for(var _=mt(),I=0;I<e;++I){_.fromInt(zt[Math.floor(Math.random()*zt.length)]);var N=_.modPow(h,this);if(N.compareTo($.ONE)!=0&&N.compareTo(r)!=0){for(var F=1;F++<o&&N.compareTo(r)!=0;)if(N=N.modPowInt(2,this),N.compareTo($.ONE)==0)return!1;if(N.compareTo(r)!=0)return!1}}return!0}$.prototype.chunkSize=Ut,$.prototype.toRadix=Mt,$.prototype.fromRadix=t,$.prototype.fromNumber=i,$.prototype.bitwiseTo=c,$.prototype.changeBit=S,$.prototype.addTo=V,$.prototype.dMultiply=at,$.prototype.dAddOffset=ut,$.prototype.multiplyLowerTo=ct,$.prototype.multiplyUpperTo=Pt,$.prototype.modInt=Ft,$.prototype.millerRabin=Ee,$.prototype.clone=Li,$.prototype.intValue=fi,$.prototype.byteValue=Qt,$.prototype.shortValue=ei,$.prototype.signum=ci,$.prototype.toByteArray=n,$.prototype.equals=s,$.prototype.min=u,$.prototype.max=l,$.prototype.and=d,$.prototype.or=y,$.prototype.xor=m,$.prototype.andNot=T,$.prototype.not=w,$.prototype.shiftLeft=O,$.prototype.shiftRight=C,$.prototype.getLowestSetBit=v,$.prototype.bitCount=L,$.prototype.testBit=E,$.prototype.setBit=M,$.prototype.clearBit=X,$.prototype.flipBit=k,$.prototype.add=D,$.prototype.subtract=z,$.prototype.multiply=q,$.prototype.divide=U,$.prototype.remainder=j,$.prototype.divideAndRemainder=rt,$.prototype.modPow=ne,$.prototype.modInverse=Jt,$.prototype.pow=dt,$.prototype.gcd=Gt,$.prototype.isProbablePrime=_e,$.prototype.square=H;var wt=$;wt.prototype.IsNegative=function(){return this.compareTo(wt.ZERO)==-1},wt.op_Equality=function(e,r){return e.compareTo(r)==0},wt.op_Inequality=function(e,r){return e.compareTo(r)!=0},wt.op_GreaterThan=function(e,r){return e.compareTo(r)>0},wt.op_LessThan=function(e,r){return e.compareTo(r)<0},wt.op_Addition=function(e,r){return new wt(e,void 0,void 0).add(new wt(r,void 0,void 0))},wt.op_Subtraction=function(e,r){return new wt(e,void 0,void 0).subtract(new wt(r,void 0,void 0))},wt.Int128Mul=function(e,r){return new wt(e,void 0,void 0).multiply(new wt(r,void 0,void 0))},wt.op_Division=function(e,r){return e.divide(r)},wt.prototype.ToDouble=function(){return parseFloat(this.toString())};var ve=function(e,r){var o;if(typeof Object.getOwnPropertyNames>"u"){for(o in r.prototype)(typeof e.prototype[o]>"u"||e.prototype[o]===Object.prototype[o])&&(e.prototype[o]=r.prototype[o]);for(o in r)typeof e[o]>"u"&&(e[o]=r[o]);e.$baseCtor=r}else{for(var h=Object.getOwnPropertyNames(r.prototype),_=0;_<h.length;_++)typeof Object.getOwnPropertyDescriptor(e.prototype,h[_])>"u"&&Object.defineProperty(e.prototype,h[_],Object.getOwnPropertyDescriptor(r.prototype,h[_]));for(o in r)typeof e[o]>"u"&&(e[o]=r[o]);e.$baseCtor=r}};a.Path=function(){return[]},a.Path.prototype.push=Array.prototype.push,a.Paths=function(){return[]},a.Paths.prototype.push=Array.prototype.push,a.DoublePoint=function(){var e=arguments;this.X=0,this.Y=0,e.length===1?(this.X=e[0].X,this.Y=e[0].Y):e.length===2&&(this.X=e[0],this.Y=e[1])},a.DoublePoint0=function(){this.X=0,this.Y=0},a.DoublePoint0.prototype=a.DoublePoint.prototype,a.DoublePoint1=function(e){this.X=e.X,this.Y=e.Y},a.DoublePoint1.prototype=a.DoublePoint.prototype,a.DoublePoint2=function(e,r){this.X=e,this.Y=r},a.DoublePoint2.prototype=a.DoublePoint.prototype,a.PolyNode=function(){this.m_Parent=null,this.m_polygon=new a.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},a.PolyNode.prototype.IsHoleNode=function(){for(var e=!0,r=this.m_Parent;r!==null;)e=!e,r=r.m_Parent;return e},a.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},a.PolyNode.prototype.Contour=function(){return this.m_polygon},a.PolyNode.prototype.AddChild=function(e){var r=this.m_Childs.length;this.m_Childs.push(e),e.m_Parent=this,e.m_Index=r},a.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},a.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},a.PolyNode.prototype.Childs=function(){return this.m_Childs},a.PolyNode.prototype.Parent=function(){return this.m_Parent},a.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},a.PolyTree=function(){this.m_AllPolys=[],a.PolyNode.call(this)},a.PolyTree.prototype.Clear=function(){for(var e=0,r=this.m_AllPolys.length;e<r;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},a.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},a.PolyTree.prototype.Total=function(){var e=this.m_AllPolys.length;return e>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&e--,e},ve(a.PolyTree,a.PolyNode),a.Math_Abs_Int64=a.Math_Abs_Int32=a.Math_Abs_Double=function(e){return Math.abs(e)},a.Math_Max_Int32_Int32=function(e,r){return Math.max(e,r)},A.msie||A.opera||A.safari?a.Cast_Int32=function(e){return e|0}:a.Cast_Int32=function(e){return~~e},typeof Number.toInteger>"u"&&(Number.toInteger=null),A.chrome?a.Cast_Int64=function(e){return e<-2147483648||e>2147483647?e<0?Math.ceil(e):Math.floor(e):~~e}:A.firefox&&typeof Number.toInteger=="function"?a.Cast_Int64=function(e){return Number.toInteger(e)}:A.msie7||A.msie8?a.Cast_Int64=function(e){return parseInt(e,10)}:A.msie?a.Cast_Int64=function(e){return e<-2147483648||e>2147483647?e<0?Math.ceil(e):Math.floor(e):e|0}:a.Cast_Int64=function(e){return e<0?Math.ceil(e):Math.floor(e)},a.Clear=function(e){e.length=0},a.PI=3.141592653589793,a.PI2=2*3.141592653589793,a.IntPoint=function(){var e=arguments,r=e.length;if(this.X=0,this.Y=0,a.use_xyz)if(this.Z=0,r===3)this.X=e[0],this.Y=e[1],this.Z=e[2];else if(r===2)this.X=e[0],this.Y=e[1],this.Z=0;else if(r===1)if(e[0]instanceof a.DoublePoint){var o=e[0];this.X=a.Clipper.Round(o.X),this.Y=a.Clipper.Round(o.Y),this.Z=0}else{var h=e[0];typeof h.Z>"u"&&(h.Z=0),this.X=h.X,this.Y=h.Y,this.Z=h.Z}else this.X=0,this.Y=0,this.Z=0;else if(r===2)this.X=e[0],this.Y=e[1];else if(r===1)if(e[0]instanceof a.DoublePoint){var o=e[0];this.X=a.Clipper.Round(o.X),this.Y=a.Clipper.Round(o.Y)}else{var h=e[0];this.X=h.X,this.Y=h.Y}else this.X=0,this.Y=0},a.IntPoint.op_Equality=function(e,r){return e.X===r.X&&e.Y===r.Y},a.IntPoint.op_Inequality=function(e,r){return e.X!==r.X||e.Y!==r.Y},a.IntPoint0=function(){this.X=0,this.Y=0,a.use_xyz&&(this.Z=0)},a.IntPoint0.prototype=a.IntPoint.prototype,a.IntPoint1=function(e){this.X=e.X,this.Y=e.Y,a.use_xyz&&(typeof e.Z>"u"?this.Z=0:this.Z=e.Z)},a.IntPoint1.prototype=a.IntPoint.prototype,a.IntPoint1dp=function(e){this.X=a.Clipper.Round(e.X),this.Y=a.Clipper.Round(e.Y),a.use_xyz&&(this.Z=0)},a.IntPoint1dp.prototype=a.IntPoint.prototype,a.IntPoint2=function(e,r,o){this.X=e,this.Y=r,a.use_xyz&&(typeof o>"u"?this.Z=0:this.Z=o)},a.IntPoint2.prototype=a.IntPoint.prototype,a.IntRect=function(){var e=arguments,r=e.length;if(r===4)this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3];else if(r===1){var o=e[0];this.left=o.left,this.top=o.top,this.right=o.right,this.bottom=o.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},a.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},a.IntRect0.prototype=a.IntRect.prototype,a.IntRect1=function(e){this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom},a.IntRect1.prototype=a.IntRect.prototype,a.IntRect4=function(e,r,o,h){this.left=e,this.top=r,this.right=o,this.bottom=h},a.IntRect4.prototype=a.IntRect.prototype,a.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},a.PolyType={ptSubject:0,ptClip:1},a.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},a.JoinType={jtSquare:0,jtRound:1,jtMiter:2},a.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},a.EdgeSide={esLeft:0,esRight:1},a.Direction={dRightToLeft:0,dLeftToRight:1},a.TEdge=function(){this.Bot=new a.IntPoint0,this.Curr=new a.IntPoint0,this.Top=new a.IntPoint0,this.Delta=new a.IntPoint0,this.Dx=0,this.PolyTyp=a.PolyType.ptSubject,this.Side=a.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},a.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new a.IntPoint0},a.MyIntersectNodeSort=function(){},a.MyIntersectNodeSort.Compare=function(e,r){var o=r.Pt.Y-e.Pt.Y;return o>0?1:o<0?-1:0},a.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},a.Scanbeam=function(){this.Y=0,this.Next=null},a.Maxima=function(){this.X=0,this.Next=null,this.Prev=null},a.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},a.OutPt=function(){this.Idx=0,this.Pt=new a.IntPoint0,this.Next=null,this.Prev=null},a.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new a.IntPoint0},a.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},a.ClipperBase.horizontal=-9007199254740992,a.ClipperBase.Skip=-2,a.ClipperBase.Unassigned=-1,a.ClipperBase.tolerance=1e-20,a.ClipperBase.loRange=47453132,a.ClipperBase.hiRange=0xfffffffffffff,a.ClipperBase.near_zero=function(e){return e>-a.ClipperBase.tolerance&&e<a.ClipperBase.tolerance},a.ClipperBase.IsHorizontal=function(e){return e.Delta.Y===0},a.ClipperBase.prototype.PointIsVertex=function(e,r){var o=r;do{if(a.IntPoint.op_Equality(o.Pt,e))return!0;o=o.Next}while(o!==r);return!1},a.ClipperBase.prototype.PointOnLineSegment=function(e,r,o,h){return h?e.X===r.X&&e.Y===r.Y||e.X===o.X&&e.Y===o.Y||e.X>r.X==e.X<o.X&&e.Y>r.Y==e.Y<o.Y&&wt.op_Equality(wt.Int128Mul(e.X-r.X,o.Y-r.Y),wt.Int128Mul(o.X-r.X,e.Y-r.Y)):e.X===r.X&&e.Y===r.Y||e.X===o.X&&e.Y===o.Y||e.X>r.X==e.X<o.X&&e.Y>r.Y==e.Y<o.Y&&(e.X-r.X)*(o.Y-r.Y)===(o.X-r.X)*(e.Y-r.Y)},a.ClipperBase.prototype.PointOnPolygon=function(e,r,o){for(var h=r;;){if(this.PointOnLineSegment(e,h.Pt,h.Next.Pt,o))return!0;if(h=h.Next,h===r)break}return!1},a.ClipperBase.prototype.SlopesEqual=a.ClipperBase.SlopesEqual=function(){var e=arguments,r=e.length,o,h,_,I,N,F,R;return r===3?(o=e[0],h=e[1],R=e[2],R?wt.op_Equality(wt.Int128Mul(o.Delta.Y,h.Delta.X),wt.Int128Mul(o.Delta.X,h.Delta.Y)):a.Cast_Int64(o.Delta.Y*h.Delta.X)===a.Cast_Int64(o.Delta.X*h.Delta.Y)):r===4?(_=e[0],I=e[1],N=e[2],R=e[3],R?wt.op_Equality(wt.Int128Mul(_.Y-I.Y,I.X-N.X),wt.Int128Mul(_.X-I.X,I.Y-N.Y)):a.Cast_Int64((_.Y-I.Y)*(I.X-N.X))-a.Cast_Int64((_.X-I.X)*(I.Y-N.Y))===0):(_=e[0],I=e[1],N=e[2],F=e[3],R=e[4],R?wt.op_Equality(wt.Int128Mul(_.Y-I.Y,N.X-F.X),wt.Int128Mul(_.X-I.X,N.Y-F.Y)):a.Cast_Int64((_.Y-I.Y)*(N.X-F.X))-a.Cast_Int64((_.X-I.X)*(N.Y-F.Y))===0)},a.ClipperBase.SlopesEqual3=function(e,r,o){return o?wt.op_Equality(wt.Int128Mul(e.Delta.Y,r.Delta.X),wt.Int128Mul(e.Delta.X,r.Delta.Y)):a.Cast_Int64(e.Delta.Y*r.Delta.X)===a.Cast_Int64(e.Delta.X*r.Delta.Y)},a.ClipperBase.SlopesEqual4=function(e,r,o,h){return h?wt.op_Equality(wt.Int128Mul(e.Y-r.Y,r.X-o.X),wt.Int128Mul(e.X-r.X,r.Y-o.Y)):a.Cast_Int64((e.Y-r.Y)*(r.X-o.X))-a.Cast_Int64((e.X-r.X)*(r.Y-o.Y))===0},a.ClipperBase.SlopesEqual5=function(e,r,o,h,_){return _?wt.op_Equality(wt.Int128Mul(e.Y-r.Y,o.X-h.X),wt.Int128Mul(e.X-r.X,o.Y-h.Y)):a.Cast_Int64((e.Y-r.Y)*(o.X-h.X))-a.Cast_Int64((e.X-r.X)*(o.Y-h.Y))===0},a.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,r=this.m_edges.length;e<r;++e){for(var o=0,h=this.m_edges[e].length;o<h;++o)this.m_edges[e][o]=null;a.Clear(this.m_edges[e])}a.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},a.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var e=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=e}this.m_CurrentLM=null},a.ClipperBase.prototype.RangeTest=function(e,r){r.Value?(e.X>a.ClipperBase.hiRange||e.Y>a.ClipperBase.hiRange||-e.X>a.ClipperBase.hiRange||-e.Y>a.ClipperBase.hiRange)&&a.Error("Coordinate outside allowed range in RangeTest()."):(e.X>a.ClipperBase.loRange||e.Y>a.ClipperBase.loRange||-e.X>a.ClipperBase.loRange||-e.Y>a.ClipperBase.loRange)&&(r.Value=!0,this.RangeTest(e,r))},a.ClipperBase.prototype.InitEdge=function(e,r,o,h){e.Next=r,e.Prev=o,e.Curr.X=h.X,e.Curr.Y=h.Y,a.use_xyz&&(e.Curr.Z=h.Z),e.OutIdx=-1},a.ClipperBase.prototype.InitEdge2=function(e,r){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,a.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,a.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,a.use_xyz&&(e.Top.Z=e.Curr.Z),e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,a.use_xyz&&(e.Bot.Z=e.Next.Curr.Z)),this.SetDx(e),e.PolyTyp=r},a.ClipperBase.prototype.FindNextLocMin=function(e){for(var r;;){for(;a.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||a.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!==a.ClipperBase.horizontal&&e.Prev.Dx!==a.ClipperBase.horizontal)break;for(;e.Prev.Dx===a.ClipperBase.horizontal;)e=e.Prev;for(r=e;e.Dx===a.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!==e.Prev.Bot.Y){r.Prev.Bot.X<e.Bot.X&&(e=r);break}}return e},a.ClipperBase.prototype.ProcessBound=function(e,r){var o,h=e,_;if(h.OutIdx===a.ClipperBase.Skip){if(e=h,r){for(;e.Top.Y===e.Next.Bot.Y;)e=e.Next;for(;e!==h&&e.Dx===a.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y===e.Prev.Bot.Y;)e=e.Prev;for(;e!==h&&e.Dx===a.ClipperBase.horizontal;)e=e.Next}if(e===h)r?h=e.Next:h=e.Prev;else{r?e=h.Next:e=h.Prev;var I=new a.LocalMinima;I.Next=null,I.Y=e.Bot.Y,I.LeftBound=null,I.RightBound=e,e.WindDelta=0,h=this.ProcessBound(e,r),this.InsertLocalMinima(I)}return h}if(e.Dx===a.ClipperBase.horizontal&&(r?o=e.Prev:o=e.Next,o.Dx===a.ClipperBase.horizontal?o.Bot.X!==e.Bot.X&&o.Top.X!==e.Bot.X&&this.ReverseHorizontal(e):o.Bot.X!==e.Bot.X&&this.ReverseHorizontal(e)),o=e,r){for(;h.Top.Y===h.Next.Bot.Y&&h.Next.OutIdx!==a.ClipperBase.Skip;)h=h.Next;if(h.Dx===a.ClipperBase.horizontal&&h.Next.OutIdx!==a.ClipperBase.Skip){for(_=h;_.Prev.Dx===a.ClipperBase.horizontal;)_=_.Prev;_.Prev.Top.X>h.Next.Top.X&&(h=_.Prev)}for(;e!==h;)e.NextInLML=e.Next,e.Dx===a.ClipperBase.horizontal&&e!==o&&e.Bot.X!==e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx===a.ClipperBase.horizontal&&e!==o&&e.Bot.X!==e.Prev.Top.X&&this.ReverseHorizontal(e),h=h.Next}else{for(;h.Top.Y===h.Prev.Bot.Y&&h.Prev.OutIdx!==a.ClipperBase.Skip;)h=h.Prev;if(h.Dx===a.ClipperBase.horizontal&&h.Prev.OutIdx!==a.ClipperBase.Skip){for(_=h;_.Next.Dx===a.ClipperBase.horizontal;)_=_.Next;(_.Next.Top.X===h.Prev.Top.X||_.Next.Top.X>h.Prev.Top.X)&&(h=_.Next)}for(;e!==h;)e.NextInLML=e.Prev,e.Dx===a.ClipperBase.horizontal&&e!==o&&e.Bot.X!==e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx===a.ClipperBase.horizontal&&e!==o&&e.Bot.X!==e.Next.Top.X&&this.ReverseHorizontal(e),h=h.Prev}return h},a.ClipperBase.prototype.AddPath=function(e,r,o){a.use_lines?!o&&r===a.PolyType.ptClip&&a.Error("AddPath: Open paths must be subject."):o||a.Error("AddPath: Open paths have been disabled.");var h=e.length-1;if(o)for(;h>0&&a.IntPoint.op_Equality(e[h],e[0]);)--h;for(;h>0&&a.IntPoint.op_Equality(e[h],e[h-1]);)--h;if(o&&h<2||!o&&h<1)return!1;for(var _=new Array,I=0;I<=h;I++)_.push(new a.TEdge);var N=!0;_[1].Curr.X=e[1].X,_[1].Curr.Y=e[1].Y,a.use_xyz&&(_[1].Curr.Z=e[1].Z);var F={Value:this.m_UseFullRange};this.RangeTest(e[0],F),this.m_UseFullRange=F.Value,F.Value=this.m_UseFullRange,this.RangeTest(e[h],F),this.m_UseFullRange=F.Value,this.InitEdge(_[0],_[1],_[h],e[0]),this.InitEdge(_[h],_[0],_[h-1],e[h]);for(var I=h-1;I>=1;--I)F.Value=this.m_UseFullRange,this.RangeTest(e[I],F),this.m_UseFullRange=F.Value,this.InitEdge(_[I],_[I+1],_[I-1],e[I]);for(var R=_[0],K=R,st=R;;){if(K.Curr===K.Next.Curr&&(o||K.Next!==R)){if(K===K.Next)break;K===R&&(R=K.Next),K=this.RemoveEdge(K),st=K;continue}if(K.Prev===K.Next)break;if(o&&a.ClipperBase.SlopesEqual4(K.Prev.Curr,K.Curr,K.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(K.Prev.Curr,K.Curr,K.Next.Curr))){K===R&&(R=K.Next),K=this.RemoveEdge(K),K=K.Prev,st=K;continue}if(K=K.Next,K===st||!o&&K.Next===R)break}if(!o&&K===K.Next||o&&K.Prev===K.Next)return!1;o||(this.m_HasOpenPaths=!0,R.Prev.OutIdx=a.ClipperBase.Skip),K=R;do this.InitEdge2(K,r),K=K.Next,N&&K.Curr.Y!==R.Curr.Y&&(N=!1);while(K!==R);if(N){if(o)return!1;K.Prev.OutIdx=a.ClipperBase.Skip;var et=new a.LocalMinima;for(et.Next=null,et.Y=K.Bot.Y,et.LeftBound=null,et.RightBound=K,et.RightBound.Side=a.EdgeSide.esRight,et.RightBound.WindDelta=0;K.Bot.X!==K.Prev.Top.X&&this.ReverseHorizontal(K),K.Next.OutIdx!==a.ClipperBase.Skip;)K.NextInLML=K.Next,K=K.Next;return this.InsertLocalMinima(et),this.m_edges.push(_),!0}this.m_edges.push(_);var ot,vt=null;for(a.IntPoint.op_Equality(K.Prev.Bot,K.Prev.Top)&&(K=K.Next);K=this.FindNextLocMin(K),K!==vt;){vt===null&&(vt=K);var et=new a.LocalMinima;et.Next=null,et.Y=K.Bot.Y,K.Dx<K.Prev.Dx?(et.LeftBound=K.Prev,et.RightBound=K,ot=!1):(et.LeftBound=K,et.RightBound=K.Prev,ot=!0),et.LeftBound.Side=a.EdgeSide.esLeft,et.RightBound.Side=a.EdgeSide.esRight,o?et.LeftBound.Next===et.RightBound?et.LeftBound.WindDelta=-1:et.LeftBound.WindDelta=1:et.LeftBound.WindDelta=0,et.RightBound.WindDelta=-et.LeftBound.WindDelta,K=this.ProcessBound(et.LeftBound,ot),K.OutIdx===a.ClipperBase.Skip&&(K=this.ProcessBound(K,ot));var St=this.ProcessBound(et.RightBound,!ot);St.OutIdx===a.ClipperBase.Skip&&(St=this.ProcessBound(St,!ot)),et.LeftBound.OutIdx===a.ClipperBase.Skip?et.LeftBound=null:et.RightBound.OutIdx===a.ClipperBase.Skip&&(et.RightBound=null),this.InsertLocalMinima(et),ot||(K=St)}return!0},a.ClipperBase.prototype.AddPaths=function(e,r,o){for(var h=!1,_=0,I=e.length;_<I;++_)this.AddPath(e[_],r,o)&&(h=!0);return h},a.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(e,r,o){return a.IntPoint.op_Equality(e,o)||a.IntPoint.op_Equality(e,r)||a.IntPoint.op_Equality(o,r)?!1:e.X!==o.X?r.X>e.X==r.X<o.X:r.Y>e.Y==r.Y<o.Y},a.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next,e.Next.Prev=e.Prev;var r=e.Next;return e.Prev=null,r},a.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X,e.Delta.Y=e.Top.Y-e.Bot.Y,e.Delta.Y===0?e.Dx=a.ClipperBase.horizontal:e.Dx=e.Delta.X/e.Delta.Y},a.ClipperBase.prototype.InsertLocalMinima=function(e){if(this.m_MinimaList===null)this.m_MinimaList=e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var r=this.m_MinimaList;r.Next!==null&&e.Y<r.Next.Y;)r=r.Next;e.Next=r.Next,r.Next=e}},a.ClipperBase.prototype.PopLocalMinima=function(e,r){return r.v=this.m_CurrentLM,this.m_CurrentLM!==null&&this.m_CurrentLM.Y===e?(this.m_CurrentLM=this.m_CurrentLM.Next,!0):!1},a.ClipperBase.prototype.ReverseHorizontal=function(e){var r=e.Top.X;e.Top.X=e.Bot.X,e.Bot.X=r,a.use_xyz&&(r=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=r)},a.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!==null){this.m_Scanbeam=null;for(var e=this.m_MinimaList;e!==null;){this.InsertScanbeam(e.Y);var r=e.LeftBound;r!==null&&(r.Curr.X=r.Bot.X,r.Curr.Y=r.Bot.Y,a.use_xyz&&(r.Curr.Z=r.Bot.Z),r.OutIdx=a.ClipperBase.Unassigned),r=e.RightBound,r!==null&&(r.Curr.X=r.Bot.X,r.Curr.Y=r.Bot.Y,a.use_xyz&&(r.Curr.Z=r.Bot.Z),r.OutIdx=a.ClipperBase.Unassigned),e=e.Next}this.m_ActiveEdges=null}},a.ClipperBase.prototype.InsertScanbeam=function(e){if(this.m_Scanbeam===null)this.m_Scanbeam=new a.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var r=new a.Scanbeam;r.Y=e,r.Next=this.m_Scanbeam,this.m_Scanbeam=r}else{for(var o=this.m_Scanbeam;o.Next!==null&&e<=o.Next.Y;)o=o.Next;if(e===o.Y)return;var h=new a.Scanbeam;h.Y=e,h.Next=o.Next,o.Next=h}},a.ClipperBase.prototype.PopScanbeam=function(e){return this.m_Scanbeam===null?(e.v=0,!1):(e.v=this.m_Scanbeam.Y,this.m_Scanbeam=this.m_Scanbeam.Next,!0)},a.ClipperBase.prototype.LocalMinimaPending=function(){return this.m_CurrentLM!==null},a.ClipperBase.prototype.CreateOutRec=function(){var e=new a.OutRec;return e.Idx=a.ClipperBase.Unassigned,e.IsHole=!1,e.IsOpen=!1,e.FirstLeft=null,e.Pts=null,e.BottomPt=null,e.PolyNode=null,this.m_PolyOuts.push(e),e.Idx=this.m_PolyOuts.length-1,e},a.ClipperBase.prototype.DisposeOutRec=function(e){var r=this.m_PolyOuts[e];r.Pts=null,r=null,this.m_PolyOuts[e]=null},a.ClipperBase.prototype.UpdateEdgeIntoAEL=function(e){e.NextInLML===null&&a.Error("UpdateEdgeIntoAEL: invalid call");var r=e.PrevInAEL,o=e.NextInAEL;return e.NextInLML.OutIdx=e.OutIdx,r!==null?r.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML,o!==null&&(o.PrevInAEL=e.NextInLML),e.NextInLML.Side=e.Side,e.NextInLML.WindDelta=e.WindDelta,e.NextInLML.WindCnt=e.WindCnt,e.NextInLML.WindCnt2=e.WindCnt2,e=e.NextInLML,e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.PrevInAEL=r,e.NextInAEL=o,a.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y),e},a.ClipperBase.prototype.SwapPositionsInAEL=function(e,r){if(!(e.NextInAEL===e.PrevInAEL||r.NextInAEL===r.PrevInAEL)){if(e.NextInAEL===r){var o=r.NextInAEL;o!==null&&(o.PrevInAEL=e);var h=e.PrevInAEL;h!==null&&(h.NextInAEL=r),r.PrevInAEL=h,r.NextInAEL=e,e.PrevInAEL=r,e.NextInAEL=o}else if(r.NextInAEL===e){var _=e.NextInAEL;_!==null&&(_.PrevInAEL=r);var I=r.PrevInAEL;I!==null&&(I.NextInAEL=e),e.PrevInAEL=I,e.NextInAEL=r,r.PrevInAEL=e,r.NextInAEL=_}else{var N=e.NextInAEL,F=e.PrevInAEL;e.NextInAEL=r.NextInAEL,e.NextInAEL!==null&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=r.PrevInAEL,e.PrevInAEL!==null&&(e.PrevInAEL.NextInAEL=e),r.NextInAEL=N,r.NextInAEL!==null&&(r.NextInAEL.PrevInAEL=r),r.PrevInAEL=F,r.PrevInAEL!==null&&(r.PrevInAEL.NextInAEL=r)}e.PrevInAEL===null?this.m_ActiveEdges=e:r.PrevInAEL===null&&(this.m_ActiveEdges=r)}},a.ClipperBase.prototype.DeleteFromAEL=function(e){var r=e.PrevInAEL,o=e.NextInAEL;r===null&&o===null&&e!==this.m_ActiveEdges||(r!==null?r.NextInAEL=o:this.m_ActiveEdges=o,o!==null&&(o.PrevInAEL=r),e.NextInAEL=null,e.PrevInAEL=null)},a.Clipper=function(e){typeof e>"u"&&(e=0),this.m_PolyOuts=null,this.m_ClipType=a.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=a.PolyFillType.pftEvenOdd,this.m_SubjFillType=a.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,a.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=a.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&e)!==0,this.StrictlySimple=(2&e)!==0,this.PreserveCollinear=(4&e)!==0,a.use_xyz&&(this.ZFillFunction=null)},a.Clipper.ioReverseSolution=1,a.Clipper.ioStrictlySimple=2,a.Clipper.ioPreserveCollinear=4,a.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),a.ClipperBase.prototype.Clear.call(this))},a.Clipper.prototype.InsertMaxima=function(e){var r=new a.Maxima;if(r.X=e,this.m_Maxima===null)this.m_Maxima=r,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(e<this.m_Maxima.X)r.Next=this.m_Maxima,r.Prev=null,this.m_Maxima=r;else{for(var o=this.m_Maxima;o.Next!==null&&e>=o.Next.X;)o=o.Next;if(e===o.X)return;r.Next=o.Next,r.Prev=o,o.Next!==null&&(o.Next.Prev=r),o.Next=r}},a.Clipper.prototype.Execute=function(){var e=arguments,r=e.length,o=e[1]instanceof a.PolyTree;if(r===4&&!o){var h=e[0],_=e[1],I=e[2],N=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&a.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,a.Clear(_),this.m_SubjFillType=I,this.m_ClipFillType=N,this.m_ClipType=h,this.m_UsingPolyTree=!1;try{var F=this.ExecuteInternal();F&&this.BuildResult(_)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return F}else if(r===4&&o){var h=e[0],R=e[1],I=e[2],N=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=I,this.m_ClipFillType=N,this.m_ClipType=h,this.m_UsingPolyTree=!0;try{var F=this.ExecuteInternal();F&&this.BuildResult2(R)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return F}else if(r===2&&!o){var h=e[0],_=e[1];return this.Execute(h,_,a.PolyFillType.pftEvenOdd,a.PolyFillType.pftEvenOdd)}else if(r===2&&o){var h=e[0],R=e[1];return this.Execute(h,R,a.PolyFillType.pftEvenOdd,a.PolyFillType.pftEvenOdd)}},a.Clipper.prototype.FixHoleLinkage=function(e){if(!(e.FirstLeft===null||e.IsHole!==e.FirstLeft.IsHole&&e.FirstLeft.Pts!==null)){for(var r=e.FirstLeft;r!==null&&(r.IsHole===e.IsHole||r.Pts===null);)r=r.FirstLeft;e.FirstLeft=r}},a.Clipper.prototype.ExecuteInternal=function(){try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var e={},r={};if(!this.PopScanbeam(e))return!1;for(this.InsertLocalMinimaIntoAEL(e.v);this.PopScanbeam(r)||this.LocalMinimaPending();){if(this.ProcessHorizontals(),this.m_GhostJoins.length=0,!this.ProcessIntersections(r.v))return!1;this.ProcessEdgesAtTopOfScanbeam(r.v),e.v=r.v,this.InsertLocalMinimaIntoAEL(e.v)}var o,h,_;for(h=0,_=this.m_PolyOuts.length;h<_;h++)o=this.m_PolyOuts[h],!(o.Pts===null||o.IsOpen)&&(o.IsHole^this.ReverseSolution)==this.Area$1(o)>0&&this.ReversePolyPtLinks(o.Pts);for(this.JoinCommonEdges(),h=0,_=this.m_PolyOuts.length;h<_;h++)o=this.m_PolyOuts[h],o.Pts!==null&&(o.IsOpen?this.FixupOutPolyline(o):this.FixupOutPolygon(o));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},a.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,r=this.m_PolyOuts.length;e<r;++e)this.DisposeOutRec(e);a.Clear(this.m_PolyOuts)},a.Clipper.prototype.AddJoin=function(e,r,o){var h=new a.Join;h.OutPt1=e,h.OutPt2=r,h.OffPt.X=o.X,h.OffPt.Y=o.Y,a.use_xyz&&(h.OffPt.Z=o.Z),this.m_Joins.push(h)},a.Clipper.prototype.AddGhostJoin=function(e,r){var o=new a.Join;o.OutPt1=e,o.OffPt.X=r.X,o.OffPt.Y=r.Y,a.use_xyz&&(o.OffPt.Z=r.Z),this.m_GhostJoins.push(o)},a.Clipper.prototype.SetZ=function(e,r,o){if(this.ZFillFunction!==null){if(e.Z!==0||this.ZFillFunction===null)return;a.IntPoint.op_Equality(e,r.Bot)?e.Z=r.Bot.Z:a.IntPoint.op_Equality(e,r.Top)?e.Z=r.Top.Z:a.IntPoint.op_Equality(e,o.Bot)?e.Z=o.Bot.Z:a.IntPoint.op_Equality(e,o.Top)?e.Z=o.Top.Z:this.ZFillFunction(r.Bot,r.Top,o.Bot,o.Top,e)}},a.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){for(var r={},o,h;this.PopLocalMinima(e,r);){o=r.v.LeftBound,h=r.v.RightBound;var _=null;if(o===null?(this.InsertEdgeIntoAEL(h,null),this.SetWindingCount(h),this.IsContributing(h)&&(_=this.AddOutPt(h,h.Bot))):h===null?(this.InsertEdgeIntoAEL(o,null),this.SetWindingCount(o),this.IsContributing(o)&&(_=this.AddOutPt(o,o.Bot)),this.InsertScanbeam(o.Top.Y)):(this.InsertEdgeIntoAEL(o,null),this.InsertEdgeIntoAEL(h,o),this.SetWindingCount(o),h.WindCnt=o.WindCnt,h.WindCnt2=o.WindCnt2,this.IsContributing(o)&&(_=this.AddLocalMinPoly(o,h,o.Bot)),this.InsertScanbeam(o.Top.Y)),h!==null&&(a.ClipperBase.IsHorizontal(h)?(h.NextInLML!==null&&this.InsertScanbeam(h.NextInLML.Top.Y),this.AddEdgeToSEL(h)):this.InsertScanbeam(h.Top.Y)),!(o===null||h===null)){if(_!==null&&a.ClipperBase.IsHorizontal(h)&&this.m_GhostJoins.length>0&&h.WindDelta!==0)for(var I=0,N=this.m_GhostJoins.length;I<N;I++){var F=this.m_GhostJoins[I];this.HorzSegmentsOverlap(F.OutPt1.Pt.X,F.OffPt.X,h.Bot.X,h.Top.X)&&this.AddJoin(F.OutPt1,_,F.OffPt)}if(o.OutIdx>=0&&o.PrevInAEL!==null&&o.PrevInAEL.Curr.X===o.Bot.X&&o.PrevInAEL.OutIdx>=0&&a.ClipperBase.SlopesEqual5(o.PrevInAEL.Curr,o.PrevInAEL.Top,o.Curr,o.Top,this.m_UseFullRange)&&o.WindDelta!==0&&o.PrevInAEL.WindDelta!==0){var R=this.AddOutPt(o.PrevInAEL,o.Bot);this.AddJoin(_,R,o.Top)}if(o.NextInAEL!==h){if(h.OutIdx>=0&&h.PrevInAEL.OutIdx>=0&&a.ClipperBase.SlopesEqual5(h.PrevInAEL.Curr,h.PrevInAEL.Top,h.Curr,h.Top,this.m_UseFullRange)&&h.WindDelta!==0&&h.PrevInAEL.WindDelta!==0){var R=this.AddOutPt(h.PrevInAEL,h.Bot);this.AddJoin(_,R,h.Top)}var K=o.NextInAEL;if(K!==null)for(;K!==h;)this.IntersectEdges(h,K,o.Curr),K=K.NextInAEL}}}},a.Clipper.prototype.InsertEdgeIntoAEL=function(e,r){if(this.m_ActiveEdges===null)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(r===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=e,this.m_ActiveEdges=e;else{for(r===null&&(r=this.m_ActiveEdges);r.NextInAEL!==null&&!this.E2InsertsBeforeE1(r.NextInAEL,e);)r=r.NextInAEL;e.NextInAEL=r.NextInAEL,r.NextInAEL!==null&&(r.NextInAEL.PrevInAEL=e),e.PrevInAEL=r,r.NextInAEL=e}},a.Clipper.prototype.E2InsertsBeforeE1=function(e,r){return r.Curr.X===e.Curr.X?r.Top.Y>e.Top.Y?r.Top.X<a.Clipper.TopX(e,r.Top.Y):e.Top.X>a.Clipper.TopX(r,e.Top.Y):r.Curr.X<e.Curr.X},a.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp===a.PolyType.ptSubject?this.m_SubjFillType===a.PolyFillType.pftEvenOdd:this.m_ClipFillType===a.PolyFillType.pftEvenOdd},a.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp===a.PolyType.ptSubject?this.m_ClipFillType===a.PolyFillType.pftEvenOdd:this.m_SubjFillType===a.PolyFillType.pftEvenOdd},a.Clipper.prototype.IsContributing=function(e){var r,o;switch(e.PolyTyp===a.PolyType.ptSubject?(r=this.m_SubjFillType,o=this.m_ClipFillType):(r=this.m_ClipFillType,o=this.m_SubjFillType),r){case a.PolyFillType.pftEvenOdd:if(e.WindDelta===0&&e.WindCnt!==1)return!1;break;case a.PolyFillType.pftNonZero:if(Math.abs(e.WindCnt)!==1)return!1;break;case a.PolyFillType.pftPositive:if(e.WindCnt!==1)return!1;break;default:if(e.WindCnt!==-1)return!1;break}switch(this.m_ClipType){case a.ClipType.ctIntersection:switch(o){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return e.WindCnt2!==0;case a.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0}case a.ClipType.ctUnion:switch(o){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return e.WindCnt2===0;case a.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}case a.ClipType.ctDifference:if(e.PolyTyp===a.PolyType.ptSubject)switch(o){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return e.WindCnt2===0;case a.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else switch(o){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return e.WindCnt2!==0;case a.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0}case a.ClipType.ctXor:if(e.WindDelta===0)switch(o){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return e.WindCnt2===0;case a.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else return!0}return!0},a.Clipper.prototype.SetWindingCount=function(e){for(var r=e.PrevInAEL;r!==null&&(r.PolyTyp!==e.PolyTyp||r.WindDelta===0);)r=r.PrevInAEL;if(r===null){var o=e.PolyTyp===a.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;e.WindDelta===0?e.WindCnt=o===a.PolyFillType.pftNegative?-1:1:e.WindCnt=e.WindDelta,e.WindCnt2=0,r=this.m_ActiveEdges}else if(e.WindDelta===0&&this.m_ClipType!==a.ClipType.ctUnion)e.WindCnt=1,e.WindCnt2=r.WindCnt2,r=r.NextInAEL;else if(this.IsEvenOddFillType(e)){if(e.WindDelta===0){for(var h=!0,_=r.PrevInAEL;_!==null;)_.PolyTyp===r.PolyTyp&&_.WindDelta!==0&&(h=!h),_=_.PrevInAEL;e.WindCnt=h?0:1}else e.WindCnt=e.WindDelta;e.WindCnt2=r.WindCnt2,r=r.NextInAEL}else r.WindCnt*r.WindDelta<0?Math.abs(r.WindCnt)>1?r.WindDelta*e.WindDelta<0?e.WindCnt=r.WindCnt:e.WindCnt=r.WindCnt+e.WindDelta:e.WindCnt=e.WindDelta===0?1:e.WindDelta:e.WindDelta===0?e.WindCnt=r.WindCnt<0?r.WindCnt-1:r.WindCnt+1:r.WindDelta*e.WindDelta<0?e.WindCnt=r.WindCnt:e.WindCnt=r.WindCnt+e.WindDelta,e.WindCnt2=r.WindCnt2,r=r.NextInAEL;if(this.IsEvenOddAltFillType(e))for(;r!==e;)r.WindDelta!==0&&(e.WindCnt2=e.WindCnt2===0?1:0),r=r.NextInAEL;else for(;r!==e;)e.WindCnt2+=r.WindDelta,r=r.NextInAEL},a.Clipper.prototype.AddEdgeToSEL=function(e){this.m_SortedEdges===null?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,e.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=e,this.m_SortedEdges=e)},a.Clipper.prototype.PopEdgeFromSEL=function(e){if(e.v=this.m_SortedEdges,e.v===null)return!1;var r=e.v;return this.m_SortedEdges=e.v.NextInSEL,this.m_SortedEdges!==null&&(this.m_SortedEdges.PrevInSEL=null),r.NextInSEL=null,r.PrevInSEL=null,!0},a.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;e!==null;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e=e.NextInAEL},a.Clipper.prototype.SwapPositionsInSEL=function(e,r){if(!(e.NextInSEL===null&&e.PrevInSEL===null)&&!(r.NextInSEL===null&&r.PrevInSEL===null)){if(e.NextInSEL===r){var o=r.NextInSEL;o!==null&&(o.PrevInSEL=e);var h=e.PrevInSEL;h!==null&&(h.NextInSEL=r),r.PrevInSEL=h,r.NextInSEL=e,e.PrevInSEL=r,e.NextInSEL=o}else if(r.NextInSEL===e){var o=e.NextInSEL;o!==null&&(o.PrevInSEL=r);var h=r.PrevInSEL;h!==null&&(h.NextInSEL=e),e.PrevInSEL=h,e.NextInSEL=r,r.PrevInSEL=e,r.NextInSEL=o}else{var o=e.NextInSEL,h=e.PrevInSEL;e.NextInSEL=r.NextInSEL,e.NextInSEL!==null&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=r.PrevInSEL,e.PrevInSEL!==null&&(e.PrevInSEL.NextInSEL=e),r.NextInSEL=o,r.NextInSEL!==null&&(r.NextInSEL.PrevInSEL=r),r.PrevInSEL=h,r.PrevInSEL!==null&&(r.PrevInSEL.NextInSEL=r)}e.PrevInSEL===null?this.m_SortedEdges=e:r.PrevInSEL===null&&(this.m_SortedEdges=r)}},a.Clipper.prototype.AddLocalMaxPoly=function(e,r,o){this.AddOutPt(e,o),r.WindDelta===0&&this.AddOutPt(r,o),e.OutIdx===r.OutIdx?(e.OutIdx=-1,r.OutIdx=-1):e.OutIdx<r.OutIdx?this.AppendPolygon(e,r):this.AppendPolygon(r,e)},a.Clipper.prototype.AddLocalMinPoly=function(e,r,o){var h,_,I;if(a.ClipperBase.IsHorizontal(r)||e.Dx>r.Dx?(h=this.AddOutPt(e,o),r.OutIdx=e.OutIdx,e.Side=a.EdgeSide.esLeft,r.Side=a.EdgeSide.esRight,_=e,_.PrevInAEL===r?I=r.PrevInAEL:I=_.PrevInAEL):(h=this.AddOutPt(r,o),e.OutIdx=r.OutIdx,e.Side=a.EdgeSide.esRight,r.Side=a.EdgeSide.esLeft,_=r,_.PrevInAEL===e?I=e.PrevInAEL:I=_.PrevInAEL),I!==null&&I.OutIdx>=0&&I.Top.Y<o.Y&&_.Top.Y<o.Y){var N=a.Clipper.TopX(I,o.Y),F=a.Clipper.TopX(_,o.Y);if(N===F&&_.WindDelta!==0&&I.WindDelta!==0&&a.ClipperBase.SlopesEqual5(new a.IntPoint2(N,o.Y),I.Top,new a.IntPoint2(F,o.Y),_.Top,this.m_UseFullRange)){var R=this.AddOutPt(I,o);this.AddJoin(h,R,_.Top)}}return h},a.Clipper.prototype.AddOutPt=function(e,r){if(e.OutIdx<0){var o=this.CreateOutRec();o.IsOpen=e.WindDelta===0;var h=new a.OutPt;return o.Pts=h,h.Idx=o.Idx,h.Pt.X=r.X,h.Pt.Y=r.Y,a.use_xyz&&(h.Pt.Z=r.Z),h.Next=h,h.Prev=h,o.IsOpen||this.SetHoleState(e,o),e.OutIdx=o.Idx,h}else{var o=this.m_PolyOuts[e.OutIdx],_=o.Pts,I=e.Side===a.EdgeSide.esLeft;if(I&&a.IntPoint.op_Equality(r,_.Pt))return _;if(!I&&a.IntPoint.op_Equality(r,_.Prev.Pt))return _.Prev;var h=new a.OutPt;return h.Idx=o.Idx,h.Pt.X=r.X,h.Pt.Y=r.Y,a.use_xyz&&(h.Pt.Z=r.Z),h.Next=_,h.Prev=_.Prev,h.Prev.Next=h,_.Prev=h,I&&(o.Pts=h),h}},a.Clipper.prototype.GetLastOutPt=function(e){var r=this.m_PolyOuts[e.OutIdx];return e.Side===a.EdgeSide.esLeft?r.Pts:r.Pts.Prev},a.Clipper.prototype.SwapPoints=function(e,r){var o=new a.IntPoint1(e.Value);e.Value.X=r.Value.X,e.Value.Y=r.Value.Y,a.use_xyz&&(e.Value.Z=r.Value.Z),r.Value.X=o.X,r.Value.Y=o.Y,a.use_xyz&&(r.Value.Z=o.Z)},a.Clipper.prototype.HorzSegmentsOverlap=function(e,r,o,h){var _;return e>r&&(_=e,e=r,r=_),o>h&&(_=o,o=h,h=_),e<h&&o<r},a.Clipper.prototype.SetHoleState=function(e,r){for(var o=e.PrevInAEL,h=null;o!==null;)o.OutIdx>=0&&o.WindDelta!==0&&(h===null?h=o:h.OutIdx===o.OutIdx&&(h=null)),o=o.PrevInAEL;h===null?(r.FirstLeft=null,r.IsHole=!1):(r.FirstLeft=this.m_PolyOuts[h.OutIdx],r.IsHole=!r.FirstLeft.IsHole)},a.Clipper.prototype.GetDx=function(e,r){return e.Y===r.Y?a.ClipperBase.horizontal:(r.X-e.X)/(r.Y-e.Y)},a.Clipper.prototype.FirstIsBottomPt=function(e,r){for(var o=e.Prev;a.IntPoint.op_Equality(o.Pt,e.Pt)&&o!==e;)o=o.Prev;var h=Math.abs(this.GetDx(e.Pt,o.Pt));for(o=e.Next;a.IntPoint.op_Equality(o.Pt,e.Pt)&&o!==e;)o=o.Next;var _=Math.abs(this.GetDx(e.Pt,o.Pt));for(o=r.Prev;a.IntPoint.op_Equality(o.Pt,r.Pt)&&o!==r;)o=o.Prev;var I=Math.abs(this.GetDx(r.Pt,o.Pt));for(o=r.Next;a.IntPoint.op_Equality(o.Pt,r.Pt)&&o!==r;)o=o.Next;var N=Math.abs(this.GetDx(r.Pt,o.Pt));return Math.max(h,_)===Math.max(I,N)&&Math.min(h,_)===Math.min(I,N)?this.Area(e)>0:h>=I&&h>=N||_>=I&&_>=N},a.Clipper.prototype.GetBottomPt=function(e){for(var r=null,o=e.Next;o!==e;)o.Pt.Y>e.Pt.Y?(e=o,r=null):o.Pt.Y===e.Pt.Y&&o.Pt.X<=e.Pt.X&&(o.Pt.X<e.Pt.X?(r=null,e=o):o.Next!==e&&o.Prev!==e&&(r=o)),o=o.Next;if(r!==null)for(;r!==o;)for(this.FirstIsBottomPt(o,r)||(e=r),r=r.Next;a.IntPoint.op_Inequality(r.Pt,e.Pt);)r=r.Next;return e},a.Clipper.prototype.GetLowermostRec=function(e,r){e.BottomPt===null&&(e.BottomPt=this.GetBottomPt(e.Pts)),r.BottomPt===null&&(r.BottomPt=this.GetBottomPt(r.Pts));var o=e.BottomPt,h=r.BottomPt;return o.Pt.Y>h.Pt.Y?e:o.Pt.Y<h.Pt.Y?r:o.Pt.X<h.Pt.X?e:o.Pt.X>h.Pt.X||o.Next===o?r:h.Next===h||this.FirstIsBottomPt(o,h)?e:r},a.Clipper.prototype.OutRec1RightOfOutRec2=function(e,r){do if(e=e.FirstLeft,e===r)return!0;while(e!==null);return!1},a.Clipper.prototype.GetOutRec=function(e){for(var r=this.m_PolyOuts[e];r!==this.m_PolyOuts[r.Idx];)r=this.m_PolyOuts[r.Idx];return r},a.Clipper.prototype.AppendPolygon=function(e,r){var o=this.m_PolyOuts[e.OutIdx],h=this.m_PolyOuts[r.OutIdx],_;this.OutRec1RightOfOutRec2(o,h)?_=h:this.OutRec1RightOfOutRec2(h,o)?_=o:_=this.GetLowermostRec(o,h);var I=o.Pts,N=I.Prev,F=h.Pts,R=F.Prev;e.Side===a.EdgeSide.esLeft?r.Side===a.EdgeSide.esLeft?(this.ReversePolyPtLinks(F),F.Next=I,I.Prev=F,N.Next=R,R.Prev=N,o.Pts=R):(R.Next=I,I.Prev=R,F.Prev=N,N.Next=F,o.Pts=F):r.Side===a.EdgeSide.esRight?(this.ReversePolyPtLinks(F),N.Next=R,R.Prev=N,F.Next=I,I.Prev=F):(N.Next=F,F.Prev=N,I.Prev=R,R.Next=I),o.BottomPt=null,_===h&&(h.FirstLeft!==o&&(o.FirstLeft=h.FirstLeft),o.IsHole=h.IsHole),h.Pts=null,h.BottomPt=null,h.FirstLeft=o;var K=e.OutIdx,st=r.OutIdx;e.OutIdx=-1,r.OutIdx=-1;for(var et=this.m_ActiveEdges;et!==null;){if(et.OutIdx===st){et.OutIdx=K,et.Side=e.Side;break}et=et.NextInAEL}h.Idx=o.Idx},a.Clipper.prototype.ReversePolyPtLinks=function(e){if(e!==null){var r,o;r=e;do o=r.Next,r.Next=r.Prev,r.Prev=o,r=o;while(r!==e)}},a.Clipper.SwapSides=function(e,r){var o=e.Side;e.Side=r.Side,r.Side=o},a.Clipper.SwapPolyIndexes=function(e,r){var o=e.OutIdx;e.OutIdx=r.OutIdx,r.OutIdx=o},a.Clipper.prototype.IntersectEdges=function(e,r,o){var h=e.OutIdx>=0,_=r.OutIdx>=0;if(a.use_xyz&&this.SetZ(o,e,r),a.use_lines&&(e.WindDelta===0||r.WindDelta===0)){if(e.WindDelta===0&&r.WindDelta===0)return;e.PolyTyp===r.PolyTyp&&e.WindDelta!==r.WindDelta&&this.m_ClipType===a.ClipType.ctUnion?e.WindDelta===0?_&&(this.AddOutPt(e,o),h&&(e.OutIdx=-1)):h&&(this.AddOutPt(r,o),_&&(r.OutIdx=-1)):e.PolyTyp!==r.PolyTyp&&(e.WindDelta===0&&Math.abs(r.WindCnt)===1&&(this.m_ClipType!==a.ClipType.ctUnion||r.WindCnt2===0)?(this.AddOutPt(e,o),h&&(e.OutIdx=-1)):r.WindDelta===0&&Math.abs(e.WindCnt)===1&&(this.m_ClipType!==a.ClipType.ctUnion||e.WindCnt2===0)&&(this.AddOutPt(r,o),_&&(r.OutIdx=-1)));return}if(e.PolyTyp===r.PolyTyp)if(this.IsEvenOddFillType(e)){var I=e.WindCnt;e.WindCnt=r.WindCnt,r.WindCnt=I}else e.WindCnt+r.WindDelta===0?e.WindCnt=-e.WindCnt:e.WindCnt+=r.WindDelta,r.WindCnt-e.WindDelta===0?r.WindCnt=-r.WindCnt:r.WindCnt-=e.WindDelta;else this.IsEvenOddFillType(r)?e.WindCnt2=e.WindCnt2===0?1:0:e.WindCnt2+=r.WindDelta,this.IsEvenOddFillType(e)?r.WindCnt2=r.WindCnt2===0?1:0:r.WindCnt2-=e.WindDelta;var N,F,R,K;e.PolyTyp===a.PolyType.ptSubject?(N=this.m_SubjFillType,R=this.m_ClipFillType):(N=this.m_ClipFillType,R=this.m_SubjFillType),r.PolyTyp===a.PolyType.ptSubject?(F=this.m_SubjFillType,K=this.m_ClipFillType):(F=this.m_ClipFillType,K=this.m_SubjFillType);var st,et;switch(N){case a.PolyFillType.pftPositive:st=e.WindCnt;break;case a.PolyFillType.pftNegative:st=-e.WindCnt;break;default:st=Math.abs(e.WindCnt);break}switch(F){case a.PolyFillType.pftPositive:et=r.WindCnt;break;case a.PolyFillType.pftNegative:et=-r.WindCnt;break;default:et=Math.abs(r.WindCnt);break}if(h&&_)st!==0&&st!==1||et!==0&&et!==1||e.PolyTyp!==r.PolyTyp&&this.m_ClipType!==a.ClipType.ctXor?this.AddLocalMaxPoly(e,r,o):(this.AddOutPt(e,o),this.AddOutPt(r,o),a.Clipper.SwapSides(e,r),a.Clipper.SwapPolyIndexes(e,r));else if(h)(et===0||et===1)&&(this.AddOutPt(e,o),a.Clipper.SwapSides(e,r),a.Clipper.SwapPolyIndexes(e,r));else if(_)(st===0||st===1)&&(this.AddOutPt(r,o),a.Clipper.SwapSides(e,r),a.Clipper.SwapPolyIndexes(e,r));else if((st===0||st===1)&&(et===0||et===1)){var ot,vt;switch(R){case a.PolyFillType.pftPositive:ot=e.WindCnt2;break;case a.PolyFillType.pftNegative:ot=-e.WindCnt2;break;default:ot=Math.abs(e.WindCnt2);break}switch(K){case a.PolyFillType.pftPositive:vt=r.WindCnt2;break;case a.PolyFillType.pftNegative:vt=-r.WindCnt2;break;default:vt=Math.abs(r.WindCnt2);break}if(e.PolyTyp!==r.PolyTyp)this.AddLocalMinPoly(e,r,o);else if(st===1&&et===1)switch(this.m_ClipType){case a.ClipType.ctIntersection:ot>0&&vt>0&&this.AddLocalMinPoly(e,r,o);break;case a.ClipType.ctUnion:ot<=0&&vt<=0&&this.AddLocalMinPoly(e,r,o);break;case a.ClipType.ctDifference:(e.PolyTyp===a.PolyType.ptClip&&ot>0&&vt>0||e.PolyTyp===a.PolyType.ptSubject&&ot<=0&&vt<=0)&&this.AddLocalMinPoly(e,r,o);break;case a.ClipType.ctXor:this.AddLocalMinPoly(e,r,o);break}else a.Clipper.SwapSides(e,r)}},a.Clipper.prototype.DeleteFromSEL=function(e){var r=e.PrevInSEL,o=e.NextInSEL;r===null&&o===null&&e!==this.m_SortedEdges||(r!==null?r.NextInSEL=o:this.m_SortedEdges=o,o!==null&&(o.PrevInSEL=r),e.NextInSEL=null,e.PrevInSEL=null)},a.Clipper.prototype.ProcessHorizontals=function(){for(var e={};this.PopEdgeFromSEL(e);)this.ProcessHorizontal(e.v)},a.Clipper.prototype.GetHorzDirection=function(e,r){e.Bot.X<e.Top.X?(r.Left=e.Bot.X,r.Right=e.Top.X,r.Dir=a.Direction.dLeftToRight):(r.Left=e.Top.X,r.Right=e.Bot.X,r.Dir=a.Direction.dRightToLeft)},a.Clipper.prototype.ProcessHorizontal=function(e){var r={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,r);for(var o=r.Dir,h=r.Left,_=r.Right,I=e.WindDelta===0,N=e,F=null;N.NextInLML!==null&&a.ClipperBase.IsHorizontal(N.NextInLML);)N=N.NextInLML;N.NextInLML===null&&(F=this.GetMaximaPair(N));var R=this.m_Maxima;if(R!==null)if(o===a.Direction.dLeftToRight){for(;R!==null&&R.X<=e.Bot.X;)R=R.Next;R!==null&&R.X>=N.Top.X&&(R=null)}else{for(;R.Next!==null&&R.Next.X<e.Bot.X;)R=R.Next;R.X<=N.Top.X&&(R=null)}for(var K=null;;){for(var st=e===N,et=this.GetNextInAEL(e,o);et!==null;){if(R!==null)if(o===a.Direction.dLeftToRight)for(;R!==null&&R.X<et.Curr.X;)e.OutIdx>=0&&!I&&this.AddOutPt(e,new a.IntPoint2(R.X,e.Bot.Y)),R=R.Next;else for(;R!==null&&R.X>et.Curr.X;)e.OutIdx>=0&&!I&&this.AddOutPt(e,new a.IntPoint2(R.X,e.Bot.Y)),R=R.Prev;if(o===a.Direction.dLeftToRight&&et.Curr.X>_||o===a.Direction.dRightToLeft&&et.Curr.X<h||et.Curr.X===e.Top.X&&e.NextInLML!==null&&et.Dx<e.NextInLML.Dx)break;if(e.OutIdx>=0&&!I){a.use_xyz&&(o===a.Direction.dLeftToRight?this.SetZ(et.Curr,e,et):this.SetZ(et.Curr,et,e)),K=this.AddOutPt(e,et.Curr);for(var ot=this.m_SortedEdges;ot!==null;){if(ot.OutIdx>=0&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,ot.Bot.X,ot.Top.X)){var vt=this.GetLastOutPt(ot);this.AddJoin(vt,K,ot.Top)}ot=ot.NextInSEL}this.AddGhostJoin(K,e.Bot)}if(et===F&&st){e.OutIdx>=0&&this.AddLocalMaxPoly(e,F,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(F);return}if(o===a.Direction.dLeftToRight){var St=new a.IntPoint2(et.Curr.X,e.Curr.Y);this.IntersectEdges(e,et,St)}else{var St=new a.IntPoint2(et.Curr.X,e.Curr.Y);this.IntersectEdges(et,e,St)}var Tt=this.GetNextInAEL(et,o);this.SwapPositionsInAEL(e,et),et=Tt}if(e.NextInLML===null||!a.ClipperBase.IsHorizontal(e.NextInLML))break;e=this.UpdateEdgeIntoAEL(e),e.OutIdx>=0&&this.AddOutPt(e,e.Bot),r={Dir:o,Left:h,Right:_},this.GetHorzDirection(e,r),o=r.Dir,h=r.Left,_=r.Right}if(e.OutIdx>=0&&K===null){K=this.GetLastOutPt(e);for(var ot=this.m_SortedEdges;ot!==null;){if(ot.OutIdx>=0&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,ot.Bot.X,ot.Top.X)){var vt=this.GetLastOutPt(ot);this.AddJoin(vt,K,ot.Top)}ot=ot.NextInSEL}this.AddGhostJoin(K,e.Top)}if(e.NextInLML!==null)if(e.OutIdx>=0){if(K=this.AddOutPt(e,e.Top),e=this.UpdateEdgeIntoAEL(e),e.WindDelta===0)return;var kt=e.PrevInAEL,Tt=e.NextInAEL;if(kt!==null&&kt.Curr.X===e.Bot.X&&kt.Curr.Y===e.Bot.Y&&kt.WindDelta===0&&kt.OutIdx>=0&&kt.Curr.Y>kt.Top.Y&&a.ClipperBase.SlopesEqual3(e,kt,this.m_UseFullRange)){var vt=this.AddOutPt(kt,e.Bot);this.AddJoin(K,vt,e.Top)}else if(Tt!==null&&Tt.Curr.X===e.Bot.X&&Tt.Curr.Y===e.Bot.Y&&Tt.WindDelta!==0&&Tt.OutIdx>=0&&Tt.Curr.Y>Tt.Top.Y&&a.ClipperBase.SlopesEqual3(e,Tt,this.m_UseFullRange)){var vt=this.AddOutPt(Tt,e.Bot);this.AddJoin(K,vt,e.Top)}}else e=this.UpdateEdgeIntoAEL(e);else e.OutIdx>=0&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e)},a.Clipper.prototype.GetNextInAEL=function(e,r){return r===a.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL},a.Clipper.prototype.IsMinima=function(e){return e!==null&&e.Prev.NextInLML!==e&&e.Next.NextInLML!==e},a.Clipper.prototype.IsMaxima=function(e,r){return e!==null&&e.Top.Y===r&&e.NextInLML===null},a.Clipper.prototype.IsIntermediate=function(e,r){return e.Top.Y===r&&e.NextInLML!==null},a.Clipper.prototype.GetMaximaPair=function(e){return a.IntPoint.op_Equality(e.Next.Top,e.Top)&&e.Next.NextInLML===null?e.Next:a.IntPoint.op_Equality(e.Prev.Top,e.Top)&&e.Prev.NextInLML===null?e.Prev:null},a.Clipper.prototype.GetMaximaPairEx=function(e){var r=this.GetMaximaPair(e);return r===null||r.OutIdx===a.ClipperBase.Skip||r.NextInAEL===r.PrevInAEL&&!a.ClipperBase.IsHorizontal(r)?null:r},a.Clipper.prototype.ProcessIntersections=function(e){if(this.m_ActiveEdges===null)return!0;try{if(this.BuildIntersectList(e),this.m_IntersectList.length===0)return!0;if(this.m_IntersectList.length===1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,a.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},a.Clipper.prototype.BuildIntersectList=function(e){if(this.m_ActiveEdges!==null){var r=this.m_ActiveEdges;for(this.m_SortedEdges=r;r!==null;)r.PrevInSEL=r.PrevInAEL,r.NextInSEL=r.NextInAEL,r.Curr.X=a.Clipper.TopX(r,e),r=r.NextInAEL;for(var o=!0;o&&this.m_SortedEdges!==null;){for(o=!1,r=this.m_SortedEdges;r.NextInSEL!==null;){var h=r.NextInSEL,_=new a.IntPoint0;if(r.Curr.X>h.Curr.X){this.IntersectPoint(r,h,_),_.Y<e&&(_=new a.IntPoint2(a.Clipper.TopX(r,e),e));var I=new a.IntersectNode;I.Edge1=r,I.Edge2=h,I.Pt.X=_.X,I.Pt.Y=_.Y,a.use_xyz&&(I.Pt.Z=_.Z),this.m_IntersectList.push(I),this.SwapPositionsInSEL(r,h),o=!0}else r=h}if(r.PrevInSEL!==null)r.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},a.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL===e.Edge2||e.Edge1.PrevInSEL===e.Edge2},a.Clipper.IntersectNodeSort=function(e,r){return r.Pt.Y-e.Pt.Y},a.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var e=this.m_IntersectList.length,r=0;r<e;r++){if(!this.EdgesAdjacent(this.m_IntersectList[r])){for(var o=r+1;o<e&&!this.EdgesAdjacent(this.m_IntersectList[o]);)o++;if(o===e)return!1;var h=this.m_IntersectList[r];this.m_IntersectList[r]=this.m_IntersectList[o],this.m_IntersectList[o]=h}this.SwapPositionsInSEL(this.m_IntersectList[r].Edge1,this.m_IntersectList[r].Edge2)}return!0},a.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,r=this.m_IntersectList.length;e<r;e++){var o=this.m_IntersectList[e];this.IntersectEdges(o.Edge1,o.Edge2,o.Pt),this.SwapPositionsInAEL(o.Edge1,o.Edge2)}this.m_IntersectList.length=0};var fe=function(e){return e<0?Math.ceil(e-.5):Math.round(e)},pe=function(e){return e<0?Math.ceil(e-.5):Math.floor(e+.5)},Ae=function(e){return e<0?-Math.round(Math.abs(e)):Math.round(e)},Ce=function(e){return e<0?(e-=.5,e<-2147483648?Math.ceil(e):e|0):(e+=.5,e>2147483647?Math.floor(e):e|0)};A.msie?a.Clipper.Round=fe:A.chromium?a.Clipper.Round=Ae:A.safari?a.Clipper.Round=Ce:a.Clipper.Round=pe,a.Clipper.TopX=function(e,r){return r===e.Top.Y?e.Top.X:e.Bot.X+a.Clipper.Round(e.Dx*(r-e.Bot.Y))},a.Clipper.prototype.IntersectPoint=function(e,r,o){o.X=0,o.Y=0;var h,_;if(e.Dx===r.Dx){o.Y=e.Curr.Y,o.X=a.Clipper.TopX(e,o.Y);return}if(e.Delta.X===0)o.X=e.Bot.X,a.ClipperBase.IsHorizontal(r)?o.Y=r.Bot.Y:(_=r.Bot.Y-r.Bot.X/r.Dx,o.Y=a.Clipper.Round(o.X/r.Dx+_));else if(r.Delta.X===0)o.X=r.Bot.X,a.ClipperBase.IsHorizontal(e)?o.Y=e.Bot.Y:(h=e.Bot.Y-e.Bot.X/e.Dx,o.Y=a.Clipper.Round(o.X/e.Dx+h));else{h=e.Bot.X-e.Bot.Y*e.Dx,_=r.Bot.X-r.Bot.Y*r.Dx;var I=(_-h)/(e.Dx-r.Dx);o.Y=a.Clipper.Round(I),Math.abs(e.Dx)<Math.abs(r.Dx)?o.X=a.Clipper.Round(e.Dx*I+h):o.X=a.Clipper.Round(r.Dx*I+_)}if(o.Y<e.Top.Y||o.Y<r.Top.Y){if(e.Top.Y>r.Top.Y)return o.Y=e.Top.Y,o.X=a.Clipper.TopX(r,e.Top.Y),o.X<e.Top.X;o.Y=r.Top.Y,Math.abs(e.Dx)<Math.abs(r.Dx)?o.X=a.Clipper.TopX(e,o.Y):o.X=a.Clipper.TopX(r,o.Y)}o.Y>e.Curr.Y&&(o.Y=e.Curr.Y,Math.abs(e.Dx)>Math.abs(r.Dx)?o.X=a.Clipper.TopX(r,o.Y):o.X=a.Clipper.TopX(e,o.Y))},a.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var r=this.m_ActiveEdges;r!==null;){var o=this.IsMaxima(r,e);if(o){var h=this.GetMaximaPairEx(r);o=h===null||!a.ClipperBase.IsHorizontal(h)}if(o){this.StrictlySimple&&this.InsertMaxima(r.Top.X);var _=r.PrevInAEL;this.DoMaxima(r),_===null?r=this.m_ActiveEdges:r=_.NextInAEL}else{if(this.IsIntermediate(r,e)&&a.ClipperBase.IsHorizontal(r.NextInLML)?(r=this.UpdateEdgeIntoAEL(r),r.OutIdx>=0&&this.AddOutPt(r,r.Bot),this.AddEdgeToSEL(r)):(r.Curr.X=a.Clipper.TopX(r,e),r.Curr.Y=e),a.use_xyz&&(r.Top.Y===e?r.Curr.Z=r.Top.Z:r.Bot.Y===e?r.Curr.Z=r.Bot.Z:r.Curr.Z=0),this.StrictlySimple){var _=r.PrevInAEL;if(r.OutIdx>=0&&r.WindDelta!==0&&_!==null&&_.OutIdx>=0&&_.Curr.X===r.Curr.X&&_.WindDelta!==0){var I=new a.IntPoint1(r.Curr);a.use_xyz&&this.SetZ(I,_,r);var N=this.AddOutPt(_,I),F=this.AddOutPt(r,I);this.AddJoin(N,F,I)}}r=r.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,r=this.m_ActiveEdges;r!==null;){if(this.IsIntermediate(r,e)){var N=null;r.OutIdx>=0&&(N=this.AddOutPt(r,r.Top)),r=this.UpdateEdgeIntoAEL(r);var _=r.PrevInAEL,R=r.NextInAEL;if(_!==null&&_.Curr.X===r.Bot.X&&_.Curr.Y===r.Bot.Y&&N!==null&&_.OutIdx>=0&&_.Curr.Y===_.Top.Y&&a.ClipperBase.SlopesEqual5(r.Curr,r.Top,_.Curr,_.Top,this.m_UseFullRange)&&r.WindDelta!==0&&_.WindDelta!==0){var F=this.AddOutPt(ePrev2,r.Bot);this.AddJoin(N,F,r.Top)}else if(R!==null&&R.Curr.X===r.Bot.X&&R.Curr.Y===r.Bot.Y&&N!==null&&R.OutIdx>=0&&R.Curr.Y===R.Top.Y&&a.ClipperBase.SlopesEqual5(r.Curr,r.Top,R.Curr,R.Top,this.m_UseFullRange)&&r.WindDelta!==0&&R.WindDelta!==0){var F=this.AddOutPt(R,r.Bot);this.AddJoin(N,F,r.Top)}}r=r.NextInAEL}},a.Clipper.prototype.DoMaxima=function(e){var r=this.GetMaximaPairEx(e);if(r===null){e.OutIdx>=0&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e);return}for(var o=e.NextInAEL;o!==null&&o!==r;)this.IntersectEdges(e,o,e.Top),this.SwapPositionsInAEL(e,o),o=e.NextInAEL;e.OutIdx===-1&&r.OutIdx===-1?(this.DeleteFromAEL(e),this.DeleteFromAEL(r)):e.OutIdx>=0&&r.OutIdx>=0?(e.OutIdx>=0&&this.AddLocalMaxPoly(e,r,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(r)):a.use_lines&&e.WindDelta===0?(e.OutIdx>=0&&(this.AddOutPt(e,e.Top),e.OutIdx=a.ClipperBase.Unassigned),this.DeleteFromAEL(e),r.OutIdx>=0&&(this.AddOutPt(r,e.Top),r.OutIdx=a.ClipperBase.Unassigned),this.DeleteFromAEL(r)):a.Error("DoMaxima error")},a.Clipper.ReversePaths=function(e){for(var r=0,o=e.length;r<o;r++)e[r].reverse()},a.Clipper.Orientation=function(e){return a.Clipper.Area(e)>=0},a.Clipper.prototype.PointCount=function(e){if(e===null)return 0;var r=0,o=e;do r++,o=o.Next;while(o!==e);return r},a.Clipper.prototype.BuildResult=function(e){a.Clear(e);for(var r=0,o=this.m_PolyOuts.length;r<o;r++){var h=this.m_PolyOuts[r];if(h.Pts!==null){var _=h.Pts.Prev,I=this.PointCount(_);if(!(I<2)){for(var N=new Array(I),F=0;F<I;F++)N[F]=_.Pt,_=_.Prev;e.push(N)}}}},a.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var r=0,o=this.m_PolyOuts.length;r<o;r++){var h=this.m_PolyOuts[r],_=this.PointCount(h.Pts);if(!(h.IsOpen&&_<2||!h.IsOpen&&_<3)){this.FixHoleLinkage(h);var I=new a.PolyNode;e.m_AllPolys.push(I),h.PolyNode=I,I.m_polygon.length=_;for(var N=h.Pts.Prev,F=0;F<_;F++)I.m_polygon[F]=N.Pt,N=N.Prev}}for(var r=0,o=this.m_PolyOuts.length;r<o;r++){var h=this.m_PolyOuts[r];h.PolyNode!==null&&(h.IsOpen?(h.PolyNode.IsOpen=!0,e.AddChild(h.PolyNode)):h.FirstLeft!==null&&h.FirstLeft.PolyNode!==null?h.FirstLeft.PolyNode.AddChild(h.PolyNode):e.AddChild(h.PolyNode))}},a.Clipper.prototype.FixupOutPolyline=function(e){for(var r=e.Pts,o=r.Prev;r!==o;)if(r=r.Next,a.IntPoint.op_Equality(r.Pt,r.Prev.Pt)){r===o&&(o=r.Prev);var h=r.Prev;h.Next=r.Next,r.Next.Prev=h,r=h}r===r.Prev&&(e.Pts=null)},a.Clipper.prototype.FixupOutPolygon=function(e){var r=null;e.BottomPt=null;for(var o=e.Pts,h=this.PreserveCollinear||this.StrictlySimple;;){if(o.Prev===o||o.Prev===o.Next){e.Pts=null;return}if(a.IntPoint.op_Equality(o.Pt,o.Next.Pt)||a.IntPoint.op_Equality(o.Pt,o.Prev.Pt)||a.ClipperBase.SlopesEqual4(o.Prev.Pt,o.Pt,o.Next.Pt,this.m_UseFullRange)&&(!h||!this.Pt2IsBetweenPt1AndPt3(o.Prev.Pt,o.Pt,o.Next.Pt)))r=null,o.Prev.Next=o.Next,o.Next.Prev=o.Prev,o=o.Prev;else{if(o===r)break;r===null&&(r=o),o=o.Next}}e.Pts=o},a.Clipper.prototype.DupOutPt=function(e,r){var o=new a.OutPt;return o.Pt.X=e.Pt.X,o.Pt.Y=e.Pt.Y,a.use_xyz&&(o.Pt.Z=e.Pt.Z),o.Idx=e.Idx,r?(o.Next=e.Next,o.Prev=e,e.Next.Prev=o,e.Next=o):(o.Prev=e.Prev,o.Next=e,e.Prev.Next=o,e.Prev=o),o},a.Clipper.prototype.GetOverlap=function(e,r,o,h,_){return e<r?o<h?(_.Left=Math.max(e,o),_.Right=Math.min(r,h)):(_.Left=Math.max(e,h),_.Right=Math.min(r,o)):o<h?(_.Left=Math.max(r,o),_.Right=Math.min(e,h)):(_.Left=Math.max(r,h),_.Right=Math.min(e,o)),_.Left<_.Right},a.Clipper.prototype.JoinHorz=function(e,r,o,h,_,I){var N=e.Pt.X>r.Pt.X?a.Direction.dRightToLeft:a.Direction.dLeftToRight,F=o.Pt.X>h.Pt.X?a.Direction.dRightToLeft:a.Direction.dLeftToRight;if(N===F)return!1;if(N===a.Direction.dLeftToRight){for(;e.Next.Pt.X<=_.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y===_.Y;)e=e.Next;I&&e.Pt.X!==_.X&&(e=e.Next),r=this.DupOutPt(e,!I),a.IntPoint.op_Inequality(r.Pt,_)&&(e=r,e.Pt.X=_.X,e.Pt.Y=_.Y,a.use_xyz&&(e.Pt.Z=_.Z),r=this.DupOutPt(e,!I))}else{for(;e.Next.Pt.X>=_.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y===_.Y;)e=e.Next;!I&&e.Pt.X!==_.X&&(e=e.Next),r=this.DupOutPt(e,I),a.IntPoint.op_Inequality(r.Pt,_)&&(e=r,e.Pt.X=_.X,e.Pt.Y=_.Y,a.use_xyz&&(e.Pt.Z=_.Z),r=this.DupOutPt(e,I))}if(F===a.Direction.dLeftToRight){for(;o.Next.Pt.X<=_.X&&o.Next.Pt.X>=o.Pt.X&&o.Next.Pt.Y===_.Y;)o=o.Next;I&&o.Pt.X!==_.X&&(o=o.Next),h=this.DupOutPt(o,!I),a.IntPoint.op_Inequality(h.Pt,_)&&(o=h,o.Pt.X=_.X,o.Pt.Y=_.Y,a.use_xyz&&(o.Pt.Z=_.Z),h=this.DupOutPt(o,!I))}else{for(;o.Next.Pt.X>=_.X&&o.Next.Pt.X<=o.Pt.X&&o.Next.Pt.Y===_.Y;)o=o.Next;!I&&o.Pt.X!==_.X&&(o=o.Next),h=this.DupOutPt(o,I),a.IntPoint.op_Inequality(h.Pt,_)&&(o=h,o.Pt.X=_.X,o.Pt.Y=_.Y,a.use_xyz&&(o.Pt.Z=_.Z),h=this.DupOutPt(o,I))}return N===a.Direction.dLeftToRight===I?(e.Prev=o,o.Next=e,r.Next=h,h.Prev=r):(e.Next=o,o.Prev=e,r.Prev=h,h.Next=r),!0},a.Clipper.prototype.JoinPoints=function(e,r,o){var h=e.OutPt1,_=new a.OutPt,I=e.OutPt2,N=new a.OutPt,F=e.OutPt1.Pt.Y===e.OffPt.Y;if(F&&a.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&a.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(r!==o)return!1;for(_=e.OutPt1.Next;_!==h&&a.IntPoint.op_Equality(_.Pt,e.OffPt);)_=_.Next;var R=_.Pt.Y>e.OffPt.Y;for(N=e.OutPt2.Next;N!==I&&a.IntPoint.op_Equality(N.Pt,e.OffPt);)N=N.Next;var K=N.Pt.Y>e.OffPt.Y;return R===K?!1:R?(_=this.DupOutPt(h,!1),N=this.DupOutPt(I,!0),h.Prev=I,I.Next=h,_.Next=N,N.Prev=_,e.OutPt1=h,e.OutPt2=_,!0):(_=this.DupOutPt(h,!0),N=this.DupOutPt(I,!1),h.Next=I,I.Prev=h,_.Prev=N,N.Next=_,e.OutPt1=h,e.OutPt2=_,!0)}else if(F){for(_=h;h.Prev.Pt.Y===h.Pt.Y&&h.Prev!==_&&h.Prev!==I;)h=h.Prev;for(;_.Next.Pt.Y===_.Pt.Y&&_.Next!==h&&_.Next!==I;)_=_.Next;if(_.Next===h||_.Next===I)return!1;for(N=I;I.Prev.Pt.Y===I.Pt.Y&&I.Prev!==N&&I.Prev!==_;)I=I.Prev;for(;N.Next.Pt.Y===N.Pt.Y&&N.Next!==I&&N.Next!==h;)N=N.Next;if(N.Next===I||N.Next===h)return!1;var st={Left:null,Right:null};if(!this.GetOverlap(h.Pt.X,_.Pt.X,I.Pt.X,N.Pt.X,st))return!1;var et=st.Left,ot=st.Right,vt=new a.IntPoint0,St;return h.Pt.X>=et&&h.Pt.X<=ot?(vt.X=h.Pt.X,vt.Y=h.Pt.Y,a.use_xyz&&(vt.Z=h.Pt.Z),St=h.Pt.X>_.Pt.X):I.Pt.X>=et&&I.Pt.X<=ot?(vt.X=I.Pt.X,vt.Y=I.Pt.Y,a.use_xyz&&(vt.Z=I.Pt.Z),St=I.Pt.X>N.Pt.X):_.Pt.X>=et&&_.Pt.X<=ot?(vt.X=_.Pt.X,vt.Y=_.Pt.Y,a.use_xyz&&(vt.Z=_.Pt.Z),St=_.Pt.X>h.Pt.X):(vt.X=N.Pt.X,vt.Y=N.Pt.Y,a.use_xyz&&(vt.Z=N.Pt.Z),St=N.Pt.X>I.Pt.X),e.OutPt1=h,e.OutPt2=I,this.JoinHorz(h,_,I,N,vt,St)}else{for(_=h.Next;a.IntPoint.op_Equality(_.Pt,h.Pt)&&_!==h;)_=_.Next;var Tt=_.Pt.Y>h.Pt.Y||!a.ClipperBase.SlopesEqual4(h.Pt,_.Pt,e.OffPt,this.m_UseFullRange);if(Tt){for(_=h.Prev;a.IntPoint.op_Equality(_.Pt,h.Pt)&&_!==h;)_=_.Prev;if(_.Pt.Y>h.Pt.Y||!a.ClipperBase.SlopesEqual4(h.Pt,_.Pt,e.OffPt,this.m_UseFullRange))return!1}for(N=I.Next;a.IntPoint.op_Equality(N.Pt,I.Pt)&&N!==I;)N=N.Next;var kt=N.Pt.Y>I.Pt.Y||!a.ClipperBase.SlopesEqual4(I.Pt,N.Pt,e.OffPt,this.m_UseFullRange);if(kt){for(N=I.Prev;a.IntPoint.op_Equality(N.Pt,I.Pt)&&N!==I;)N=N.Prev;if(N.Pt.Y>I.Pt.Y||!a.ClipperBase.SlopesEqual4(I.Pt,N.Pt,e.OffPt,this.m_UseFullRange))return!1}return _===h||N===I||_===N||r===o&&Tt===kt?!1:Tt?(_=this.DupOutPt(h,!1),N=this.DupOutPt(I,!0),h.Prev=I,I.Next=h,_.Next=N,N.Prev=_,e.OutPt1=h,e.OutPt2=_,!0):(_=this.DupOutPt(h,!0),N=this.DupOutPt(I,!1),h.Next=I,I.Prev=h,_.Prev=N,N.Next=_,e.OutPt1=h,e.OutPt2=_,!0)}},a.Clipper.GetBounds=function(e){for(var r=0,o=e.length;r<o&&e[r].length===0;)r++;if(r===o)return new a.IntRect(0,0,0,0);var h=new a.IntRect;for(h.left=e[r][0].X,h.right=h.left,h.top=e[r][0].Y,h.bottom=h.top;r<o;r++)for(var _=0,I=e[r].length;_<I;_++)e[r][_].X<h.left?h.left=e[r][_].X:e[r][_].X>h.right&&(h.right=e[r][_].X),e[r][_].Y<h.top?h.top=e[r][_].Y:e[r][_].Y>h.bottom&&(h.bottom=e[r][_].Y);return h},a.Clipper.prototype.GetBounds2=function(e){var r=e,o=new a.IntRect;for(o.left=e.Pt.X,o.right=e.Pt.X,o.top=e.Pt.Y,o.bottom=e.Pt.Y,e=e.Next;e!==r;)e.Pt.X<o.left&&(o.left=e.Pt.X),e.Pt.X>o.right&&(o.right=e.Pt.X),e.Pt.Y<o.top&&(o.top=e.Pt.Y),e.Pt.Y>o.bottom&&(o.bottom=e.Pt.Y),e=e.Next;return o},a.Clipper.PointInPolygon=function(e,r){var o=0,h=r.length;if(h<3)return 0;for(var _=r[0],I=1;I<=h;++I){var N=I===h?r[0]:r[I];if(N.Y===e.Y&&(N.X===e.X||_.Y===e.Y&&N.X>e.X==_.X<e.X))return-1;if(_.Y<e.Y!=N.Y<e.Y){if(_.X>=e.X)if(N.X>e.X)o=1-o;else{var F=(_.X-e.X)*(N.Y-e.Y)-(N.X-e.X)*(_.Y-e.Y);if(F===0)return-1;F>0==N.Y>_.Y&&(o=1-o)}else if(N.X>e.X){var F=(_.X-e.X)*(N.Y-e.Y)-(N.X-e.X)*(_.Y-e.Y);if(F===0)return-1;F>0==N.Y>_.Y&&(o=1-o)}}_=N}return o},a.Clipper.prototype.PointInPolygon=function(e,r){var o=0,h=r,_=e.X,I=e.Y,N=r.Pt.X,F=r.Pt.Y;do{r=r.Next;var R=r.Pt.X,K=r.Pt.Y;if(K===I&&(R===_||F===I&&R>_==N<_))return-1;if(F<I!=K<I){if(N>=_)if(R>_)o=1-o;else{var st=(N-_)*(K-I)-(R-_)*(F-I);if(st===0)return-1;st>0==K>F&&(o=1-o)}else if(R>_){var st=(N-_)*(K-I)-(R-_)*(F-I);if(st===0)return-1;st>0==K>F&&(o=1-o)}}N=R,F=K}while(h!==r);return o},a.Clipper.prototype.Poly2ContainsPoly1=function(e,r){var o=e;do{var h=this.PointInPolygon(o.Pt,r);if(h>=0)return h>0;o=o.Next}while(o!==e);return!0},a.Clipper.prototype.FixupFirstLefts1=function(e,r){for(var o,h,_=0,I=this.m_PolyOuts.length;_<I;_++)o=this.m_PolyOuts[_],h=a.Clipper.ParseFirstLeft(o.FirstLeft),o.Pts!==null&&h===e&&this.Poly2ContainsPoly1(o.Pts,r.Pts)&&(o.FirstLeft=r)},a.Clipper.prototype.FixupFirstLefts2=function(e,r){for(var o=r.FirstLeft,h,_,I=0,N=this.m_PolyOuts.length;I<N;I++)h=this.m_PolyOuts[I],!(h.Pts===null||h===r||h===e)&&(_=a.Clipper.ParseFirstLeft(h.FirstLeft),!(_!==o&&_!==e&&_!==r)&&(this.Poly2ContainsPoly1(h.Pts,e.Pts)?h.FirstLeft=e:this.Poly2ContainsPoly1(h.Pts,r.Pts)?h.FirstLeft=r:(h.FirstLeft===e||h.FirstLeft===r)&&(h.FirstLeft=o)))},a.Clipper.prototype.FixupFirstLefts3=function(e,r){for(var o,h,_=0,I=this.m_PolyOuts.length;_<I;_++)o=this.m_PolyOuts[_],h=a.Clipper.ParseFirstLeft(o.FirstLeft),o.Pts!==null&&h===e&&(o.FirstLeft=r)},a.Clipper.ParseFirstLeft=function(e){for(;e!==null&&e.Pts===null;)e=e.FirstLeft;return e},a.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,r=this.m_Joins.length;e<r;e++){var o=this.m_Joins[e],h=this.GetOutRec(o.OutPt1.Idx),_=this.GetOutRec(o.OutPt2.Idx);if(!(h.Pts===null||_.Pts===null)&&!(h.IsOpen||_.IsOpen)){var I;h===_?I=h:this.OutRec1RightOfOutRec2(h,_)?I=_:this.OutRec1RightOfOutRec2(_,h)?I=h:I=this.GetLowermostRec(h,_),this.JoinPoints(o,h,_)&&(h===_?(h.Pts=o.OutPt1,h.BottomPt=null,_=this.CreateOutRec(),_.Pts=o.OutPt2,this.UpdateOutPtIdxs(_),this.Poly2ContainsPoly1(_.Pts,h.Pts)?(_.IsHole=!h.IsHole,_.FirstLeft=h,this.m_UsingPolyTree&&this.FixupFirstLefts2(_,h),(_.IsHole^this.ReverseSolution)==this.Area$1(_)>0&&this.ReversePolyPtLinks(_.Pts)):this.Poly2ContainsPoly1(h.Pts,_.Pts)?(_.IsHole=h.IsHole,h.IsHole=!_.IsHole,_.FirstLeft=h.FirstLeft,h.FirstLeft=_,this.m_UsingPolyTree&&this.FixupFirstLefts2(h,_),(h.IsHole^this.ReverseSolution)==this.Area$1(h)>0&&this.ReversePolyPtLinks(h.Pts)):(_.IsHole=h.IsHole,_.FirstLeft=h.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(h,_))):(_.Pts=null,_.BottomPt=null,_.Idx=h.Idx,h.IsHole=I.IsHole,I===_&&(h.FirstLeft=_.FirstLeft),_.FirstLeft=h,this.m_UsingPolyTree&&this.FixupFirstLefts3(_,h)))}}},a.Clipper.prototype.UpdateOutPtIdxs=function(e){var r=e.Pts;do r.Idx=e.Idx,r=r.Prev;while(r!==e.Pts)},a.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var r=this.m_PolyOuts[e++],o=r.Pts;if(!(o===null||r.IsOpen))do{for(var h=o.Next;h!==r.Pts;){if(a.IntPoint.op_Equality(o.Pt,h.Pt)&&h.Next!==o&&h.Prev!==o){var _=o.Prev,I=h.Prev;o.Prev=I,I.Next=o,h.Prev=_,_.Next=h,r.Pts=o;var N=this.CreateOutRec();N.Pts=h,this.UpdateOutPtIdxs(N),this.Poly2ContainsPoly1(N.Pts,r.Pts)?(N.IsHole=!r.IsHole,N.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(N,r)):this.Poly2ContainsPoly1(r.Pts,N.Pts)?(N.IsHole=r.IsHole,r.IsHole=!N.IsHole,N.FirstLeft=r.FirstLeft,r.FirstLeft=N,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,N)):(N.IsHole=r.IsHole,N.FirstLeft=r.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(r,N)),h=o}h=h.Next}o=o.Next}while(o!==r.Pts)}},a.Clipper.Area=function(e){if(!Array.isArray(e))return 0;var r=e.length;if(r<3)return 0;for(var o=0,h=0,_=r-1;h<r;++h)o+=(e[_].X+e[h].X)*(e[_].Y-e[h].Y),_=h;return-o*.5},a.Clipper.prototype.Area=function(e){var r=e;if(e===null)return 0;var o=0;do o=o+(e.Prev.Pt.X+e.Pt.X)*(e.Prev.Pt.Y-e.Pt.Y),e=e.Next;while(e!==r);return o*.5},a.Clipper.prototype.Area$1=function(e){return this.Area(e.Pts)},a.Clipper.SimplifyPolygon=function(e,r){var o=new Array,h=new a.Clipper(0);return h.StrictlySimple=!0,h.AddPath(e,a.PolyType.ptSubject,!0),h.Execute(a.ClipType.ctUnion,o,r,r),o},a.Clipper.SimplifyPolygons=function(e,r){typeof r>"u"&&(r=a.PolyFillType.pftEvenOdd);var o=new Array,h=new a.Clipper(0);return h.StrictlySimple=!0,h.AddPaths(e,a.PolyType.ptSubject,!0),h.Execute(a.ClipType.ctUnion,o,r,r),o},a.Clipper.DistanceSqrd=function(e,r){var o=e.X-r.X,h=e.Y-r.Y;return o*o+h*h},a.Clipper.DistanceFromLineSqrd=function(e,r,o){var h=r.Y-o.Y,_=o.X-r.X,I=h*r.X+_*r.Y;return I=h*e.X+_*e.Y-I,I*I/(h*h+_*_)},a.Clipper.SlopesNearCollinear=function(e,r,o,h){return Math.abs(e.X-r.X)>Math.abs(e.Y-r.Y)?e.X>r.X==e.X<o.X?a.Clipper.DistanceFromLineSqrd(e,r,o)<h:r.X>e.X==r.X<o.X?a.Clipper.DistanceFromLineSqrd(r,e,o)<h:a.Clipper.DistanceFromLineSqrd(o,e,r)<h:e.Y>r.Y==e.Y<o.Y?a.Clipper.DistanceFromLineSqrd(e,r,o)<h:r.Y>e.Y==r.Y<o.Y?a.Clipper.DistanceFromLineSqrd(r,e,o)<h:a.Clipper.DistanceFromLineSqrd(o,e,r)<h},a.Clipper.PointsAreClose=function(e,r,o){var h=e.X-r.X,_=e.Y-r.Y;return h*h+_*_<=o},a.Clipper.ExcludeOp=function(e){var r=e.Prev;return r.Next=e.Next,e.Next.Prev=r,r.Idx=0,r},a.Clipper.CleanPolygon=function(e,r){typeof r>"u"&&(r=1.415);var o=e.length;if(o===0)return new Array;for(var h=new Array(o),_=0;_<o;++_)h[_]=new a.OutPt;for(var _=0;_<o;++_)h[_].Pt=e[_],h[_].Next=h[(_+1)%o],h[_].Next.Prev=h[_],h[_].Idx=0;for(var I=r*r,N=h[0];N.Idx===0&&N.Next!==N.Prev;)a.Clipper.PointsAreClose(N.Pt,N.Prev.Pt,I)?(N=a.Clipper.ExcludeOp(N),o--):a.Clipper.PointsAreClose(N.Prev.Pt,N.Next.Pt,I)?(a.Clipper.ExcludeOp(N.Next),N=a.Clipper.ExcludeOp(N),o-=2):a.Clipper.SlopesNearCollinear(N.Prev.Pt,N.Pt,N.Next.Pt,I)?(N=a.Clipper.ExcludeOp(N),o--):(N.Idx=1,N=N.Next);o<3&&(o=0);for(var F=new Array(o),_=0;_<o;++_)F[_]=new a.IntPoint1(N.Pt),N=N.Next;return h=null,F},a.Clipper.CleanPolygons=function(e,r){for(var o=new Array(e.length),h=0,_=e.length;h<_;h++)o[h]=a.Clipper.CleanPolygon(e[h],r);return o},a.Clipper.Minkowski=function(e,r,o,h){var _=h?1:0,I=e.length,N=r.length,F=new Array;if(o)for(var R=0;R<N;R++){for(var K=new Array(I),st=0,et=e.length,ot=e[st];st<et;st++,ot=e[st])K[st]=new a.IntPoint2(r[R].X+ot.X,r[R].Y+ot.Y);F.push(K)}else for(var R=0;R<N;R++){for(var K=new Array(I),st=0,et=e.length,ot=e[st];st<et;st++,ot=e[st])K[st]=new a.IntPoint2(r[R].X-ot.X,r[R].Y-ot.Y);F.push(K)}for(var vt=new Array,R=0;R<N-1+_;R++)for(var st=0;st<I;st++){var St=new Array;St.push(F[R%N][st%I]),St.push(F[(R+1)%N][st%I]),St.push(F[(R+1)%N][(st+1)%I]),St.push(F[R%N][(st+1)%I]),a.Clipper.Orientation(St)||St.reverse(),vt.push(St)}return vt},a.Clipper.MinkowskiSum=function(e,r,o){if(r[0]instanceof Array){for(var _=r,N=new a.Paths,I=new a.Clipper,F=0;F<_.length;++F){var R=a.Clipper.Minkowski(e,_[F],!0,o);if(I.AddPaths(R,a.PolyType.ptSubject,!0),o){var h=a.Clipper.TranslatePath(_[F],e[0]);I.AddPath(h,a.PolyType.ptClip,!0)}}return I.Execute(a.ClipType.ctUnion,N,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),N}else{var h=r,_=a.Clipper.Minkowski(e,h,!0,o),I=new a.Clipper;return I.AddPaths(_,a.PolyType.ptSubject,!0),I.Execute(a.ClipType.ctUnion,_,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),_}},a.Clipper.TranslatePath=function(e,r){for(var o=new a.Path,h=0;h<e.length;h++)o.push(new a.IntPoint2(e[h].X+r.X,e[h].Y+r.Y));return o},a.Clipper.MinkowskiDiff=function(e,r){var o=a.Clipper.Minkowski(e,r,!1,!0),h=new a.Clipper;return h.AddPaths(o,a.PolyType.ptSubject,!0),h.Execute(a.ClipType.ctUnion,o,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),o},a.Clipper.PolyTreeToPaths=function(e){var r=new Array;return a.Clipper.AddPolyNodeToPaths(e,a.Clipper.NodeType.ntAny,r),r},a.Clipper.AddPolyNodeToPaths=function(e,r,o){var h=!0;switch(r){case a.Clipper.NodeType.ntOpen:return;case a.Clipper.NodeType.ntClosed:h=!e.IsOpen;break}e.m_polygon.length>0&&h&&o.push(e.m_polygon);for(var _=0,I=e.Childs(),N=I.length,F=I[_];_<N;_++,F=I[_])a.Clipper.AddPolyNodeToPaths(F,r,o)},a.Clipper.OpenPathsFromPolyTree=function(e){for(var r=new a.Paths,o=0,h=e.ChildCount();o<h;o++)e.Childs()[o].IsOpen&&r.push(e.Childs()[o].m_polygon);return r},a.Clipper.ClosedPathsFromPolyTree=function(e){var r=new a.Paths;return a.Clipper.AddPolyNodeToPaths(e,a.Clipper.NodeType.ntClosed,r),r},ve(a.Clipper,a.ClipperBase),a.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},a.ClipperOffset=function(e,r){typeof e>"u"&&(e=2),typeof r>"u"&&(r=a.ClipperOffset.def_arc_tolerance),this.m_destPolys=new a.Paths,this.m_srcPoly=new a.Path,this.m_destPoly=new a.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new a.IntPoint0,this.m_polyNodes=new a.PolyNode,this.MiterLimit=e,this.ArcTolerance=r,this.m_lowest.X=-1},a.ClipperOffset.two_pi=6.28318530717959,a.ClipperOffset.def_arc_tolerance=.25,a.ClipperOffset.prototype.Clear=function(){a.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},a.ClipperOffset.Round=a.Clipper.Round,a.ClipperOffset.prototype.AddPath=function(e,r,o){var h=e.length-1;if(!(h<0)){var _=new a.PolyNode;if(_.m_jointype=r,_.m_endtype=o,o===a.EndType.etClosedLine||o===a.EndType.etClosedPolygon)for(;h>0&&a.IntPoint.op_Equality(e[0],e[h]);)h--;_.m_polygon.push(e[0]);for(var I=0,N=0,F=1;F<=h;F++)a.IntPoint.op_Inequality(_.m_polygon[I],e[F])&&(I++,_.m_polygon.push(e[F]),(e[F].Y>_.m_polygon[N].Y||e[F].Y===_.m_polygon[N].Y&&e[F].X<_.m_polygon[N].X)&&(N=I));if(!(o===a.EndType.etClosedPolygon&&I<2)&&(this.m_polyNodes.AddChild(_),o===a.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new a.IntPoint2(this.m_polyNodes.ChildCount()-1,N);else{var R=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(_.m_polygon[N].Y>R.Y||_.m_polygon[N].Y===R.Y&&_.m_polygon[N].X<R.X)&&(this.m_lowest=new a.IntPoint2(this.m_polyNodes.ChildCount()-1,N))}}},a.ClipperOffset.prototype.AddPaths=function(e,r,o){for(var h=0,_=e.length;h<_;h++)this.AddPath(e[h],r,o)},a.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!a.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var r=this.m_polyNodes.Childs()[e];(r.m_endtype===a.EndType.etClosedPolygon||r.m_endtype===a.EndType.etClosedLine&&a.Clipper.Orientation(r.m_polygon))&&r.m_polygon.reverse()}else for(var e=0;e<this.m_polyNodes.ChildCount();e++){var r=this.m_polyNodes.Childs()[e];r.m_endtype===a.EndType.etClosedLine&&!a.Clipper.Orientation(r.m_polygon)&&r.m_polygon.reverse()}},a.ClipperOffset.GetUnitNormal=function(e,r){var o=r.X-e.X,h=r.Y-e.Y;if(o===0&&h===0)return new a.DoublePoint2(0,0);var _=1/Math.sqrt(o*o+h*h);return o*=_,h*=_,new a.DoublePoint2(h,-o)},a.ClipperOffset.prototype.DoOffset=function(e){if(this.m_destPolys=new Array,this.m_delta=e,a.ClipperBase.near_zero(e)){for(var r=0;r<this.m_polyNodes.ChildCount();r++){var o=this.m_polyNodes.Childs()[r];o.m_endtype===a.EndType.etClosedPolygon&&this.m_destPolys.push(o.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var h;this.ArcTolerance<=0?h=a.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*a.ClipperOffset.def_arc_tolerance?h=Math.abs(e)*a.ClipperOffset.def_arc_tolerance:h=this.ArcTolerance;var _=3.14159265358979/Math.acos(1-h/Math.abs(e));this.m_sin=Math.sin(a.ClipperOffset.two_pi/_),this.m_cos=Math.cos(a.ClipperOffset.two_pi/_),this.m_StepsPerRad=_/a.ClipperOffset.two_pi,e<0&&(this.m_sin=-this.m_sin);for(var r=0;r<this.m_polyNodes.ChildCount();r++){var o=this.m_polyNodes.Childs()[r];this.m_srcPoly=o.m_polygon;var I=this.m_srcPoly.length;if(!(I===0||e<=0&&(I<3||o.m_endtype!==a.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,I===1){if(o.m_jointype===a.JoinType.jtRound)for(var N=1,F=0,R=1;R<=_;R++){this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+N*e),a.ClipperOffset.Round(this.m_srcPoly[0].Y+F*e)));var K=N;N=N*this.m_cos-this.m_sin*F,F=K*this.m_sin+F*this.m_cos}else for(var N=-1,F=-1,R=0;R<4;++R)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+N*e),a.ClipperOffset.Round(this.m_srcPoly[0].Y+F*e))),N<0?N=1:F<0?F=1:N=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var R=0;R<I-1;R++)this.m_normals.push(a.ClipperOffset.GetUnitNormal(this.m_srcPoly[R],this.m_srcPoly[R+1]));if(o.m_endtype===a.EndType.etClosedLine||o.m_endtype===a.EndType.etClosedPolygon?this.m_normals.push(a.ClipperOffset.GetUnitNormal(this.m_srcPoly[I-1],this.m_srcPoly[0])):this.m_normals.push(new a.DoublePoint1(this.m_normals[I-2])),o.m_endtype===a.EndType.etClosedPolygon){for(var st=I-1,R=0;R<I;R++)st=this.OffsetPoint(R,st,o.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(o.m_endtype===a.EndType.etClosedLine){for(var st=I-1,R=0;R<I;R++)st=this.OffsetPoint(R,st,o.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var et=this.m_normals[I-1],R=I-1;R>0;R--)this.m_normals[R]=new a.DoublePoint2(-this.m_normals[R-1].X,-this.m_normals[R-1].Y);this.m_normals[0]=new a.DoublePoint2(-et.X,-et.Y),st=0;for(var R=I-1;R>=0;R--)st=this.OffsetPoint(R,st,o.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var st=0,R=1;R<I-1;++R)st=this.OffsetPoint(R,st,o.m_jointype);var ot;if(o.m_endtype===a.EndType.etOpenButt){var R=I-1;ot=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[R].X+this.m_normals[R].X*e),a.ClipperOffset.Round(this.m_srcPoly[R].Y+this.m_normals[R].Y*e)),this.m_destPoly.push(ot),ot=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[R].X-this.m_normals[R].X*e),a.ClipperOffset.Round(this.m_srcPoly[R].Y-this.m_normals[R].Y*e)),this.m_destPoly.push(ot)}else{var R=I-1;st=I-2,this.m_sinA=0,this.m_normals[R]=new a.DoublePoint2(-this.m_normals[R].X,-this.m_normals[R].Y),o.m_endtype===a.EndType.etOpenSquare?this.DoSquare(R,st):this.DoRound(R,st)}for(var R=I-1;R>0;R--)this.m_normals[R]=new a.DoublePoint2(-this.m_normals[R-1].X,-this.m_normals[R-1].Y);this.m_normals[0]=new a.DoublePoint2(-this.m_normals[1].X,-this.m_normals[1].Y),st=I-1;for(var R=st-1;R>0;--R)st=this.OffsetPoint(R,st,o.m_jointype);o.m_endtype===a.EndType.etOpenButt?(ot=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),a.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e)),this.m_destPoly.push(ot),ot=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*e),a.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(ot)):(st=1,this.m_sinA=0,o.m_endtype===a.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},a.ClipperOffset.prototype.Execute=function(){var e=arguments,r=e[0]instanceof a.PolyTree;if(r){var o=e[0],h=e[1];o.Clear(),this.FixOrientations(),this.DoOffset(h);var _=new a.Clipper(0);if(_.AddPaths(this.m_destPolys,a.PolyType.ptSubject,!0),h>0)_.Execute(a.ClipType.ctUnion,o,a.PolyFillType.pftPositive,a.PolyFillType.pftPositive);else{var I=a.Clipper.GetBounds(this.m_destPolys),N=new a.Path;if(N.push(new a.IntPoint2(I.left-10,I.bottom+10)),N.push(new a.IntPoint2(I.right+10,I.bottom+10)),N.push(new a.IntPoint2(I.right+10,I.top-10)),N.push(new a.IntPoint2(I.left-10,I.top-10)),_.AddPath(N,a.PolyType.ptSubject,!0),_.ReverseSolution=!0,_.Execute(a.ClipType.ctUnion,o,a.PolyFillType.pftNegative,a.PolyFillType.pftNegative),o.ChildCount()===1&&o.Childs()[0].ChildCount()>0){var F=o.Childs()[0];o.Childs()[0]=F.Childs()[0],o.Childs()[0].m_Parent=o;for(var R=1;R<F.ChildCount();R++)o.AddChild(F.Childs()[R])}else o.Clear()}}else{var o=e[0],h=e[1];a.Clear(o),this.FixOrientations(),this.DoOffset(h);var _=new a.Clipper(0);if(_.AddPaths(this.m_destPolys,a.PolyType.ptSubject,!0),h>0)_.Execute(a.ClipType.ctUnion,o,a.PolyFillType.pftPositive,a.PolyFillType.pftPositive);else{var I=a.Clipper.GetBounds(this.m_destPolys),N=new a.Path;N.push(new a.IntPoint2(I.left-10,I.bottom+10)),N.push(new a.IntPoint2(I.right+10,I.bottom+10)),N.push(new a.IntPoint2(I.right+10,I.top-10)),N.push(new a.IntPoint2(I.left-10,I.top-10)),_.AddPath(N,a.PolyType.ptSubject,!0),_.ReverseSolution=!0,_.Execute(a.ClipType.ctUnion,o,a.PolyFillType.pftNegative,a.PolyFillType.pftNegative),o.length>0&&o.splice(0,1)}}},a.ClipperOffset.prototype.OffsetPoint=function(e,r,o){if(this.m_sinA=this.m_normals[r].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[r].Y,Math.abs(this.m_sinA*this.m_delta)<1){var h=this.m_normals[r].X*this.m_normals[e].X+this.m_normals[e].Y*this.m_normals[r].Y;if(h>0)return this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[r].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[r].Y*this.m_delta))),r}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[r].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[r].Y*this.m_delta))),this.m_destPoly.push(new a.IntPoint1(this.m_srcPoly[e])),this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(o){case a.JoinType.jtMiter:{var _=1+(this.m_normals[e].X*this.m_normals[r].X+this.m_normals[e].Y*this.m_normals[r].Y);_>=this.m_miterLim?this.DoMiter(e,r,_):this.DoSquare(e,r);break}case a.JoinType.jtSquare:this.DoSquare(e,r);break;case a.JoinType.jtRound:this.DoRound(e,r);break}return r=e,r},a.ClipperOffset.prototype.DoSquare=function(e,r){var o=Math.tan(Math.atan2(this.m_sinA,this.m_normals[r].X*this.m_normals[e].X+this.m_normals[r].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[r].X-this.m_normals[r].Y*o)),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[r].Y+this.m_normals[r].X*o)))),this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[e].X+this.m_normals[e].Y*o)),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*o))))},a.ClipperOffset.prototype.DoMiter=function(e,r,o){var h=this.m_delta/o;this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[r].X+this.m_normals[e].X)*h),a.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[r].Y+this.m_normals[e].Y)*h)))},a.ClipperOffset.prototype.DoRound=function(e,r){for(var o=Math.atan2(this.m_sinA,this.m_normals[r].X*this.m_normals[e].X+this.m_normals[r].Y*this.m_normals[e].Y),h=Math.max(a.Cast_Int32(a.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(o))),1),_=this.m_normals[r].X,I=this.m_normals[r].Y,N,F=0;F<h;++F)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+_*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[e].Y+I*this.m_delta))),N=_,_=_*this.m_cos-this.m_sin*I,I=N*this.m_sin+I*this.m_cos;this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))},a.Error=function(e){try{throw new Error(e)}catch(r){alert(r.message)}},a.JS={},a.JS.AreaOfPolygon=function(e,r){return r||(r=1),a.Clipper.Area(e)/(r*r)},a.JS.AreaOfPolygons=function(e,r){r||(r=1);for(var o=0,h=0;h<e.length;h++)o+=a.Clipper.Area(e[h]);return o/(r*r)},a.JS.BoundsOfPath=function(e,r){return a.JS.BoundsOfPaths([e],r)},a.JS.BoundsOfPaths=function(e,r){r||(r=1);var o=a.Clipper.GetBounds(e);return o.left/=r,o.bottom/=r,o.right/=r,o.top/=r,o},a.JS.Clean=function(h,r){if(!(h instanceof Array))return[];var o=h[0]instanceof Array,h=a.JS.Clone(h);if(typeof r!="number"||r===null)return a.Error("Delta is not a number in Clean()."),h;if(h.length===0||h.length===1&&h[0].length===0||r<0)return h;o||(h=[h]);for(var _=h.length,I,N,F,R,K,st,et,ot=[],vt=0;vt<_;vt++)if(N=h[vt],I=N.length,I!==0){if(I<3){F=N,ot.push(F);continue}for(F=N,R=r*r,K=N[0],st=1,et=1;et<I;et++)(N[et].X-K.X)*(N[et].X-K.X)+(N[et].Y-K.Y)*(N[et].Y-K.Y)<=R||(F[st]=N[et],K=N[et],st++);K=N[st-1],(N[0].X-K.X)*(N[0].X-K.X)+(N[0].Y-K.Y)*(N[0].Y-K.Y)<=R&&st--,st<I&&F.splice(st,I-st),F.length&&ot.push(F)}return!o&&ot.length?ot=ot[0]:!o&&ot.length===0?ot=[]:o&&ot.length===0&&(ot=[[]]),ot},a.JS.Clone=function(e){if(!(e instanceof Array))return[];if(e.length===0)return[];if(e.length===1&&e[0].length===0)return[[]];var r=e[0]instanceof Array;r||(e=[e]);var o=e.length,h,_,I,N,F=new Array(o);for(_=0;_<o;_++){for(h=e[_].length,N=new Array(h),I=0;I<h;I++)N[I]={X:e[_][I].X,Y:e[_][I].Y};F[_]=N}return r||(F=F[0]),F},a.JS.Lighten=function(e,r){if(!(e instanceof Array))return[];if(typeof r!="number"||r===null)return a.Error("Tolerance is not a number in Lighten()."),a.JS.Clone(e);if(e.length===0||e.length===1&&e[0].length===0||r<0)return a.JS.Clone(e);var o=e[0]instanceof Array;o||(e=[e]);var h,_,I,N,F,R,K,st,et,ot,vt,St,Tt,kt,ae,ge,Ne,ii=e.length,Be=r*r,ke=[];for(h=0;h<ii;h++)if(I=e[h],R=I.length,R!==0){for(N=0;N<1e6;N++){for(F=[],R=I.length,I[R-1].X!==I[0].X||I[R-1].Y!==I[0].Y?(St=1,I.push({X:I[0].X,Y:I[0].Y}),R=I.length):St=0,vt=[],_=0;_<R-2;_++)K=I[_],et=I[_+1],st=I[_+2],ge=K.X,Ne=K.Y,Tt=st.X-ge,kt=st.Y-Ne,(Tt!==0||kt!==0)&&(ae=((et.X-ge)*Tt+(et.Y-Ne)*kt)/(Tt*Tt+kt*kt),ae>1?(ge=st.X,Ne=st.Y):ae>0&&(ge+=Tt*ae,Ne+=kt*ae)),Tt=et.X-ge,kt=et.Y-Ne,ot=Tt*Tt+kt*kt,ot<=Be&&(vt[_+1]=1,_++);for(F.push({X:I[0].X,Y:I[0].Y}),_=1;_<R-1;_++)vt[_]||F.push({X:I[_].X,Y:I[_].Y});if(F.push({X:I[R-1].X,Y:I[R-1].Y}),St&&I.pop(),vt.length)I=F;else break}R=F.length,F[R-1].X===F[0].X&&F[R-1].Y===F[0].Y&&F.pop(),F.length>2&&ke.push(F)}return o||(ke=ke[0]),typeof ke>"u"&&(ke=[]),ke},a.JS.PerimeterOfPath=function(e,r,o){if(typeof e>"u")return 0;var h=Math.sqrt,_=0,I,N,F=0,R=0,K=0,st=0,et=e.length;if(et<2)return 0;for(r&&(e[et]=e[0],et++);--et;)I=e[et],F=I.X,R=I.Y,N=e[et-1],K=N.X,st=N.Y,_+=h((F-K)*(F-K)+(R-st)*(R-st));return r&&e.pop(),_/o},a.JS.PerimeterOfPaths=function(e,r,o){o||(o=1);for(var h=0,_=0;_<e.length;_++)h+=a.JS.PerimeterOfPath(e[_],r,o);return h},a.JS.ScaleDownPath=function(e,r){var o,h;for(r||(r=1),o=e.length;o--;)h=e[o],h.X=h.X/r,h.Y=h.Y/r},a.JS.ScaleDownPaths=function(e,r){var o,h,_;for(r||(r=1),o=e.length;o--;)for(h=e[o].length;h--;)_=e[o][h],_.X=_.X/r,_.Y=_.Y/r},a.JS.ScaleUpPath=function(e,r){var o,h,_=Math.round;for(r||(r=1),o=e.length;o--;)h=e[o],h.X=_(h.X*r),h.Y=_(h.Y*r)},a.JS.ScaleUpPaths=function(e,r){var o,h,_,I=Math.round;for(r||(r=1),o=e.length;o--;)for(h=e[o].length;h--;)_=e[o][h],_.X=I(_.X*r),_.Y=I(_.Y*r)},a.ExPolygons=function(){return[]},a.ExPolygon=function(){this.outer=null,this.holes=null},a.JS.AddOuterPolyNodeToExPolygons=function(e,r){var o=new a.ExPolygon;o.outer=e.Contour();var h=e.Childs(),_=h.length;o.holes=new Array(_);var I,N,F,R,K,st;for(F=0;F<_;F++)for(I=h[F],o.holes[F]=I.Contour(),R=0,K=I.Childs(),st=K.length;R<st;R++)N=K[R],a.JS.AddOuterPolyNodeToExPolygons(N,r);r.push(o)},a.JS.ExPolygonsToPaths=function(e){var r,o,h,_,I=new a.Paths;for(r=0,h=e.length;r<h;r++)for(I.push(e[r].outer),o=0,_=e[r].holes.length;o<_;o++)I.push(e[r].holes[o]);return I},a.JS.PolyTreeToExPolygons=function(e){var r=new a.ExPolygons,o,h,_,I;for(h=0,_=e.Childs(),I=_.length;h<I;h++)o=_[h],a.JS.AddOuterPolyNodeToExPolygons(o,r);return r}})()})(Vi)),Vi.exports}var nr=ir();const Pi=fn(nr);class rr{constructor(a){this.canvas=a,this.backgroundLayer=new Nt.Layer,this.foregroundLayer=new Nt.Layer;const B=new Nt.Raster("./images/paper.jpg");B.position=Nt.view.center,B.scale(.4),B.sendToBack(),this.backgroundLayer.addChild(B),this.backgroundLayer.visible=!1,this.foregroundLayer.activate()}clearForeground(){this.foregroundLayer.removeChildren()}renderCurves(a,B=!0,J=null,G=null,A="rgba(0,150,255,0.2)",pt){let $=this.generateOffsetsVisibilityMap(a);this.clearForeground(),a.forEach((mt,Me)=>{const he=B&&Me===G;if(this.drawCurve(mt,he,J,pt),mt.offsetsData.length){const Dt=$[Me]||Array(mt.offsetsData.length).fill(!1);mt.offsetsData.forEach((we,Z)=>{!Dt[Z]||we.points.length<2||(this.drawOffset(we),this.fillBetweenCurveAndOffset(mt,we,A))})}}),Nt.view.update()}generateOffsetsVisibilityMap(a){const B={};return a.forEach((J,G)=>{J.offsetsData&&(B[G]=J.offsetsData.map(A=>!!A.visible))}),B}drawCurve(a,B=!0,J=null,G){const A=new Nt.Path({strokeColor:"#000",strokeWidth:a.strokeWidth||2});a.handles.forEach(pt=>{const $=new Nt.Segment(new Nt.Point(pt.segment.x,pt.segment.y),new Nt.Point(pt.handleIn.x,pt.handleIn.y),new Nt.Point(pt.handleOut.x,pt.handleOut.y));A.add($),B&&this._drawHandleCircles(pt,J,G)}),this._drawHandleLines(a,B)}_drawHandleCircles(a,B,J){const G=B?.data?.id===a.id||J?.data?.id===a.id?"#303030ff":"#c64343";this._makeCircle(new Nt.Point(a.segment.x,a.segment.y),G,a.id,"circle",a.inPointId,a.outPointId,3),this._makeCircle(new Nt.Point(a.segment.x+a.handleIn.x,a.segment.y+a.handleIn.y),"#303030ff",a.inPointId,"bezier_in",null,null,3),this._makeCircle(new Nt.Point(a.segment.x+a.handleOut.x,a.segment.y+a.handleOut.y),"#303030ff",a.outPointId,"bezier_out",null,null,3)}drawOffset(a){const B=new Nt.Path({strokeColor:"#c64343",strokeWidth:2});a.points.forEach(J=>B.add(new Nt.Point(J.x,J.y))),B.sendToBack()}fillBetweenCurveAndOffset(a,B,J){const G=new Nt.Path({fillColor:J});a.handles.forEach(A=>G.add(new Nt.Segment(new Nt.Point(A.segment.x,A.segment.y),new Nt.Point(A.handleIn.x,A.handleIn.y),new Nt.Point(A.handleOut.x,A.handleOut.y))));for(let A=B.points.length-1;A>=0;A--){const pt=B.points[A];G.add(new Nt.Point(pt.x,pt.y))}G.closed=!0,G.sendToBack()}setBackgroundVisibility(a){this.backgroundLayer.visible=!!a}_makeCircle(a,B,J,G,A=null,pt=null,$=4){const mt=new Nt.Path.Circle(a,$);return mt.fillColor=B,mt.data={type:G,id:J,inPointId:A,outPointId:pt},this.foregroundLayer.addChild(mt),mt}_drawHandleLines(a,B=!0){B&&a.handles.forEach(J=>{const G=new Nt.Point(J.segment.x,J.segment.y);[J.handleIn,J.handleOut].forEach(A=>{new Nt.Point(A.x,A.y),new Nt.Path.Line({from:G,to:G.add(A),strokeColor:"303030ff",strokeWidth:1,dashArray:[1,1]}).sendToBack()})})}exportAsImage(a="canvas.png",B=!0){if(!this.canvas)return;const J=document.createElement("canvas");J.width=this.canvas.width,J.height=this.canvas.height;const G=J.getContext("2d");B&&(G.fillStyle="#ffffff",G.fillRect(0,0,J.width,J.height)),G.drawImage(this.canvas,0,0);const A=J.toDataURL("image/png"),pt=document.createElement("a");pt.href=A,pt.download=a,pt.click()}}class sr{constructor(){this.elements={toggleHandles:document.getElementById("toggleHandlesCbx"),deletePointBtn:document.getElementById("deletePointBtn"),deleteCurveBtn:document.getElementById("deleteBtn"),addCurveBtn:document.getElementById("addCurveBtn"),curveSelect:document.getElementById("curveSelect"),addOffsetCheckbox:document.getElementById("offsetCbx"),exportBtn:document.getElementById("exportBtn"),toggleBackground:document.getElementById("toggleBackgroundCbx"),saveBtn:document.getElementById("saveBtn"),importBtn:document.getElementById("importBtn"),importFile:document.getElementById("importFile"),addOffsetBtn:document.getElementById("addOffsetBtn")},this.offsetElements=[]}_bindEvent(a,B,J){a&&a.addEventListener(B,J)}bindToggleBackground(a){this._bindEvent(this.elements.toggleBackground,"click",a)}bindHandlesToggle(a){this._bindEvent(this.elements.toggleHandles,"click",a)}bindAddCurve(a){this._bindEvent(this.elements.addCurveBtn,"click",a)}bindCurveSelect(a){this.elements.curveSelect&&this.elements.curveSelect.addEventListener("change",B=>{a(parseInt(B.target.value,10))})}bindDeletePoint(a){this._bindEvent(this.elements.deletePointBtn,"click",a)}bindDeleteCurve(a){this._bindEvent(this.elements.deleteCurveBtn,"click",a)}bindExport(a){this._bindEvent(this.elements.exportBtn,"click",a)}bindSave(a){this._bindEvent(this.elements.saveBtn,"click",a)}bindImportButton(a){this._bindEvent(this.elements.importBtn,"click",a)}bindAddOffsetBtn(a){this._bindEvent(this.elements.addOffsetBtn,"click",a)}bindImportFile(a){this._bindEvent(this.elements.importFile,"change",a)}bindOffsetAdd(a){this._bindEvent(this.elements.addOffsetCheckbox,"click",a)}bindOffsetSlider(a,B){const J=this.offsetElements[a-1];J?.slider&&J.slider.addEventListener("input",B)}bindOffsetCheckbox(a,B){const J=this.offsetElements[a-1];J?.checkbox&&J.checkbox.addEventListener("click",B)}bindDynamicOffsetControls(a,B,J){const G=document.getElementById("offsetControlsContainer");G&&(G.addEventListener("input",A=>{if(A.target.matches("input[type='range']")){const pt=parseInt(A.target.id.replace("offsetSlider",""),10),$=parseFloat(A.target.value);a(pt,$)}}),G.addEventListener("click",A=>{if(A.target.matches("input[type='checkbox']")&&A.target.id.startsWith("toggleOffset")){const pt=parseInt(A.target.id.replace("toggleOffset","").replace("Cbx",""),10),$=A.target.checked;B(pt,$)}}),G.addEventListener("click",A=>{if(A.target.matches("button")&&A.target.id.startsWith("removeOffsetBtn")){const pt=parseInt(A.target.id.replace("removeOffsetBtn",""),10);J(pt)}}))}updateBackgroundToggle(a){this.elements.toggleBackground&&(this.elements.toggleBackground.checked=a)}updateHandlesToggle(a){this.elements.toggleHandles&&(this.elements.toggleHandles.checked=a)}updateCurveList(a){const B=this.elements.curveSelect;B&&(B.innerHTML="",a.forEach((J,G)=>{const A=document.createElement("option");A.value=G,A.textContent=J.name,B.appendChild(A)}))}updateSelectedCurve(a){this.elements.curveSelect&&(this.elements.curveSelect.value=a)}updateOffsetValue(a,B){const J=this.offsetElements[a-1];J&&(J.slider&&(J.slider.value=B),J.valueDisplay&&(J.valueDisplay.textContent=B))}updateOffsetCheckbox(a,B){const J=this.offsetElements[a-1];J?.checkbox&&(J.checkbox.checked=B)}addOffsetControls(a){let B=this.offsetElements.length+1;const J=document.getElementById("offsetControlsContainer");if(!J||document.getElementById(`offsetSlider${B}`))return;const G=document.createElement("div");G.classList.add("slider-group"),G.innerHTML=`
 <button id="removeOffsetBtn${B}" class="remove-button" title="Supprimer l'offset ${B}">X</button>
                    <input type="checkbox" id="toggleOffset${B}Cbx">
                    <label for="offsetSlider">Offset&nbsp;${B}</label>
                    <input type="range" id="offsetSlider${B}" min="00" max="200" step="1">
                    <span id="offsetValue${B}">0</span>
  `,J.appendChild(G);const A={slider:document.getElementById(`offsetSlider${B}`),valueDisplay:document.getElementById(`offsetValue${B}`),checkbox:document.getElementById(`toggleOffset${B}Cbx`),remove:document.getElementById(`removeOffsetBtn${B}`)};this.offsetElements[B-1]=A}removeOffsetControls(a){const B=this.offsetElements[a-1];if(!B)return;const J=B.slider?.closest(".slider-group");J&&J.remove(),this.offsetElements.splice(a-1,1),this.offsetElements.forEach((G,A)=>{if(!G)return;G.slider.id=`offsetSlider${A+1}`,G.valueDisplay.id=`offsetValue${A+1}`,G.checkbox.id=`toggleOffset${A+1}Cbx`,G.remove.id=`removeOffsetBtn${A+1}`;const pt=G.slider?.closest(".slider-group")?.querySelector("label");pt&&(pt.innerHTML=`Offset&nbsp;${A+1}`)})}renderOffsetsControls(a){this.clearOffsetsControls(),document.getElementById("offsetControlsContainer")&&a.offsetsData.forEach((J,G)=>{this.addOffsetControls(G+1),this.updateOffsetValue(G+1,J.offset),this.updateOffsetCheckbox(G+1,J.visible)})}clearOffsetsControls(){this.offsetElements=[];const a=document.getElementById("offsetControlsContainer");a&&(a.innerHTML="<h2>Offsets</h2>")}}class ar{constructor(a,B){this.model=a,this.view=B,this.selectedItem=null,this.dragOffset=null,this.handlesVisible=!0,this.backgroundVisible=!1,this.offsetVisible=!0,this.hoveredItem=null,this.isDraggingCurve=!1,this.lastMousePos=null,this.renderScheduled=!1,this._setupTool()}_setupTool(){const a=new Nt.Tool;a.onMouseDown=B=>this._handleMouseDown(B),a.onMouseDrag=B=>this._handleMouseDrag(B),a.onMouseUp=()=>this._handleMouseUp(),a.onMouseMove=B=>this._handleMouseMove(B)}_handleMouseDown(a){const B=this.model.getCurrentCurve();if(!B)return;const J=Nt.project.hitTest(a.point,{fill:!0,stroke:!0,tolerance:8});this._selectHitItem(J,a)||this._checkStartCurveDrag(B,a)||this.handlesVisible&&this._addPointToCurve(B,a.point)}_handleMouseDrag(a){const B=this.model.getCurrentCurve();B&&(this.isDraggingCurve?this._dragEntireCurve(a):this.selectedItem&&this._dragSelectedItem(a,B))}_handleMouseUp(){this.isDraggingCurve=!1,this.model.computeAllOffsets(),this._renderCurves()}_handleMouseMove(a){const B=Nt.project.hitTest(a.point,{fill:!0,stroke:!0,tolerance:1});B&&B.item&&["circle","bezier_in","bezier_out"].includes(B.item.data.type)?this.hoveredItem=B.item:this.hoveredItem=null,this._renderCurves()}_selectHitItem(a,B){return a&&a.item&&["circle","bezier_in","bezier_out"].includes(a.item.data.type)?(this.selectedItem=a.item,this.dragOffset=B.point.subtract(a.item.position),this._renderCurves(),!0):!1}_checkStartCurveDrag(a,B){if(a.handles.length<2)return!1;const J=new Nt.Path;for(let pt=0;pt<a.handles.length;pt++){const $=a.handles[pt],mt=new Nt.Segment(new Nt.Point($.segment.x,$.segment.y),new Nt.Point($.handleIn.x,$.handleIn.y),new Nt.Point($.handleOut.x,$.handleOut.y));J.add(mt)}const G=J.getNearestPoint(B.point);return(G?G.getDistance(B.point):1/0)<8?(this.isDraggingCurve=!0,this.lastMousePos=B.point,this.selectedItem=null,J.remove(),!0):(J.remove(),!1)}_addPointToCurve(a,B){const J=this.model.generateId(),G=this.model.generateId(),A=this.model.generateId();a.handles.push({id:J,segment:{x:B.x,y:B.y},handleIn:{x:-50,y:0},handleOut:{x:50,y:0},inPointId:G,outPointId:A});const pt=this.model.currentCurveIndex;this.model.computeAllOffsets(),this.selectedItem=null,this._renderCurves(pt)}_dragEntireCurve(a){const B=a.point.x-this.lastMousePos.x,J=a.point.y-this.lastMousePos.y;this.lastMousePos=a.point,this.model.moveActiveCurve(B,J),this._renderCurves()}_dragSelectedItem(a,B){let J;switch(this.selectedItem.data.type){case"circle":J=B.handles.find(G=>G.id===this.selectedItem.data.id),J&&(J.segment.x+=a.delta.x,J.segment.y+=a.delta.y);break;case"bezier_in":J=B.handles.find(G=>G.inPointId===this.selectedItem.data.id),J.handleIn.x+=a.delta.x,J.handleIn.y+=a.delta.y;break;case"bezier_out":J=B.handles.find(G=>G.outPointId===this.selectedItem.data.id),J.handleOut.x+=a.delta.x,J.handleOut.y+=a.delta.y;break}this.model.computeAllOffsets(),this._renderCurves()}_renderCurves(a=this.model.currentCurveIndex){this.view.renderCurves(this.model.curves,this.handlesVisible,this.selectedItem,a,"rgba(0,150,255,0.2)",this.hoveredItem)}isItemOnSelectedCurve(a,B){return!a||!B||!B.handles?!1:B.handles.some(J=>J.id===a.data.id||J.inPointId===a.data.id||J.outPointId===a.data.id)}toggleOffsetVisibility(a,B){this.model.curves[a].offsetsData[B].visible=!this.model.curves[a].offsetsData[B].visible,this._renderCurves()}}class or{constructor(a,B,J,G){this.model=a,this.toolbarView=B,this.canvasView=J,this.drawController=G,this._updateSlidersAndCheckboxes(),this.toolbarView.updateCurveList(this.model.curves),this.drawController.handlesVisible=!0,this.toolbarView.updateHandlesToggle(!0),this._bindUIEvents()}_updateSlidersAndCheckboxes(){const a=this.model.getCurrentCurve();a&&a.offsetsData.forEach((B,J)=>{this.toolbarView.updateOffsetValue(J+1,a.offsetsData[J].offset),this.toolbarView.updateOffsetCheckbox(J+1,B.visible)})}_onOffsetSliderChange(a,B){const J=this.model.getCurrentCurve();J&&(J.offsetsData[a-1].offset=B,this.toolbarView.updateOffsetValue(a,B),this.model.computeAllOffsets(),this._render())}_onOffsetToggle(a){const B=this.model.getCurrentCurve();if(!B)return;const J=B.offsetsData[a-1];J&&(J.visible=!J.visible,this._render())}_onRemoveOffset(a){const B=this.model.getCurrentCurve();B&&(B.offsetsData.splice(a-1,1),this.toolbarView.removeOffsetControls(a),this._render())}_updateOffsetCheckboxesFromModel(){const a=this.model.getCurrentCurve();a&&a.offsetsData.forEach((B,J)=>{const G=!!B.visible;this.toolbarView.updateOffsetCheckbox(J+1,G)})}_addNewCurve(){const a=document.getElementById("curveName");let B=a?.value?.trim();B===""&&(B=void 0),this.model.createCurve(B);const J=this.model.currentCurveIndex;this.toolbarView.clearOffsetsControls(),this.toolbarView.updateCurveList(this.model.curves),this.toolbarView.updateSelectedCurve(J),this.drawController.handlesVisible=!0,this.toolbarView.updateHandlesToggle(!0),this._render(),a&&(a.value="")}_deleteCurrentCurve(){this.model.deleteCurrentCurve(),this.toolbarView.clearOffsetsControls(),this.toolbarView.updateCurveList(this.model.curves),this.model.curves.length>0&&(this.model.currentCurveIndex>=this.model.curves.length&&(this.model.currentCurveIndex=this.model.curves.length-1),this.toolbarView.updateSelectedCurve(this.model.currentCurveIndex),this._updateSlidersAndCheckboxes()),this._render()}_selectCurve(a){this.model.currentCurveIndex=a,this._updateSlidersAndCheckboxes(),this.toolbarView.renderOffsetsControls(this.model.curves[a]),this._render()}_bindUIEvents(){this._bindCurveManagementButtons(),this._bindMiscButtons(),this._bindImportEvents(),this.toolbarView.bindDynamicOffsetControls((a,B)=>this._onOffsetSliderChange(a,B),a=>this._onOffsetToggle(a),a=>this._onRemoveOffset(a))}_bindCurveManagementButtons(){this.toolbarView.bindAddCurve(()=>this._addNewCurve()),this.toolbarView.bindDeleteCurve(()=>this._deleteCurrentCurve()),this.toolbarView.bindCurveSelect(a=>this._selectCurve(a))}_bindMiscButtons(){this.toolbarView.bindHandlesToggle(()=>{this.drawController.handlesVisible=!this.drawController.handlesVisible,this._render()}),this.toolbarView.bindToggleBackground(()=>{this.drawController.backgroundVisible=!this.drawController.backgroundVisible,this.canvasView.setBackgroundVisibility(this.drawController.backgroundVisible)}),this.toolbarView.bindDeletePoint(()=>{if(this.drawController.selectedItem){const a=this.drawController.selectedItem.data.id;this.model.deleteHandleById(a),this.drawController.selectedItem=null,this._render()}}),this.toolbarView.bindExport(()=>this.canvasView.exportAsImage("mon_dessin.png")),this.toolbarView.bindSave(()=>{let a=this.model.getCurrentCurveJSON();if(!a)return;const B=new Blob([a],{type:"application/json"}),J=document.createElement("a");J.href=URL.createObjectURL(B),J.download=`drawing-${this.model.getCurrentCurve().name}.json`,J.click(),setTimeout(()=>URL.revokeObjectURL(J.href),1e3)}),this.toolbarView.bindImportButton(()=>{this.toolbarView.elements.importFile?.click()}),this.toolbarView.bindAddOffsetBtn(()=>{this.model.addOffsetToCurrentCurve(),this.toolbarView.addOffsetControls(),this._updateSlidersAndCheckboxes(),this._render()})}_bindImportEvents(){this.toolbarView.bindImportFile(a=>{const B=a.target.files[0];if(!B)return;const J=new FileReader;J.onload=G=>{this._importCurveFromJSON(G.target.result),a.target.value=""},J.readAsText(B)})}_importCurveFromJSON(a){try{this.model.importCurve(a);const B=this.model.curves.length-1;this.model.currentCurveIndex=B,this.drawController.handlesVisible=!1,this.toolbarView.updateHandlesToggle(!1),this.model.computeAllOffsets(),this._updateSlidersAndCheckboxes(),this._updateOffsetCheckboxesFromModel(),this._render(),this.toolbarView.updateCurveList(this.model.curves),this.toolbarView.updateSelectedCurve(B),this.toolbarView.renderOffsetsControls(this.model.curves[B])}catch(B){console.error("Erreur lors de l'import JSON :",B),alert("Le fichier importé est invalide !")}}_render(){this.canvasView.renderCurves(this.model.curves,this.drawController.handlesVisible,this.drawController.selectedItem,this.model.currentCurveIndex,"rgba(0,150,255,0.2)")}}class ur{constructor(a=1e3,B=2,J=6){this.clipperScale=a,this.sampleStep=B,this.minOffsetPointSpacing=J}computeSingleOffset(a,B){(!a.sampledValid||!a.sampledPoints)&&(a.sampledPoints=this.sampleCurve(a),a.sampledValid=!0);const J=this.sampleCurve(a);if(!J||J.length<2){a.offsetsData.forEach(function(pt){pt.points=[]});return}const G=this.scalePoints(J),A=this.executeClipperOffset(G,B.offset);if(!A.length){B.points=[];return}B.points=this.convertClipperPointsToPaper(A),this.alignOffsetStart(a,B),this.trimOffsetPoints(a,B)}scalePoints(a){return a.map(function(B){return{X:Math.round(B.x*this.clipperScale),Y:Math.round(B.y*this.clipperScale)}},this)}executeClipperOffset(a,B){const J=new Pi.ClipperOffset;J.AddPath(a,Pi.JoinType.jtRound,Pi.EndType.etOpenRound);const G=new Pi.Paths;return J.Execute(G,B*this.clipperScale),G.length?G.reduce(function(A,pt){return pt.length>A.length?pt:A}):[]}convertClipperPointsToPaper(a){return a.map(function(B){return new Nt.Point(B.X/this.clipperScale,B.Y/this.clipperScale)},this)}trimOffsetPoints(a,B){B.points.reverse();const J=this.findClosestOffsetEnd(a,B);B.points=B.points.slice(0,J+1),this.filterCornerPoints(a,B)}alignOffsetStart(a,B){if(!B.points||!B.points.length||!a.handles||!a.handles.length)return;const J=new Nt.Point(a.handles[0].segment.x,a.handles[0].segment.y);let G=0,A=1/0;B.points.forEach(function(pt,$){const mt=pt.getDistance(J);mt<A&&(A=mt,G=$)}),B.points=B.points.slice(G).concat(B.points.slice(0,G))}findClosestOffsetEnd(a,B){if(!B.points||!B.points.length||!a.handles||!a.handles.length)return 0;const J=new Nt.Point(a.handles[a.handles.length-1].segment.x,a.handles[a.handles.length-1].segment.y);let G=0,A=1/0;return B.points.forEach(function(pt,$){const mt=pt.getDistance(J);mt<A&&(A=mt,G=$)}),G}filterCornerPoints(a,B){const J=new Nt.Point(a.handles[0].segment.x,a.handles[0].segment.y),G=new Nt.Point(a.handles[a.handles.length-1].segment.x,a.handles[a.handles.length-1].segment.y);B.points=B.points.filter(function(A){return A.getDistance(J)>B.offset+1&&A.getDistance(G)>B.offset+1})}removeClosePoints(a,B){const J=[];let G=null;return a.forEach(function(A){(!G||A.getDistance(G)>=B)&&(J.push(A),G=A)}),J}sampleCurve(a){const B=new Nt.Path({visible:!0});let J;a.handles.forEach(function(A){J=new Nt.Segment(new Nt.Point(A.segment.x,A.segment.y),new Nt.Point(A.handleIn.x,A.handleIn.y),new Nt.Point(A.handleOut.x,A.handleOut.y)),B.add(J)});const G=[];for(let A=0;A<=B.length;A+=this.sampleStep){const pt=B.getPointAt(A);pt&&G.push(pt)}return B.remove(),this.removeClosePoints(G,this.minOffsetPointSpacing)}}class lr{constructor(){this.defaultStrokeWidth=3,this.offsetSampleStep=15,this.minOffsetPointSpacing=7,this.curves=[],this.currentCurveIndex=-1,this.curveIdCounter=0,this.handleIdCounter=0,this.clipperScale=500,this.defaultOffsets=20,this.processor=new ur(this.clipperScale,this.offsetSampleStep,this.minOffsetPointSpacing),this.createCurve()}createCurve(a=`Courbe ${++this.curveIdCounter}`){const B={name:a,handles:[],strokeWidth:this.defaultStrokeWidth,offsetsData:[]};this.curves.push(B),this.currentCurveIndex=this.curves.length-1}deleteCurrentCurve(){this.currentCurveIndex<0||this.currentCurveIndex>=this.curves.length||(this.curves.splice(this.currentCurveIndex,1),this.curves.length===0?this.currentCurveIndex=-1:this.currentCurveIndex>=this.curves.length&&(this.currentCurveIndex=this.curves.length-1))}deleteHandleById(a){const B=this.getCurrentCurve();if(!B)return;const J=B.handles.findIndex(G=>G.id===a);J>=0&&B.handles.splice(J,1),B.sampledValid=!1,this.computeAllOffsets()}moveActiveCurve(a,B){const J=this.getCurrentCurve();J&&(J.handles.forEach(G=>{G.segment.x+=a,G.segment.y+=B}),J.offsetsData.forEach(G=>{G.points.forEach(A=>{A.x+=a,A.y+=B})}),J.sampledValid=!1)}addOffsetToCurrentCurve(){const a=this.getCurrentCurve();if(a){if(a.offsetsData.length>0){let J={offset:a.offsetsData[a.offsetsData.length-1].offset+20,points:[],visible:!0};a.offsetsData.push(J)}else a.offsetsData.push({offset:this.defaultOffsets,points:[],visible:!0});this.computeAllOffsets()}}computeAllOffsets(){this.curves.forEach(a=>{this.computeOffset(a)})}computeOffset(a){a.offsetsData.forEach(B=>this.processor.computeSingleOffset(a,B))}getCurrentCurve(){return this.currentCurveIndex<0||this.currentCurveIndex>=this.curves.length?null:this.curves[this.currentCurveIndex]}generateId(a="id"){return this.handleIdCounter+=1,`${a}-${this.handleIdCounter}`}getCurrentCurveJSON(){const a=this.getCurrentCurve();if(!a)return;const B={name:a.name,strokeWidth:a.strokeWidth,handles:a.handles.map(G=>({id:G.id,segment:{x:G.segment.x,y:G.segment.y},handleIn:{x:G.handleIn.x,y:G.handleIn.y},handleOut:{x:G.handleOut.x,y:G.handleOut.y},inPointId:G.inPointId,outPointId:G.outPointId})),offsetsData:a.offsetsData.map(G=>({offset:G.offset,point:[],visible:!!G.visible}))};return JSON.stringify(B)}importCurve(a){try{const B=JSON.parse(a),J={name:B.name,strokeWidth:B.strokeWidth||this.defaultStrokeWidth,handles:B.handles.map(G=>({id:G.id||this.generateId(),inPointId:G.inPointId||this.generateId(),outPointId:G.outPointId||this.generateId(),segment:{x:G.segment.x,y:G.segment.y},handleIn:{x:G.handleIn.x,y:G.handleIn.y},handleOut:{x:G.handleOut.x,y:G.handleOut.y}})),offsetsData:(B.offsetsData||[]).map(G=>({offset:G.offset,points:[],visible:!!G.visible}))};this.curves.push(J),this.currentCurveIndex=this.curves.length-1}catch(B){throw console.error("Erreur import:",B),B}}}const cn=document.getElementById("canvas");Nt.setup(cn);const hr=new sr,dn=new lr,pn=new rr(cn),fr=new ar(dn,pn);new or(dn,hr,pn,fr);
